"use strict";(()=>{var zN=Object.create;var dr=Object.defineProperty,GN=Object.defineProperties,jN=Object.getOwnPropertyDescriptor,qN=Object.getOwnPropertyDescriptors,XN=Object.getOwnPropertyNames,ur=Object.getOwnPropertySymbols,YN=Object.getPrototypeOf,ao=Object.prototype.hasOwnProperty,Nn=Object.prototype.propertyIsEnumerable;var pr=Math.pow,wn=(t,o,e)=>o in t?dr(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,N=(t,o)=>{for(var e in o||(o={}))ao.call(o,e)&&wn(t,e,o[e]);if(ur)for(var e of ur(o))Nn.call(o,e)&&wn(t,e,o[e]);return t},F=(t,o)=>GN(t,qN(o));var Ke=(t,o)=>{var e={};for(var r in t)ao.call(t,r)&&o.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&ur)for(var r of ur(t))o.indexOf(r)<0&&Nn.call(t,r)&&(e[r]=t[r]);return e};var i=(t,o)=>()=>(t&&(o=t(t=0)),o);var ZN=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports),$N=(t,o)=>{for(var e in o)dr(t,e,{get:o[e],enumerable:!0})},KN=(t,o,e,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of XN(o))!ao.call(t,n)&&n!==e&&dr(t,n,{get:()=>o[n],enumerable:!(r=jN(o,n))||r.enumerable});return t};var QN=(t,o,e)=>(e=t!=null?zN(YN(t)):{},KN(o||!t||!t.__esModule?dr(e,"default",{value:t,enumerable:!0}):e,t));var O=(t,o,e)=>new Promise((r,n)=>{var s=l=>{try{a(e.next(l))}catch(u){n(u)}},c=l=>{try{a(e.throw(l))}catch(u){n(u)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,c);a((e=e.apply(t,o)).next())});var co,Bn=i(()=>{co=(t,o,e)=>({endTime:o,insertTime:e,type:"exponentialRampToValue",value:t})});var lo,Vn=i(()=>{lo=(t,o,e)=>({endTime:o,insertTime:e,type:"linearRampToValue",value:t})});var gt,uo=i(()=>{gt=(t,o)=>({startTime:o,type:"setValue",value:t})});var Yt,po=i(()=>{Yt=(t,o,e)=>({duration:e,startTime:o,type:"setValueCurve",values:t})});var Ir,mo=i(()=>{Ir=(t,o,{startTime:e,target:r,timeConstant:n})=>r+(o-r)*Math.exp((e-t)/n)});var je,br=i(()=>{je=t=>t.type==="exponentialRampToValue"});var it,Mr=i(()=>{it=t=>t.type==="linearRampToValue"});var Pe,Pr=i(()=>{br();Mr();Pe=t=>je(t)||it(t)});var yt,Fr=i(()=>{yt=t=>t.type==="setValue"});var Ee,Or=i(()=>{Ee=t=>t.type==="setValueCurve"});var Ct,ho=i(()=>{mo();Pr();Fr();Or();Ct=(t,o,e,r)=>{let n=t[o];return n===void 0?r:Pe(n)||yt(n)?n.value:Ee(n)?n.values[n.values.length-1]:Ir(e,Ct(t,o-1,n.startTime,r),n)}});var fo,Wn=i(()=>{ho();Pr();Fr();Or();fo=(t,o,e,r,n)=>e===void 0?[r.insertTime,n]:Pe(e)?[e.endTime,e.value]:yt(e)?[e.startTime,e.value]:Ee(e)?[e.startTime+e.duration,e.values[e.values.length-1]]:[e.startTime,Ct(t,o-1,e.startTime,n)]});var Zt,xo=i(()=>{Zt=t=>t.type==="cancelAndHold"});var $t,vo=i(()=>{$t=t=>t.type==="cancelScheduledValues"});var qe,Hn=i(()=>{xo();vo();br();Mr();qe=t=>Zt(t)||$t(t)?t.cancelTime:je(t)||it(t)?t.endTime:t.startTime});var go,Un=i(()=>{go=(t,o,e,{endTime:r,value:n})=>e===n?n:0<e&&0<n||e<0&&n<0?e*pr(n/e,(t-o)/(r-o)):0});var yo,zn=i(()=>{yo=(t,o,e,{endTime:r,value:n})=>e+(t-o)/(r-o)*(n-e)});var Gn,jn=i(()=>{Gn=(t,o)=>{let e=Math.floor(o),r=Math.ceil(o);return e===r?t[e]:(1-(o-e))*t[e]+(1-(r-o))*t[r]}});var qn,Xn=i(()=>{jn();qn=(t,{duration:o,startTime:e,values:r})=>{let n=(t-e)/o*(r.length-1);return Gn(r,n)}});var Kt,Yn=i(()=>{Kt=t=>t.type==="setTarget"});var Qt,Zn=i(()=>{Bn();Vn();uo();po();Wn();Hn();Un();zn();mo();Xn();ho();Pr();xo();vo();br();Mr();Yn();Fr();Or();Qt=class{constructor(o){this._automationEvents=[],this._currenTime=0,this._defaultValue=o}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(o){let e=qe(o);if(Zt(o)||$t(o)){let r=this._automationEvents.findIndex(s=>$t(o)&&Ee(s)?s.startTime+s.duration>=e:qe(s)>=e),n=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Zt(o)){let s=this._automationEvents[this._automationEvents.length-1];if(n!==void 0&&Pe(n)){if(s!==void 0&&Kt(s))throw new Error("The internal list is malformed.");let c=s===void 0?n.insertTime:Ee(s)?s.startTime+s.duration:qe(s),a=s===void 0?this._defaultValue:Ee(s)?s.values[s.values.length-1]:s.value,l=je(n)?go(e,c,a,n):yo(e,c,a,n),u=je(n)?co(l,e,this._currenTime):lo(l,e,this._currenTime);this._automationEvents.push(u)}if(s!==void 0&&Kt(s)&&this._automationEvents.push(gt(this.getValue(e),e)),s!==void 0&&Ee(s)&&s.startTime+s.duration>e){let c=e-s.startTime,a=(s.values.length-1)/s.duration,l=Math.max(2,1+Math.ceil(c*a)),u=c/(l-1)*a,d=s.values.slice(0,l);if(u<1)for(let p=1;p<l;p+=1){let m=u*p%1;d[p]=s.values[p-1]*(1-m)+s.values[p]*m}this._automationEvents[this._automationEvents.length-1]=Yt(d,s.startTime,c)}}}else{let r=this._automationEvents.findIndex(c=>qe(c)>e),n=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(n!==void 0&&Ee(n)&&qe(n)+n.duration>e)return!1;let s=je(o)?co(o.value,o.endTime,this._currenTime):it(o)?lo(o.value,e,this._currenTime):o;if(r===-1)this._automationEvents.push(s);else{if(Ee(o)&&e+o.duration>qe(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(o){let e=this._automationEvents.findIndex(r=>qe(r)>o);if(e>1){let r=this._automationEvents.slice(e-1),n=r[0];Kt(n)&&r.unshift(gt(Ct(this._automationEvents,e-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=r}}getValue(o){if(this._automationEvents.length===0)return this._defaultValue;let e=this._automationEvents.findIndex(c=>qe(c)>o),r=this._automationEvents[e],n=(e===-1?this._automationEvents.length:e)-1,s=this._automationEvents[n];if(s!==void 0&&Kt(s)&&(r===void 0||!Pe(r)||r.insertTime>o))return Ir(o,Ct(this._automationEvents,n-1,s.startTime,this._defaultValue),s);if(s!==void 0&&yt(s)&&(r===void 0||!Pe(r)))return s.value;if(s!==void 0&&Ee(s)&&(r===void 0||!Pe(r)||s.startTime+s.duration>o))return o<s.startTime+s.duration?qn(o,s):s.values[s.values.length-1];if(s!==void 0&&Pe(s)&&(r===void 0||!Pe(r)))return s.value;if(r!==void 0&&je(r)){let[c,a]=fo(this._automationEvents,n,s,r,this._defaultValue);return go(o,c,a,r)}if(r!==void 0&&it(r)){let[c,a]=fo(this._automationEvents,n,s,r,this._defaultValue);return yo(o,c,a,r)}return this._defaultValue}}});var Co,$n=i(()=>{Co=t=>({cancelTime:t,type:"cancelAndHold"})});var wo,Kn=i(()=>{wo=t=>({cancelTime:t,type:"cancelScheduledValues"})});var No,Qn=i(()=>{No=(t,o)=>({endTime:o,type:"exponentialRampToValue",value:t})});var So,Jn=i(()=>{So=(t,o)=>({endTime:o,type:"linearRampToValue",value:t})});var To,ei=i(()=>{To=(t,o,e)=>({startTime:o,target:t,timeConstant:e,type:"setTarget"})});var ti=i(()=>{});var ri=i(()=>{});var oi=i(()=>{});var ni=i(()=>{});var ii=i(()=>{});var si=i(()=>{});var ai=i(()=>{});var ci=i(()=>{});var li=i(()=>{});var ui=i(()=>{ti();ri();oi();ni();ii();si();ai();ci();li()});var di=i(()=>{});var pi=i(()=>{});var mi=i(()=>{di();pi()});var Ao=i(()=>{Zn();$n();Kn();Qn();Jn();ei();uo();po();ui();mi()});var hi,fi=i(()=>{hi=()=>new DOMException("","AbortError")});var xi,vi=i(()=>{xi=t=>(o,e,[r,n,s],c)=>{t(o[n],[e,r,s],a=>a[0]===e&&a[1]===r,c)}});var gi,yi=i(()=>{gi=t=>(o,e,r)=>{let n=[];for(let s=0;s<r.numberOfInputs;s+=1)n.push(new Set);t.set(o,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}});var Ci,wi=i(()=>{Ci=t=>(o,e)=>{t.set(o,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}});var Le,_r,wt,kr,Jt,Nt,Dr,er,tr,rr,fe=i(()=>{Le=new WeakSet,_r=new WeakMap,wt=new WeakMap,kr=new WeakMap,Jt=new WeakMap,Nt=new WeakMap,Dr=new WeakMap,er=new WeakMap,tr=new WeakMap,rr=new WeakMap});var Ni,Si,Ti=i(()=>{Ni={construct(){return Ni}},Si=t=>{try{let o=new Proxy(t,Ni);new o}catch(o){return!1}return!0}});var Ai,Eo,Ei=i(()=>{Ai=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Eo=(t,o)=>{let e=[],r=t.replace(/^[\s]+/,""),n=r.match(Ai);for(;n!==null;){let s=n[1].slice(1,-1),c=n[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,o).toString());e.push(c),r=r.slice(n[0].length).replace(/^[\s]+/,""),n=r.match(Ai)}return[e.join(";"),r]}});var Ii,bi,Mi,Pi=i(()=>{fe();Ti();Ei();Ii=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},bi=t=>{if(!Si(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Mi=(t,o,e,r,n,s,c,a,l,u,d,p,m)=>{let h=0;return(v,x,f={credentials:"omit"})=>{let g=d.get(v);if(g!==void 0&&g.has(x))return Promise.resolve();let S=u.get(v);if(S!==void 0){let T=S.get(x);if(T!==void 0)return T}let A=s(v),M=A.audioWorklet===void 0?n(x).then(([T,w])=>{let[y,C]=Eo(T,w),P=`${y};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${C}
})})(window,'_AWGS')`;return e(P)}).then(()=>{let T=m._AWGS.pop();if(T===void 0)throw new SyntaxError;r(A.currentTime,A.sampleRate,()=>T(class{},void 0,(w,y)=>{if(w.trim()==="")throw o();let C=tr.get(A);if(C!==void 0){if(C.has(w))throw o();bi(y),Ii(y.parameterDescriptors),C.set(w,y)}else bi(y),Ii(y.parameterDescriptors),tr.set(A,new Map([[w,y]]))},A.sampleRate,void 0,void 0))}):Promise.all([n(x),Promise.resolve(t(p,p))]).then(([[T,w],y])=>{let C=h+1;h=C;let[P,R]=Eo(T,w),b=`${P};((AudioWorkletProcessor,registerProcessor)=>{${R}
})(${y?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${y?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${y?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${C}',class extends AudioWorkletProcessor{process(){return !1}})`,k=new Blob([b],{type:"application/javascript; charset=utf-8"}),_=URL.createObjectURL(k);return A.audioWorklet.addModule(_,f).then(()=>{if(a(A))return A;let B=c(A);return B.audioWorklet.addModule(_,f).then(()=>B)}).then(B=>{if(l===null)throw new SyntaxError;try{new l(B,`__sac${C}`)}catch(G){throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(_))});return S===void 0?u.set(v,new Map([[x,M]])):S.set(x,M),M.then(()=>{let T=d.get(v);T===void 0?d.set(v,new Set([x])):T.add(x)}).finally(()=>{let T=u.get(v);T!==void 0&&T.delete(x)}),M}}});var de,Be=i(()=>{de=(t,o)=>{let e=t.get(o);if(e===void 0)throw new Error("A value with the given key could not be found.");return e}});var Qe,or=i(()=>{Qe=(t,o)=>{let e=Array.from(t).filter(o);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");let[r]=e;return t.delete(r),r}});var Rr,Io=i(()=>{Be();or();Rr=(t,o,e,r)=>{let n=de(t,o),s=Qe(n,c=>c[0]===e&&c[1]===r);return n.size===0&&t.delete(o),s}});var Ve,St=i(()=>{fe();Be();Ve=t=>de(Dr,t)});var Fe,Tt=i(()=>{fe();St();Fe=t=>{if(Le.has(t))throw new Error("The AudioNode is already stored.");Le.add(t),Ve(t).forEach(o=>o(!0))}});var Lr,bo=i(()=>{Lr=t=>"port"in t});var We,At=i(()=>{fe();St();We=t=>{if(!Le.has(t))throw new Error("The AudioNode is not stored.");Le.delete(t),Ve(t).forEach(o=>o(!1))}});var nr,Mo=i(()=>{bo();At();nr=(t,o)=>{!Lr(t)&&o.every(e=>e.size===0)&&We(t)}});var Fi,Oi=i(()=>{Io();Tt();Mo();Fi=(t,o,e,r,n,s,c,a,l,u,d,p,m)=>{let h=new WeakMap;return(v,x,f,g,S)=>{let{activeInputs:A,passiveInputs:M}=s(x),{outputs:T}=s(v),w=a(v),y=C=>{let P=l(x),R=l(v);if(C){let I=Rr(M,v,f,g);t(A,v,I,!1),!S&&!p(v)&&e(R,P,f,g),m(x)&&Fe(x)}else{let I=r(A,v,f,g);o(M,g,I,!1),!S&&!p(v)&&n(R,P,f,g);let E=c(x);if(E===0)d(x)&&nr(x,A);else{let L=h.get(x);L!==void 0&&clearTimeout(L),h.set(x,setTimeout(()=>{d(x)&&nr(x,A)},E*1e3))}}};return u(T,[x,f,g],C=>C[0]===x&&C[1]===f&&C[2]===g,!0)?(w.add(y),d(v)?t(A,v,[f,g,y],!0):o(M,g,[v,f,y],!0),!0):!1}}});var _i,ki=i(()=>{_i=t=>(o,e,[r,n,s],c)=>{let a=o.get(r);a===void 0?o.set(r,new Set([[n,e,s]])):t(a,[n,e,s],l=>l[0]===n&&l[1]===e,c)}});var Di,Ri=i(()=>{Di=t=>(o,e)=>{let r=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(r).connect(o.destination);let n=()=>{e.removeEventListener("ended",n),e.disconnect(r),r.disconnect()};e.addEventListener("ended",n)}});var Li,Bi=i(()=>{Li=t=>(o,e)=>{t(o).add(e)}});var rS,Vi,Wi=i(()=>{rS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Vi=(t,o,e,r,n,s)=>class extends t{constructor(a,l){let u=n(a),d=N(N({},rS),l),p=r(u,d),m=s(u)?o():null;super(a,!1,p,m),this._nativeAnalyserNode=p}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){let l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){let l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}}});var Y,ve=i(()=>{Y=(t,o)=>t.context===o});var Hi,Ui=i(()=>{ve();Hi=(t,o,e)=>()=>{let r=new WeakMap,n=(s,c)=>O(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(c,u)}return r.set(c,a),yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):n(s,c)}}}});var Et,Po=i(()=>{Et=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch(o){return!1}return!0}});var Ie,Fo=i(()=>{Ie=()=>new DOMException("","IndexSizeError")});var It,Br=i(()=>{Fo();It=t=>{t.getChannelData=(o=>e=>{try{return o.call(t,e)}catch(r){throw r.code===12?Ie():r}})(t.getChannelData)}});var oS,zi,ji=i(()=>{Po();Br();oS={numberOfChannels:1},zi=(t,o,e,r,n,s,c,a)=>{let l=null;return class Gi{constructor(d){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:p,numberOfChannels:m,sampleRate:h}=N(N({},oS),d);l===null&&(l=new n(1,1,44100));let v=r!==null&&o(s,s)?new r({length:p,numberOfChannels:m,sampleRate:h}):l.createBuffer(m,p,h);if(v.numberOfChannels===0)throw e();return typeof v.copyFromChannel!="function"?(c(v),It(v)):o(Et,()=>Et(v))||a(v),t.add(v),v}static[Symbol.hasInstance](d){return d!==null&&typeof d=="object"&&Object.getPrototypeOf(d)===Gi.prototype||t.has(d)}}}});var ce,ae,Je=i(()=>{ce=-34028234663852886e22,ae=-ce});var Ce,st=i(()=>{fe();Ce=t=>Le.has(t)});var nS,qi,Xi=i(()=>{Je();st();Tt();At();nS={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},qi=(t,o,e,r,n,s,c,a)=>class extends t{constructor(u,d){let p=s(u),m=N(N({},nS),d),h=n(p,m),v=c(p),x=v?o():null;super(u,!1,h,x),this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=m.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=e(this,v,h.playbackRate,ae,ce)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){let d=typeof u=="function"?a(this,u):null;this._nativeAudioBufferSourceNode.onended=d;let p=this._nativeAudioBufferSourceNode.onended;this._onended=p!==null&&p===d?u:p}get playbackRate(){return this._playbackRate}start(u=0,d=0,p){if(this._nativeAudioBufferSourceNode.start(u,d,p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=p===void 0?[u,d]:[u,d,p]),this.context.state!=="closed"){Fe(this);let m=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",m),Ce(this)&&We(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",m)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}}});var Yi,Zi=i(()=>{ve();Yi=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=null,a=null,l=(u,d)=>O(void 0,null,function*(){let p=e(u),m=Y(p,d);if(!m){let h={buffer:p.buffer,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,loop:p.loop,loopEnd:p.loopEnd,loopStart:p.loopStart,playbackRate:p.playbackRate.value};p=o(d,h),c!==null&&p.start(...c),a!==null&&p.stop(a)}return s.set(d,p),m?yield t(d,u.playbackRate,p.playbackRate):yield r(d,u.playbackRate,p.playbackRate),yield n(u,d,p),p});return{set start(u){c=u},set stop(u){a=u},render(u,d){let p=s.get(d);return p!==void 0?Promise.resolve(p):l(u,d)}}}});var $i,Ki=i(()=>{$i=t=>"playbackRate"in t});var Qi,Ji=i(()=>{Qi=t=>"frequency"in t&&"gain"in t});var es,ts=i(()=>{es=t=>"offset"in t});var rs,os=i(()=>{rs=t=>!("frequency"in t)&&"gain"in t});var ns,is=i(()=>{ns=t=>"detune"in t&&"frequency"in t});var ss,as=i(()=>{ss=t=>"pan"in t});var me,ir=i(()=>{fe();Be();me=t=>de(_r,t)});var et,Vr=i(()=>{fe();Be();et=t=>de(kr,t)});var Wr,cs=i(()=>{Ki();bo();Ji();ts();os();is();as();ir();Vr();st();At();Wr=(t,o)=>{let{activeInputs:e}=me(t);e.forEach(n=>n.forEach(([s])=>{o.includes(t)||Wr(s,[...o,t])}));let r=$i(t)?[t.playbackRate]:Lr(t)?Array.from(t.parameters.values()):Qi(t)?[t.Q,t.detune,t.frequency,t.gain]:es(t)?[t.offset]:rs(t)?[t.gain]:ns(t)?[t.detune,t.frequency]:ss(t)?[t.pan]:[];for(let n of r){let s=et(n);s!==void 0&&s.activeInputs.forEach(([c])=>Wr(c,o))}Ce(t)&&We(t)}});var tt,sr=i(()=>{cs();tt=t=>{Wr(t.destination,[])}});var Hr,Oo=i(()=>{Hr=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback")});var ls,us=i(()=>{sr();Oo();ls=(t,o,e,r,n,s,c,a,l)=>class extends t{constructor(d={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let p;try{p=new l(d)}catch(v){throw v.code===12&&v.message==="sampleRate is not in range"?e():v}if(p===null)throw r();if(!Hr(d.latencyHint))throw new TypeError(`The provided value '${d.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(d.sampleRate!==void 0&&p.sampleRate!==d.sampleRate)throw e();super(p,2);let{latencyHint:m}=d,{sampleRate:h}=p;if(this._baseLatency=typeof p.baseLatency=="number"?p.baseLatency:m==="balanced"?512/h:m==="interactive"||m===void 0?256/h:m==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(m*h/128)))*128/h,this._nativeAudioContext=p,l.name==="webkitAudioContext"?(this._nativeGainNode=p.createGain(),this._nativeOscillatorNode=p.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(p.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,p.state==="running"){this._state="suspended";let v=()=>{this._state==="suspended"&&(this._state=null),p.removeEventListener("statechange",v)};p.addEventListener("statechange",v)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw o()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),tt(this)}))}createMediaElementSource(d){return new n(this,{mediaElement:d})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(d){return new c(this,{mediaStream:d})}createMediaStreamTrackSource(d){return new a(this,{mediaStreamTrack:d})}resume(){return this._state==="suspended"?new Promise((d,p)=>{let m=()=>{this._nativeAudioContext.removeEventListener("statechange",m),this._nativeAudioContext.state==="running"?d():this.resume().then(d,p)};this._nativeAudioContext.addEventListener("statechange",m)}):this._nativeAudioContext.resume().catch(d=>{throw d===void 0||d.code===15?o():d})}suspend(){return this._nativeAudioContext.suspend().catch(d=>{throw d===void 0?o():d})}}});var ds,ps=i(()=>{ds=(t,o,e,r,n,s,c,a)=>class extends t{constructor(u,d){let p=s(u),m=c(p),h=n(p,d,m),v=m?o(a):null;super(u,!1,h,v),this._isNodeOfNativeOfflineAudioContext=m,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}});var ms,hs=i(()=>{ms=t=>{let o=new WeakMap,e=(r,n)=>O(void 0,null,function*(){let s=n.destination;return o.set(n,s),yield t(r,n,s),s});return{render(r,n){let s=o.get(n);return s!==void 0?Promise.resolve(s):e(r,n)}}}});var fs,xs=i(()=>{Je();fs=(t,o,e,r,n,s,c,a)=>(l,u)=>{let d=u.listener,p=()=>{let T=new Float32Array(1),w=o(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),y=c(u),C=!1,P=[0,0,-1,0,1,0],R=[0,0,0],I=()=>{if(C)return;C=!0;let k=r(u,256,9,0);k.onaudioprocess=({inputBuffer:_})=>{let B=[s(_,T,0),s(_,T,1),s(_,T,2),s(_,T,3),s(_,T,4),s(_,T,5)];B.some((V,H)=>V!==P[H])&&(d.setOrientation(...B),P=B);let G=[s(_,T,6),s(_,T,7),s(_,T,8)];G.some((V,H)=>V!==R[H])&&(d.setPosition(...G),R=G)},w.connect(k)},E=k=>_=>{_!==P[k]&&(P[k]=_,d.setOrientation(...P))},L=k=>_=>{_!==R[k]&&(R[k]=_,d.setPosition(...R))},b=(k,_,B)=>{let G=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_});G.connect(w,0,k),G.start(),Object.defineProperty(G.offset,"defaultValue",{get(){return _}});let V=t({context:l},y,G.offset,ae,ce);return a(V,"value",H=>()=>H.call(V),H=>j=>{try{H.call(V,j)}catch(Q){if(Q.code!==9)throw Q}I(),y&&B(j)}),V.cancelAndHoldAtTime=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.cancelAndHoldAtTime),V.cancelScheduledValues=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.cancelScheduledValues),V.exponentialRampToValueAtTime=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.exponentialRampToValueAtTime),V.linearRampToValueAtTime=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.linearRampToValueAtTime),V.setTargetAtTime=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.setTargetAtTime),V.setValueAtTime=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.setValueAtTime),V.setValueCurveAtTime=(H=>y?()=>{throw n()}:(...j)=>{let Q=H.apply(V,j);return I(),Q})(V.setValueCurveAtTime),V};return{forwardX:b(0,0,E(0)),forwardY:b(1,0,E(1)),forwardZ:b(2,-1,E(2)),positionX:b(6,0,L(0)),positionY:b(7,0,L(1)),positionZ:b(8,0,L(2)),upX:b(3,0,E(3)),upY:b(4,1,E(4)),upZ:b(5,0,E(5))}},{forwardX:m,forwardY:h,forwardZ:v,positionX:x,positionY:f,positionZ:g,upX:S,upY:A,upZ:M}=d.forwardX===void 0?p():d;return{get forwardX(){return m},get forwardY(){return h},get forwardZ(){return v},get positionX(){return x},get positionY(){return f},get positionZ(){return g},get upX(){return S},get upY(){return A},get upZ(){return M}}}});var at,Ur=i(()=>{at=t=>"context"in t});var rt,zr=i(()=>{Ur();rt=t=>at(t[0])});var Oe,ar=i(()=>{Oe=(t,o,e,r)=>{for(let n of t)if(e(n)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(o),!0}});var _o,vs=i(()=>{ar();_o=(t,o,[e,r],n)=>{Oe(t,[o,e,r],s=>s[0]===o&&s[1]===e,n)}});var ko,gs=i(()=>{ar();ko=(t,[o,e,r],n)=>{let s=t.get(o);s===void 0?t.set(o,new Set([[e,r]])):Oe(s,[e,r],c=>c[0]===e,n)}});var be,ct=i(()=>{be=t=>"inputs"in t});var bt,Do=i(()=>{ct();bt=(t,o,e,r)=>{if(be(o)){let n=o.inputs[r];return t.connect(n,e,0),[n,e,0]}return t.connect(o,e,r),[o,e,r]}});var Ro,ys=i(()=>{Ro=(t,o,e)=>{for(let r of t)if(r[0]===o&&r[1]===e)return t.delete(r),r;return null}});var Cs,ws=i(()=>{or();Cs=(t,o,e)=>Qe(t,r=>r[0]===o&&r[1]===e)});var Lo,Ns=i(()=>{St();Lo=(t,o)=>{if(!Ve(t).delete(o))throw new Error("Missing the expected event listener.")}});var Bo,Ss=i(()=>{Be();or();Bo=(t,o,e)=>{let r=de(t,o),n=Qe(r,s=>s[0]===e);return r.size===0&&t.delete(o),n}});var Mt,Vo=i(()=>{ct();Mt=(t,o,e,r)=>{be(o)?t.disconnect(o.inputs[r],e,0):t.disconnect(o,e,r)}});var ee,Gr=i(()=>{fe();Be();ee=t=>de(wt,t)});var lt,Wo=i(()=>{fe();Be();lt=t=>de(Jt,t)});var Xe,Ho=i(()=>{fe();Xe=t=>er.has(t)});var Pt,Uo=i(()=>{fe();Pt=t=>!Le.has(t)});var zo,Ts=i(()=>{zo=(t,o)=>new Promise(e=>{if(o!==null)e(!0);else{let r=t.createScriptProcessor(256,1,1),n=t.createGain(),s=t.createBuffer(1,2,44100),c=s.getChannelData(0);c[0]=1,c[1]=1;let a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(t.destination),a.connect(n),a.disconnect(n),r.onaudioprocess=l=>{let u=l.inputBuffer.getChannelData(0);Array.prototype.some.call(u,d=>d===1)?e(!0):e(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}})});var jr,As=i(()=>{jr=(t,o)=>{let e=new Map;for(let r of t)for(let n of r){let s=e.get(n);e.set(n,s===void 0?1:s+1)}e.forEach((r,n)=>o(n,r))}});var ut,qr=i(()=>{ut=t=>"context"in t});var Es,Is=i(()=>{qr();Es=t=>{let o=new Map;t.connect=(e=>(r,n=0,s=0)=>{let c=ut(r)?e(r,n,s):e(r,n),a=o.get(r);return a===void 0?o.set(r,[{input:s,output:n}]):a.every(l=>l.input!==s||l.output!==n)&&a.push({input:s,output:n}),c})(t.connect.bind(t)),t.disconnect=(e=>(r,n,s)=>{if(e.apply(t),r===void 0)o.clear();else if(typeof r=="number")for(let[c,a]of o){let l=a.filter(u=>u.output!==r);l.length===0?o.delete(c):o.set(c,l)}else if(o.has(r))if(n===void 0)o.delete(r);else{let c=o.get(r);if(c!==void 0){let a=c.filter(l=>l.output!==n&&(l.input!==s||s===void 0));a.length===0?o.delete(r):o.set(r,a)}}for(let[c,a]of o)a.forEach(l=>{ut(c)?t.connect(c,l.output,l.input):t.connect(c,l.output)})})(t.disconnect)}});var iS,sS,aS,Go,jo,cS,lS,uS,bs,Ms=i(()=>{fe();Ur();zr();vs();gs();Do();ys();ws();Ns();Io();Ss();Vo();ir();Vr();St();Gr();Wo();ar();st();Ho();Uo();Tt();Mo();Ts();As();Is();iS=(t,o,e,r)=>{let{activeInputs:n,passiveInputs:s}=et(o),{outputs:c}=me(t),a=Ve(t),l=u=>{let d=ee(t),p=lt(o);if(u){let m=Bo(s,t,e);_o(n,t,m,!1),!r&&!Xe(t)&&d.connect(p,e)}else{let m=Cs(n,t,e);ko(s,m,!1),!r&&!Xe(t)&&d.disconnect(p,e)}};return Oe(c,[o,e],u=>u[0]===o&&u[1]===e,!0)?(a.add(l),Ce(t)?_o(n,t,[e,l],!0):ko(s,[t,e,l],!0),!0):!1},sS=(t,o,e,r)=>{let{activeInputs:n,passiveInputs:s}=me(o),c=Ro(n[r],t,e);return c===null?[Rr(s,t,e,r)[2],!1]:[c[2],!0]},aS=(t,o,e)=>{let{activeInputs:r,passiveInputs:n}=et(o),s=Ro(r,t,e);return s===null?[Bo(n,t,e)[1],!1]:[s[2],!0]},Go=(t,o,e,r,n)=>{let[s,c]=sS(t,e,r,n);if(s!==null&&(Lo(t,s),c&&!o&&!Xe(t)&&Mt(ee(t),ee(e),r,n)),Ce(e)){let{activeInputs:a}=me(e);nr(e,a)}},jo=(t,o,e,r)=>{let[n,s]=aS(t,e,r);n!==null&&(Lo(t,n),s&&!o&&!Xe(t)&&ee(t).disconnect(lt(e),r))},cS=(t,o)=>{let e=me(t),r=[];for(let n of e.outputs)rt(n)?Go(t,o,...n):jo(t,o,...n),r.push(n[0]);return e.outputs.clear(),r},lS=(t,o,e)=>{let r=me(t),n=[];for(let s of r.outputs)s[1]===e&&(rt(s)?Go(t,o,...s):jo(t,o,...s),n.push(s[0]),r.outputs.delete(s));return n},uS=(t,o,e,r,n)=>{let s=me(t);return Array.from(s.outputs).filter(c=>c[0]===e&&(r===void 0||c[1]===r)&&(n===void 0||c[2]===n)).map(c=>(rt(c)?Go(t,o,...c):jo(t,o,...c),s.outputs.delete(c),c[0]))},bs=(t,o,e,r,n,s,c,a,l,u,d,p,m,h,v,x)=>class extends u{constructor(g,S,A,M){super(A),this._context=g,this._nativeAudioNode=A;let T=d(g);p(T)&&e(zo,()=>zo(T,x))!==!0&&Es(A),wt.set(this,A),Dr.set(this,new Set),g.state!=="closed"&&S&&Fe(this),t(this,M,A)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,S=0,A=0){if(S<0||S>=this._nativeAudioNode.numberOfOutputs)throw n();let M=d(this._context),T=v(M);if(m(g)||h(g))throw s();if(at(g)){let C=ee(g);try{let R=bt(this._nativeAudioNode,C,S,A),I=Pt(this);(T||I)&&this._nativeAudioNode.disconnect(...R),this.context.state!=="closed"&&!I&&Pt(g)&&Fe(g)}catch(R){throw R.code===12?s():R}if(o(this,g,S,A,T)){let R=l([this],g);jr(R,r(T))}return g}let w=lt(g);if(w.name==="playbackRate"&&w.maxValue===1024)throw c();try{this._nativeAudioNode.connect(w,S),(T||Pt(this))&&this._nativeAudioNode.disconnect(w,S)}catch(C){throw C.code===12?s():C}if(iS(this,g,S,T)){let C=l([this],g);jr(C,r(T))}}disconnect(g,S,A){let M,T=d(this._context),w=v(T);if(g===void 0)M=cS(this,w);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw n();M=lS(this,w,g)}else{if(S!==void 0&&(S<0||S>=this.numberOfOutputs)||at(g)&&A!==void 0&&(A<0||A>=g.numberOfInputs))throw n();if(M=uS(this,w,g,S,A),M.length===0)throw s()}for(let y of M){let C=l([this],y);jr(C,a)}}}});var Ps,Fs=i(()=>{Ao();Ps=(t,o,e,r,n,s,c,a,l,u,d,p,m)=>(h,v,x,f=null,g=null)=>{let S=x.value,A=new Qt(S),M=v?r(A):null,T={get defaultValue(){return S},get maxValue(){return f===null?x.maxValue:f},get minValue(){return g===null?x.minValue:g},get value(){return x.value},set value(w){x.value=w,T.setValueAtTime(w,h.context.currentTime)},cancelAndHoldAtTime(w){if(typeof x.cancelAndHoldAtTime=="function")M===null&&A.flush(h.context.currentTime),A.add(n(w)),x.cancelAndHoldAtTime(w);else{let y=Array.from(A).pop();M===null&&A.flush(h.context.currentTime),A.add(n(w));let C=Array.from(A).pop();x.cancelScheduledValues(w),y!==C&&C!==void 0&&(C.type==="exponentialRampToValue"?x.exponentialRampToValueAtTime(C.value,C.endTime):C.type==="linearRampToValue"?x.linearRampToValueAtTime(C.value,C.endTime):C.type==="setValue"?x.setValueAtTime(C.value,C.startTime):C.type==="setValueCurve"&&x.setValueCurveAtTime(C.values,C.startTime,C.duration))}return T},cancelScheduledValues(w){return M===null&&A.flush(h.context.currentTime),A.add(s(w)),x.cancelScheduledValues(w),T},exponentialRampToValueAtTime(w,y){if(w===0)throw new RangeError;if(!Number.isFinite(y)||y<0)throw new RangeError;let C=h.context.currentTime;return M===null&&A.flush(C),Array.from(A).length===0&&(A.add(u(S,C)),x.setValueAtTime(S,C)),A.add(c(w,y)),x.exponentialRampToValueAtTime(w,y),T},linearRampToValueAtTime(w,y){let C=h.context.currentTime;return M===null&&A.flush(C),Array.from(A).length===0&&(A.add(u(S,C)),x.setValueAtTime(S,C)),A.add(a(w,y)),x.linearRampToValueAtTime(w,y),T},setTargetAtTime(w,y,C){return M===null&&A.flush(h.context.currentTime),A.add(l(w,y,C)),x.setTargetAtTime(w,y,C),T},setValueAtTime(w,y){return M===null&&A.flush(h.context.currentTime),A.add(u(w,y)),x.setValueAtTime(w,y),T},setValueCurveAtTime(w,y,C){let P=w instanceof Float32Array?w:new Float32Array(w);if(p!==null&&p.name==="webkitAudioContext"){let R=y+C,I=h.context.sampleRate,E=Math.ceil(y*I),L=Math.floor(R*I),b=L-E,k=new Float32Array(b);for(let B=0;B<b;B+=1){let G=(P.length-1)/C*((E+B)/I-y),V=Math.floor(G),H=Math.ceil(G);k[B]=V===H?P[V]:(1-(G-V))*P[V]+(1-(H-G))*P[H]}M===null&&A.flush(h.context.currentTime),A.add(d(k,y,C)),x.setValueCurveAtTime(k,y,C);let _=L/I;_<R&&m(T,k[k.length-1],_),m(T,P[P.length-1],R)}else M===null&&A.flush(h.context.currentTime),A.add(d(P,y,C)),x.setValueCurveAtTime(P,y,C);return T}};return e.set(T,x),o.set(T,h),t(T,M),T}});var Os,_s=i(()=>{Os=t=>({replay(o){for(let e of t)if(e.type==="exponentialRampToValue"){let{endTime:r,value:n}=e;o.exponentialRampToValueAtTime(n,r)}else if(e.type==="linearRampToValue"){let{endTime:r,value:n}=e;o.linearRampToValueAtTime(n,r)}else if(e.type==="setTarget"){let{startTime:r,target:n,timeConstant:s}=e;o.setTargetAtTime(n,r,s)}else if(e.type==="setValue"){let{startTime:r,value:n}=e;o.setValueAtTime(n,r)}else if(e.type==="setValueCurve"){let{duration:r,startTime:n,values:s}=e;o.setValueCurveAtTime(s,n,r)}else throw new Error("Can't apply an unknown automation.")}})});var Ft,qo=i(()=>{Ft=class{constructor(o){this._map=new Map(o)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(o,e=null){return this._map.forEach((r,n)=>o.call(e,r,n,this))}get(o){return this._map.get(o)}has(o){return this._map.has(o)}keys(){return this._map.keys()}values(){return this._map.values()}}});var dS,ks,Ds=i(()=>{fe();qo();dS={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},ks=(t,o,e,r,n,s,c,a,l,u,d,p,m,h)=>class extends o{constructor(x,f,g){var S;let A=a(x),M=l(A),T=d(N(N({},dS),g));m(T);let w=tr.get(A),y=w==null?void 0:w.get(f),C=M||A.state!=="closed"?A:(S=c(A))!==null&&S!==void 0?S:A,P=n(C,M?null:x.baseLatency,u,f,y,T),R=M?r(f,T,y):null;super(x,!0,P,R);let I=[];P.parameters.forEach((L,b)=>{let k=e(this,M,L);I.push([b,k])}),this._nativeAudioWorkletNode=P,this._onprocessorerror=null,this._parameters=new Ft(I),M&&t(A,this);let{activeInputs:E}=s(this);p(P,E)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){let f=typeof x=="function"?h(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=f;let g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===f?x:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}});function Ot(t,o,e,r,n){if(typeof t.copyFromChannel=="function")o[e].byteLength===0&&(o[e]=new Float32Array(128)),t.copyFromChannel(o[e],r,n);else{let s=t.getChannelData(r);if(o[e].byteLength===0)o[e]=s.slice(n,n+128);else{let c=new Float32Array(s.buffer,n*Float32Array.BYTES_PER_ELEMENT,128);o[e].set(c)}}}var Xo=i(()=>{});var Xr,Yo=i(()=>{Xr=(t,o,e,r,n)=>{typeof t.copyToChannel=="function"?o[e].byteLength!==0&&t.copyToChannel(o[e],r,n):o[e].byteLength!==0&&t.getChannelData(r).set(o[e],n)}});var _t,Zo=i(()=>{_t=(t,o)=>{let e=[];for(let r=0;r<t;r+=1){let n=[],s=typeof o=="number"?o:o[r];for(let c=0;c<s;c+=1)n.push(new Float32Array(128));e.push(n)}return e}});var Rs,Ls=i(()=>{fe();Gr();Be();Rs=(t,o)=>{let e=de(rr,t),r=ee(o);return de(e,r)}});var pS,Bs,Vs=i(()=>{Xo();Yo();Zo();ir();Ls();ve();pS=(t,o,e,r,n,s,c)=>O(void 0,null,function*(){let a=o===null?Math.ceil(t.context.length/128)*128:o.length,l=r.channelCount*r.numberOfInputs,u=n.reduce((f,g)=>f+g,0),d=u===0?null:e.createBuffer(u,a,e.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");let p=me(t),m=yield Rs(e,t),h=_t(r.numberOfInputs,r.channelCount),v=_t(r.numberOfOutputs,n),x=Array.from(t.parameters.keys()).reduce((f,g)=>F(N({},f),{[g]:new Float32Array(128)}),{});for(let f=0;f<a;f+=128){if(r.numberOfInputs>0&&o!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let S=0;S<r.channelCount;S+=1)Ot(o,h[g],S,S,f);s.parameterDescriptors!==void 0&&o!==null&&s.parameterDescriptors.forEach(({name:g},S)=>{Ot(o,x,g,l+S,f)});for(let g=0;g<r.numberOfInputs;g+=1)for(let S=0;S<n[g];S+=1)v[g][S].byteLength===0&&(v[g][S]=new Float32Array(128));try{let g=h.map((A,M)=>p.activeInputs[M].size===0?[]:A),S=c(f/e.sampleRate,e.sampleRate,()=>m.process(g,v,x));if(d!==null)for(let A=0,M=0;A<r.numberOfOutputs;A+=1){for(let T=0;T<n[A];T+=1)Xr(d,v[A],T,M+T,f);M+=n[A]}if(!S)break}catch(g){t.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return d}),Bs=(t,o,e,r,n,s,c,a,l,u,d,p,m,h,v,x)=>(f,g,S)=>{let A=new WeakMap,M=null,T=(w,y)=>O(void 0,null,function*(){let C=d(w),P=null,R=Y(C,y),I=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(p===null){let E=I.reduce((_,B)=>_+B,0),L=n(y,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),b=[];for(let _=0;_<w.numberOfOutputs;_+=1)b.push(r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:I[_]}));let k=c(y,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});k.connect=o.bind(null,b),k.disconnect=l.bind(null,b),P=[L,b,k]}else R||(C=new p(y,f));if(A.set(y,P===null?C:P[2]),P!==null){if(M===null){if(S===void 0)throw new Error("Missing the processor constructor.");if(m===null)throw new Error("Missing the native OfflineAudioContext constructor.");let B=w.channelCount*w.numberOfInputs,G=S.parameterDescriptors===void 0?0:S.parameterDescriptors.length,V=B+G;M=pS(w,V===0?null:yield(()=>O(void 0,null,function*(){let j=new m(V,Math.ceil(w.context.length/128)*128,y.sampleRate),Q=[],X=[];for(let J=0;J<g.numberOfInputs;J+=1)Q.push(c(j,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),X.push(n(j,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));let ue=yield Promise.all(Array.from(w.parameters.values()).map(J=>O(void 0,null,function*(){let z=s(j,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:J.value});return yield h(j,J,z.offset),z}))),Se=r(j,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,B+G)});for(let J=0;J<g.numberOfInputs;J+=1){Q[J].connect(X[J]);for(let z=0;z<g.channelCount;z+=1)X[J].connect(Se,z,J*g.channelCount+z)}for(let[J,z]of ue.entries())z.connect(Se,0,B+J),z.start(0);return Se.connect(j.destination),yield Promise.all(Q.map(J=>v(w,j,J))),x(j)}))(),y,g,I,S,u)}let E=yield M,L=e(y,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[b,k,_]=P;E!==null&&(L.buffer=E,L.start(0)),L.connect(b);for(let B=0,G=0;B<w.numberOfOutputs;B+=1){let V=k[B];for(let H=0;H<I[B];H+=1)b.connect(V,G+H,H);G+=I[B]}return _}if(R)for(let[E,L]of w.parameters.entries())yield t(y,L,C.parameters.get(E));else for(let[E,L]of w.parameters.entries())yield h(y,L,C.parameters.get(E));return yield v(w,y,C),C});return{render(w,y){a(y,w);let C=A.get(y);return C!==void 0?Promise.resolve(C):T(w,y)}}}});var Ws,Hs=i(()=>{Ws=(t,o,e,r,n,s,c,a,l,u,d,p,m,h,v,x,f,g,S,A)=>class extends v{constructor(T,w){super(T,w),this._nativeContext=T,this._audioWorklet=t===void 0?void 0:{addModule:(y,C)=>t(this,y,C)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new o(this)}createBiquadFilter(){return new n(this)}createBuffer(T,w,y){return new e({length:w,numberOfChannels:T,sampleRate:y})}createBufferSource(){return new r(this)}createChannelMerger(T=6){return new s(this,{numberOfInputs:T})}createChannelSplitter(T=6){return new c(this,{numberOfOutputs:T})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(T=1){return new d(this,{maxDelayTime:T})}createDynamicsCompressor(){return new p(this)}createGain(){return new m(this)}createIIRFilter(T,w){return new h(this,{feedback:w,feedforward:T})}createOscillator(){return new x(this)}createPanner(){return new f(this)}createPeriodicWave(T,w,y={disableNormalization:!1}){return new g(this,F(N({},y),{imag:w,real:T}))}createStereoPanner(){return new S(this)}createWaveShaper(){return new A(this)}decodeAudioData(T,w,y){return u(this._nativeContext,T).then(C=>(typeof w=="function"&&w(C),C),C=>{throw typeof y=="function"&&y(C),C})}}});var mS,Us,zs=i(()=>{Je();mS={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Us=(t,o,e,r,n,s,c,a)=>class extends t{constructor(u,d){let p=s(u),m=N(N({},mS),d),h=n(p,m),v=c(p),x=v?e():null;super(u,!1,h,x),this._Q=o(this,v,h.Q,ae,ce),this._detune=o(this,v,h.detune,1200*Math.log2(ae),-1200*Math.log2(ae)),this._frequency=o(this,v,h.frequency,u.sampleRate/2,0),this._gain=o(this,v,h.gain,40*Math.log10(ae),ce),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(u){this._nativeBiquadFilterNode.type=u}getFrequencyResponse(u,d,p){try{this._nativeBiquadFilterNode.getFrequencyResponse(u,d,p)}catch(m){throw m.code===11?r():m}if(u.length!==d.length||d.length!==p.length)throw r()}}});var Gs,js=i(()=>{ve();Gs=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=(a,l)=>O(void 0,null,function*(){let u=e(a),d=Y(u,l);if(!d){let p={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=o(l,p)}return s.set(l,u),d?(yield t(l,a.Q,u.Q),yield t(l,a.detune,u.detune),yield t(l,a.frequency,u.frequency),yield t(l,a.gain,u.gain)):(yield r(l,a.Q,u.Q),yield r(l,a.detune,u.detune),yield r(l,a.frequency,u.frequency),yield r(l,a.gain,u.gain)),yield n(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var qs,Xs=i(()=>{qs=(t,o)=>(e,r)=>{let n=o.get(e);if(n!==void 0)return n;let s=t.get(e);if(s!==void 0)return s;try{let c=r();return c instanceof Promise?(t.set(e,c),c.catch(()=>!1).then(a=>(t.delete(e),o.set(e,a),a))):(o.set(e,c),c)}catch(c){return o.set(e,!1),!1}}});var hS,Ys,Zs=i(()=>{hS={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Ys=(t,o,e,r,n)=>class extends t{constructor(c,a){let l=r(c),u=N(N({},hS),a),d=e(l,u),p=n(l)?o():null;super(c,!1,d,p)}}});var $s,Ks=i(()=>{ve();$s=(t,o,e)=>()=>{let r=new WeakMap,n=(s,c)=>O(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(c,u)}return r.set(c,a),yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):n(s,c)}}}});var fS,Qs,Js=i(()=>{fS={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Qs=(t,o,e,r,n,s)=>class extends t{constructor(a,l){let u=r(a),d=s(N(N({},fS),l)),p=e(u,d),m=n(u)?o():null;super(a,!1,p,m)}}});var ea,ta=i(()=>{ve();ea=(t,o,e)=>()=>{let r=new WeakMap,n=(s,c)=>O(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(c,u)}return r.set(c,a),yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):n(s,c)}}}});var ra,oa=i(()=>{ra=t=>(o,e,r)=>t(e,o,r)});var na,ia=i(()=>{qr();na=t=>(o,e,r=0,n=0)=>{let s=o[r];if(s===void 0)throw t();return ut(e)?s.connect(e,0,n):s.connect(e,0)}});var sa,aa=i(()=>{sa=t=>(o,e)=>{let r=t(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=o.createBuffer(1,2,44100);return r.buffer=n,r.loop=!0,r.connect(e),r.start(),()=>{r.stop(),r.disconnect(e)}}});var xS,ca,la=i(()=>{Je();st();Tt();At();xS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},ca=(t,o,e,r,n,s,c)=>class extends t{constructor(l,u){let d=n(l),p=N(N({},xS),u),m=r(d,p),h=s(d),v=h?e():null;super(l,!1,m,v),this._constantSourceNodeRenderer=v,this._nativeConstantSourceNode=m,this._offset=o(this,h,m.offset,ae,ce),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){let u=typeof l=="function"?c(this,l):null;this._nativeConstantSourceNode.onended=u;let d=this._nativeConstantSourceNode.onended;this._onended=d!==null&&d===u?l:d}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Fe(this);let u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),Ce(this)&&We(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}}});var ua,da=i(()=>{ve();ua=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=null,a=null,l=(u,d)=>O(void 0,null,function*(){let p=e(u),m=Y(p,d);if(!m){let h={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,offset:p.offset.value};p=o(d,h),c!==null&&p.start(c),a!==null&&p.stop(a)}return s.set(d,p),m?yield t(d,u.offset,p.offset):yield r(d,u.offset,p.offset),yield n(u,d,p),p});return{set start(u){c=u},set stop(u){a=u},render(u,d){let p=s.get(d);return p!==void 0?Promise.resolve(p):l(u,d)}}}});var pa,ma=i(()=>{pa=t=>o=>(t[0]=o,t[0])});var vS,ha,fa=i(()=>{vS={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},ha=(t,o,e,r,n,s)=>class extends t{constructor(a,l){let u=r(a),d=N(N({},vS),l),p=e(u,d),h=n(u)?o():null;super(a,!1,p,h),this._isBufferNullified=!1,this._nativeConvolverNode=p,d.buffer!==null&&s(this,d.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){let l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}}});var xa,va=i(()=>{ct();ve();xa=(t,o,e)=>()=>{let r=new WeakMap,n=(s,c)=>O(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(c,u)}return r.set(c,a),be(a)?yield e(s,c,a.inputs[0]):yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):n(s,c)}}}});var ga,ya=i(()=>{ga=(t,o)=>(e,r,n)=>{if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new o(e,r,n)}catch(s){throw s.name==="SyntaxError"?t():s}}});var Ca,wa=i(()=>{Ca=()=>new DOMException("","DataCloneError")});var $o,Na=i(()=>{$o=t=>{let{port1:o,port2:e}=new MessageChannel;return new Promise(r=>{let n=()=>{e.onmessage=null,o.close(),e.close(),r()};e.onmessage=()=>n();try{o.postMessage(t,[t])}catch(s){}finally{n()}})}});var Sa,Ta=i(()=>{Na();Br();Sa=(t,o,e,r,n,s,c,a,l,u,d)=>(p,m)=>{let h=c(p)?p:s(p);if(n.has(m)){let v=e();return Promise.reject(v)}try{n.add(m)}catch(v){}return o(l,()=>l(h))?h.decodeAudioData(m).then(v=>($o(m).catch(()=>{}),o(a,()=>a(v))||d(v),t.add(v),v)):new Promise((v,x)=>{let f=()=>O(void 0,null,function*(){try{yield $o(m)}catch(S){}}),g=S=>{x(S),f()};try{h.decodeAudioData(m,S=>{typeof S.copyFromChannel!="function"&&(u(S),It(S)),t.add(S),f().then(()=>v(S))},S=>{g(S===null?r():S)})}catch(S){g(S)}})}});var Aa,Ea=i(()=>{zr();Aa=(t,o,e,r,n,s,c,a)=>(l,u)=>{let d=o.get(l);if(d===void 0)throw new Error("Missing the expected cycle count.");let p=s(l.context),m=a(p);if(d===u){if(o.delete(l),!m&&c(l)){let h=r(l),{outputs:v}=e(l);for(let x of v)if(rt(x)){let f=r(x[0]);t(h,f,x[1],x[2])}else{let f=n(x[0]);h.connect(f,x[1])}}}else o.set(l,d-u)}});var gS,Ia,ba=i(()=>{gS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ia=(t,o,e,r,n,s,c)=>class extends t{constructor(l,u){let d=n(l),p=N(N({},gS),u),m=r(d,p),h=s(d),v=h?e(p.maxDelayTime):null;super(l,!1,m,v),this._delayTime=o(this,h,m.delayTime),c(this,p.maxDelayTime)}get delayTime(){return this._delayTime}}});var Ma,Pa=i(()=>{ve();Ma=(t,o,e,r,n)=>s=>{let c=new WeakMap,a=(l,u)=>O(void 0,null,function*(){let d=e(l),p=Y(d,u);if(!p){let m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,delayTime:d.delayTime.value,maxDelayTime:s};d=o(u,m)}return c.set(u,d),p?yield t(u,l.delayTime,d.delayTime):yield r(u,l.delayTime,d.delayTime),yield n(l,u,d),d});return{render(l,u){let d=c.get(u);return d!==void 0?Promise.resolve(d):a(l,u)}}}});var Fa,Oa=i(()=>{Fa=t=>(o,e,r,n)=>t(o[n],s=>s[0]===e&&s[1]===r)});var _a,ka=i(()=>{_a=t=>(o,e)=>{t(o).delete(e)}});var Da,Ra=i(()=>{Da=t=>"delayTime"in t});var La,Ba=i(()=>{Ur();Ra();La=(t,o,e)=>function r(n,s){let c=at(s)?s:e(t,s);if(Da(c))return[];if(n[0]===c)return[n];if(n.includes(c))return[];let{outputs:a}=o(c);return Array.from(a).map(l=>r([...n,c],l[0])).reduce((l,u)=>l.concat(u),[])}});var Yr,Va,Wa=i(()=>{qr();Yr=(t,o,e)=>{let r=o[e];if(r===void 0)throw t();return r},Va=t=>(o,e=void 0,r=void 0,n=0)=>e===void 0?o.forEach(s=>s.disconnect()):typeof e=="number"?Yr(t,o,e).disconnect():ut(e)?r===void 0?o.forEach(s=>s.disconnect(e)):n===void 0?Yr(t,o,r).disconnect(e,0):Yr(t,o,r).disconnect(e,0,n):r===void 0?o.forEach(s=>s.disconnect(e)):Yr(t,o,r).disconnect(e,0)});var yS,Ha,Ua=i(()=>{yS={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ha=(t,o,e,r,n,s,c,a)=>class extends t{constructor(u,d){let p=s(u),m=N(N({},yS),d),h=r(p,m),v=c(p),x=v?e():null;super(u,!1,h,x),this._attack=o(this,v,h.attack),this._knee=o(this,v,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=o(this,v,h.ratio),this._release=o(this,v,h.release),this._threshold=o(this,v,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(u){let d=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=u,u>2)throw this._nativeDynamicsCompressorNode.channelCount=d,n()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(u){let d=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=u,u==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=d,n()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}});var za,Ga=i(()=>{ve();za=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=(a,l)=>O(void 0,null,function*(){let u=e(a),d=Y(u,l);if(!d){let p={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=o(l,p)}return s.set(l,u),d?(yield t(l,a.attack,u.attack),yield t(l,a.knee,u.knee),yield t(l,a.ratio,u.ratio),yield t(l,a.release,u.release),yield t(l,a.threshold,u.threshold)):(yield r(l,a.attack,u.attack),yield r(l,a.knee,u.knee),yield r(l,a.ratio,u.ratio),yield r(l,a.release,u.release),yield r(l,a.threshold,u.threshold)),yield n(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var ja,qa=i(()=>{ja=()=>new DOMException("","EncodingError")});var Xa,Ya=i(()=>{Xa=t=>o=>new Promise((e,r)=>{if(t===null){r(new SyntaxError);return}let n=t.document.head;if(n===null)r(new SyntaxError);else{let s=t.document.createElement("script"),c=new Blob([o],{type:"application/javascript"}),a=URL.createObjectURL(c),l=t.onerror,u=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(d,p,m,h,v)=>{if(p===a||p===t.location.href&&m===1&&h===1)return u(),r(v),!1;if(l!==null)return l(d,p,m,h,v)},s.onerror=()=>{u(),r(new SyntaxError)},s.onload=()=>{u(),e()},s.src=a,s.type="module",n.appendChild(s)}})});var Za,$a=i(()=>{Za=t=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,r,n){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=t(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(e,s,n)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,r,n){let s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(e,s===void 0?null:s,n)}}});var Ka,Qa=i(()=>{Ka=t=>(o,e,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(o*e)}},currentTime:{configurable:!0,get(){return o}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}}});var Ja,ec=i(()=>{Ja=t=>o=>O(void 0,null,function*(){try{let e=yield fetch(o);if(e.ok)return[yield e.text(),e.url]}catch(e){}throw t()})});var CS,tc,rc=i(()=>{Je();CS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},tc=(t,o,e,r,n,s)=>class extends t{constructor(a,l){let u=n(a),d=N(N({},CS),l),p=r(u,d),m=s(u),h=m?e():null;super(a,!1,p,h),this._gain=o(this,m,p.gain,ae,ce)}get gain(){return this._gain}}});var oc,nc=i(()=>{ve();oc=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=(a,l)=>O(void 0,null,function*(){let u=e(a),d=Y(u,l);if(!d){let p={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=o(l,p)}return s.set(l,u),d?yield t(l,a.gain,u.gain):yield r(l,a.gain,u.gain),yield n(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var ic,sc=i(()=>{ic=(t,o)=>e=>o(t,e)});var ac,cc=i(()=>{ac=t=>o=>{let e=t(o);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer}});var lc,uc=i(()=>{lc=t=>o=>{var e;return(e=t.get(o))!==null&&e!==void 0?e:0}});var dc,pc=i(()=>{dc=t=>o=>{let e=t(o);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer}});var mc,hc=i(()=>{mc=t=>o=>t.get(o)});var ne,cr=i(()=>{ne=()=>new DOMException("","InvalidStateError")});var fc,xc=i(()=>{cr();fc=t=>o=>{let e=t.get(o);if(e===void 0)throw ne();return e}});var vc,gc=i(()=>{vc=(t,o)=>e=>{let r=t.get(e);if(r!==void 0)return r;if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new o(1,1,44100),t.set(e,r),r}});var yc,Cc=i(()=>{yc=t=>o=>{let e=t.get(o);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e}});var kt,Ko=i(()=>{kt=()=>new DOMException("","InvalidAccessError")});var wc,Nc=i(()=>{Ko();wc=t=>{t.getFrequencyResponse=(o=>(e,r,n)=>{if(e.length!==r.length||r.length!==n.length)throw kt();return o.call(t,e,r,n)})(t.getFrequencyResponse)}});var wS,Sc,Tc=i(()=>{Nc();wS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Sc=(t,o,e,r,n,s)=>class extends t{constructor(a,l){let u=r(a),d=n(u),p=N(N({},wS),l),m=o(u,d?null:a.baseLatency,p),h=d?e(p.feedback,p.feedforward):null;super(a,!1,m,h),wc(m),this._nativeIIRFilterNode=m,s(this,1)}getFrequencyResponse(a,l,u){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,u)}}});var Zr,Qo=i(()=>{Zr=(t,o,e,r,n,s,c,a,l,u,d)=>{let p=u.length,m=a;for(let h=0;h<p;h+=1){let v=e[0]*u[h];for(let x=1;x<n;x+=1){let f=m-x&l-1;v+=e[x]*s[f],v-=t[x]*c[f]}for(let x=n;x<r;x+=1)v+=e[x]*s[m-x&l-1];for(let x=n;x<o;x+=1)v-=t[x]*c[m-x&l-1];s[m]=u[h],c[m]=v,m=m+1&l-1,d[h]=v}return m}});var NS,Ac,Ec=i(()=>{Qo();ve();NS=(t,o,e,r)=>{let n=e instanceof Float64Array?e:new Float64Array(e),s=r instanceof Float64Array?r:new Float64Array(r),c=n.length,a=s.length,l=Math.min(c,a);if(n[0]!==1){for(let v=0;v<c;v+=1)s[v]/=n[0];for(let v=1;v<a;v+=1)n[v]/=n[0]}let u=32,d=new Float32Array(u),p=new Float32Array(u),m=o.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let v=0;v<h;v+=1){let x=t.getChannelData(v),f=m.getChannelData(v);d.fill(0),p.fill(0),Zr(n,c,s,a,l,d,p,0,u,x,f)}return m},Ac=(t,o,e,r,n)=>(s,c)=>{let a=new WeakMap,l=null,u=(d,p)=>O(void 0,null,function*(){let m=null,h=o(d),v=Y(h,p);if(p.createIIRFilter===void 0?m=t(p,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):v||(h=p.createIIRFilter(c,s)),a.set(p,m===null?h:m),m!==null){if(l===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");let f=new e(d.context.destination.channelCount,d.context.length,p.sampleRate);l=(()=>O(void 0,null,function*(){yield r(d,f,f.destination);let g=yield n(f);return NS(g,p,s,c)}))()}let x=yield l;return m.buffer=x,m.start(0),m}return yield r(d,p,h),h});return{render(d,p){let m=a.get(p);return m!==void 0?Promise.resolve(m):u(d,p)}}}});var Ic,bc=i(()=>{zr();Ic=(t,o,e,r,n,s)=>c=>(a,l)=>{let u=t.get(a);if(u===void 0){if(!c&&s(a)){let d=r(a),{outputs:p}=e(a);for(let m of p)if(rt(m)){let h=r(m[0]);o(d,h,m[1],m[2])}else{let h=n(m[0]);d.disconnect(h,m[1])}}t.set(a,l)}else t.set(a,u+l)}});var Mc,Pc=i(()=>{Mc=(t,o)=>e=>{let r=t.get(e);return o(r)||o(e)}});var Fc,Oc=i(()=>{Fc=(t,o)=>e=>t.has(e)||o(e)});var _c,kc=i(()=>{_c=(t,o)=>e=>t.has(e)||o(e)});var Dc,Rc=i(()=>{Dc=(t,o)=>e=>{let r=t.get(e);return o(r)||o(e)}});var Lc,Bc=i(()=>{Lc=t=>o=>t!==null&&o instanceof t});var Vc,Wc=i(()=>{Vc=t=>o=>t!==null&&typeof t.AudioNode=="function"&&o instanceof t.AudioNode});var Hc,Uc=i(()=>{Hc=t=>o=>t!==null&&typeof t.AudioParam=="function"&&o instanceof t.AudioParam});var zc,Gc=i(()=>{zc=(t,o)=>e=>t(e)||o(e)});var jc,qc=i(()=>{jc=t=>o=>t!==null&&o instanceof t});var Xc,Yc=i(()=>{Xc=t=>t!==null&&t.isSecureContext});var Zc,$c=i(()=>{Zc=(t,o,e,r,n,s,c,a,l,u,d,p,m,h,v,x)=>O(void 0,null,function*(){return t(o,o)&&t(e,e)&&t(n,n)&&t(s,s)&&t(a,a)&&t(l,l)&&t(u,u)&&t(d,d)&&t(p,p)&&t(m,m)&&t(h,h)?(yield Promise.all([t(r,r),t(c,c),t(v,v),t(x,x)])).every(g=>g):!1})});var Kc,Qc=i(()=>{Kc=(t,o,e,r)=>class extends t{constructor(s,c){let a=e(s),l=o(a,c);if(r(a))throw TypeError();super(s,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}}});var SS,Jc,el=i(()=>{SS={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Jc=(t,o,e,r)=>class extends t{constructor(s,c){let a=e(s);if(r(a))throw new TypeError;let l=N(N({},SS),c),u=o(a,l);super(s,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}});var tl,rl=i(()=>{tl=(t,o,e,r)=>class extends t{constructor(s,c){let a=e(s),l=o(a,c);if(r(a))throw new TypeError;super(s,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}});var ol,nl=i(()=>{ol=(t,o,e)=>class extends t{constructor(n,s){let c=e(n),a=o(c,s);super(n,!0,a,null)}}});var il,sl=i(()=>{sr();Oo();il=(t,o,e,r,n)=>class extends r{constructor(c={}){if(n===null)throw new Error("Missing the native AudioContext constructor.");let a;try{a=new n(c)}catch(d){throw d.code===12&&d.message==="sampleRate is not in range"?o():d}if(a===null)throw e();if(!Hr(c.latencyHint))throw new TypeError(`The provided value '${c.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(c.sampleRate!==void 0&&a.sampleRate!==c.sampleRate)throw o();super(a,2);let{latencyHint:l}=c,{sampleRate:u}=a;if(this._baseLatency=typeof a.baseLatency=="number"?a.baseLatency:l==="balanced"?512/u:l==="interactive"||l===void 0?256/u:l==="playback"?1024/u:Math.max(2,Math.min(128,Math.round(l*u/128)))*128/u,this._nativeAudioContext=a,n.name==="webkitAudioContext"?(this._nativeGainNode=a.createGain(),this._nativeOscillatorNode=a.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(a.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,a.state==="running"){this._state="suspended";let d=()=>{this._state==="suspended"&&(this._state=null),a.removeEventListener("statechange",d)};a.addEventListener("statechange",d)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),tt(this)}))}resume(){return this._state==="suspended"?new Promise((c,a)=>{let l=()=>{this._nativeAudioContext.removeEventListener("statechange",l),this._nativeAudioContext.state==="running"?c():this.resume().then(c,a)};this._nativeAudioContext.addEventListener("statechange",l)}):this._nativeAudioContext.resume().catch(c=>{throw c===void 0||c.code===15?t():c})}suspend(){return this._nativeAudioContext.suspend().catch(c=>{throw c===void 0?t():c})}}});var al,cl=i(()=>{fe();al=(t,o,e,r,n,s)=>class extends e{constructor(a,l){super(a),this._nativeContext=a,Nt.set(this,a),r(a)&&n.set(a,new Set),this._destination=new t(this,l),this._listener=o(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){let l=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=l;let u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===l?a:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}});var _e,lr=i(()=>{_e=t=>{let o=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let e=t.decodeAudioData(o.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch(e){}return!1}});var TS,ll,ul=i(()=>{sr();lr();TS={numberOfChannels:1},ll=(t,o,e,r,n)=>class extends r{constructor(c){let{length:a,numberOfChannels:l,sampleRate:u}=N(N({},TS),c),d=e(l,a,u);t(_e,()=>_e(d))||d.addEventListener("statechange",(()=>{let p=0,m=h=>{this._state==="running"&&(p>0?(d.removeEventListener("statechange",m),h.stopImmediatePropagation(),this._waitForThePromiseToSettle(h)):p+=1)};return m})()),super(d,l),this._length=a,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(o()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,tt(this)}))}_waitForThePromiseToSettle(c){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(c):setTimeout(()=>this._waitForThePromiseToSettle(c))}}});var dl,pl=i(()=>{dl=(t,o)=>(e,r,n)=>{let s=new Set;return e.connect=(c=>(a,l=0,u=0)=>{let d=s.size===0;if(o(a))return c.call(e,a,l,u),t(s,[a,l,u],p=>p[0]===a&&p[1]===l&&p[2]===u,!0),d&&r(),a;c.call(e,a,l),t(s,[a,l],p=>p[0]===a&&p[1]===l,!0),d&&r()})(e.connect),e.disconnect=(c=>(a,l,u)=>{let d=s.size>0;if(a===void 0)c.apply(e),s.clear();else if(typeof a=="number"){c.call(e,a);for(let m of s)m[1]===a&&s.delete(m)}else{o(a)?c.call(e,a,l,u):c.call(e,a,l);for(let m of s)m[0]===a&&(l===void 0||m[1]===l)&&(u===void 0||m[2]===u)&&s.delete(m)}let p=s.size===0;d&&p&&n()})(e.disconnect),e}});var Z,Ye=i(()=>{Z=(t,o,e)=>{let r=o[e];r!==void 0&&r!==t[e]&&(t[e]=r)}});var q,he=i(()=>{Ye();q=(t,o)=>{Z(t,o,"channelCount"),Z(t,o,"channelCountMode"),Z(t,o,"channelInterpretation")}});var Jo,ml=i(()=>{Jo=t=>typeof t.getFloatTimeDomainData=="function"});var hl,fl=i(()=>{hl=t=>{t.getFloatTimeDomainData=o=>{let e=new Uint8Array(o.length);t.getByteTimeDomainData(e);let r=Math.max(e.length,t.fftSize);for(let n=0;n<r;n+=1)o[n]=(e[n]-128)*.0078125;return o}}});var xl,vl=i(()=>{Ye();he();ml();fl();xl=(t,o)=>(e,r)=>{let n=e.createAnalyser();if(q(n,r),!(r.maxDecibels>r.minDecibels))throw o();return Z(n,r,"fftSize"),Z(n,r,"maxDecibels"),Z(n,r,"minDecibels"),Z(n,r,"smoothingTimeConstant"),t(Jo,()=>Jo(n))||hl(n),n}});var gl,yl=i(()=>{gl=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null});var K,He=i(()=>{K=(t,o,e)=>{let r=o[e];r!==void 0&&r!==t[e].value&&(t[e].value=r)}});var Cl,wl=i(()=>{cr();Cl=t=>{t.start=(o=>{let e=!1;return(r=0,n=0,s)=>{if(e)throw ne();o.call(t,r,n,s),e=!0}})(t.start)}});var Dt,$r=i(()=>{Dt=t=>{t.start=(o=>(e=0,r=0,n)=>{if(typeof n=="number"&&n<0||r<0||e<0)throw new RangeError("The parameters can't be negative.");o.call(t,e,r,n)})(t.start)}});var Rt,Kr=i(()=>{Rt=t=>{t.stop=(o=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");o.call(t,e)})(t.stop)}});var Nl,Sl=i(()=>{He();Ye();he();wl();$r();Kr();Nl=(t,o,e,r,n,s,c,a,l,u,d)=>(p,m)=>{let h=p.createBufferSource();return q(h,m),K(h,m,"playbackRate"),Z(h,m,"buffer"),Z(h,m,"loop"),Z(h,m,"loopEnd"),Z(h,m,"loopStart"),o(e,()=>e(p))||Cl(h),o(r,()=>r(p))||l(h),o(n,()=>n(p))||u(h,p),o(s,()=>s(p))||Dt(h),o(c,()=>c(p))||d(h,p),o(a,()=>a(p))||Rt(h),t(p,h),h}});var Tl,Al=i(()=>{Tl=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null});var El,Il=i(()=>{El=(t,o)=>(e,r,n)=>{let s=e.destination;if(s.channelCount!==r)try{s.channelCount=r}catch(a){}n&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});let c=t(e,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return o(c,"channelCount",a=>()=>a.call(c),a=>l=>{a.call(c,l);try{s.channelCount=l}catch(u){if(l>s.maxChannelCount)throw u}}),o(c,"channelCountMode",a=>()=>a.call(c),a=>l=>{a.call(c,l),s.channelCountMode=l}),o(c,"channelInterpretation",a=>()=>a.call(c),a=>l=>{a.call(c,l),s.channelInterpretation=l}),Object.defineProperty(c,"maxChannelCount",{get:()=>s.maxChannelCount}),c.connect(s),c}});var bl,Ml=i(()=>{bl=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null});var Pl,Fl=i(()=>{Pl=t=>{let{port1:o}=new MessageChannel;try{o.postMessage(t)}finally{o.close()}}});var Ol,_l=i(()=>{Fl();Ol=(t,o,e,r,n)=>(s,c,a,l,u,d)=>{if(a!==null)try{let p=new a(s,l,d),m=new Map,h=null;if(Object.defineProperties(p,{channelCount:{get:()=>d.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:v=>{typeof h=="function"&&p.removeEventListener("processorerror",h),h=typeof v=="function"?v:null,typeof h=="function"&&p.addEventListener("processorerror",h)}}}),p.addEventListener=(v=>(...x)=>{if(x[0]==="processorerror"){let f=typeof x[1]=="function"?x[1]:typeof x[1]=="object"&&x[1]!==null&&typeof x[1].handleEvent=="function"?x[1].handleEvent:null;if(f!==null){let g=m.get(x[1]);g!==void 0?x[1]=g:(x[1]=S=>{S.type==="error"?(Object.defineProperties(S,{type:{value:"processorerror"}}),f(S)):f(new ErrorEvent(x[0],N({},S)))},m.set(f,x[1]))}}return v.call(p,"error",x[1],x[2]),v.call(p,...x)})(p.addEventListener),p.removeEventListener=(v=>(...x)=>{if(x[0]==="processorerror"){let f=m.get(x[1]);f!==void 0&&(m.delete(x[1]),x[1]=f)}return v.call(p,"error",x[1],x[2]),v.call(p,x[0],x[1],x[2])})(p.removeEventListener),d.numberOfOutputs!==0){let v=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(v).connect(s.destination),n(p,()=>v.disconnect(),()=>v.connect(s.destination))}return p}catch(p){throw p.code===11?r():p}if(u===void 0)throw r();return Pl(d),o(s,c,u,d)}});var Qr,en=i(()=>{Qr=(t,o)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*o)))))});var kl,Dl=i(()=>{kl=t=>new Promise((o,e)=>{let{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),n.close(),o(s)},r.onmessageerror=({data:s})=>{r.close(),n.close(),e(s)},n.postMessage(t)})});var Rl,Ll=i(()=>{Dl();Rl=(t,o)=>O(void 0,null,function*(){let e=yield kl(o);return new t(e)})});var Bl,Vl=i(()=>{fe();Ll();Bl=(t,o,e,r)=>{let n=rr.get(t);n===void 0&&(n=new WeakMap,rr.set(t,n));let s=Rl(e,r);return n.set(o,s),s}});var Wl,Hl=i(()=>{Je();en();Xo();Yo();Vl();Zo();qo();Wl=(t,o,e,r,n,s,c,a,l,u,d,p,m)=>(h,v,x,f)=>{if(f.numberOfInputs===0&&f.numberOfOutputs===0)throw l();let g=Array.isArray(f.outputChannelCount)?f.outputChannelCount:Array.from(f.outputChannelCount);if(g.some(D=>D<1))throw l();if(g.length!==f.numberOfOutputs)throw o();if(f.channelCountMode!=="explicit")throw l();let S=f.channelCount*f.numberOfInputs,A=g.reduce((D,U)=>D+U,0),M=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(S+M>6||A>6)throw l();let T=new MessageChannel,w=[],y=[];for(let D=0;D<f.numberOfInputs;D+=1)w.push(c(h,{channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:1})),y.push(n(h,{channelCount:f.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:f.channelCount}));let C=[];if(x.parameterDescriptors!==void 0)for(let{defaultValue:D,maxValue:U,minValue:pe,name:ie}of x.parameterDescriptors){let $=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:f.parameterData[ie]!==void 0?f.parameterData[ie]:D===void 0?0:D});Object.defineProperties($.offset,{defaultValue:{get:()=>D===void 0?0:D},maxValue:{get:()=>U===void 0?ae:U},minValue:{get:()=>pe===void 0?ce:pe}}),C.push($)}let P=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,S+M)}),R=Qr(v,h.sampleRate),I=a(h,R,S+M,Math.max(1,A)),E=n(h,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),L=[];for(let D=0;D<f.numberOfOutputs;D+=1)L.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[D]}));for(let D=0;D<f.numberOfInputs;D+=1){w[D].connect(y[D]);for(let U=0;U<f.channelCount;U+=1)y[D].connect(P,U,D*f.channelCount+U)}let b=new Ft(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:D},U)=>{let pe=C[U];return pe.connect(P,0,S+U),pe.start(0),[D,pe.offset]}));P.connect(I);let k=f.channelInterpretation,_=null,B=f.numberOfOutputs===0?[I]:L,G={get bufferSize(){return R},get channelCount(){return f.channelCount},set channelCount(D){throw e()},get channelCountMode(){return f.channelCountMode},set channelCountMode(D){throw e()},get channelInterpretation(){return k},set channelInterpretation(D){for(let U of w)U.channelInterpretation=D;k=D},get context(){return I.context},get inputs(){return w},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get onprocessorerror(){return _},set onprocessorerror(D){typeof _=="function"&&G.removeEventListener("processorerror",_),_=typeof D=="function"?D:null,typeof _=="function"&&G.addEventListener("processorerror",_)},get parameters(){return b},get port(){return T.port2},addEventListener(...D){return I.addEventListener(D[0],D[1],D[2])},connect:t.bind(null,B),disconnect:u.bind(null,B),dispatchEvent(...D){return I.dispatchEvent(D[0])},removeEventListener(...D){return I.removeEventListener(D[0],D[1],D[2])}},V=new Map;T.port1.addEventListener=(D=>(...U)=>{if(U[0]==="message"){let pe=typeof U[1]=="function"?U[1]:typeof U[1]=="object"&&U[1]!==null&&typeof U[1].handleEvent=="function"?U[1].handleEvent:null;if(pe!==null){let ie=V.get(U[1]);ie!==void 0?U[1]=ie:(U[1]=$=>{d(h.currentTime,h.sampleRate,()=>pe($))},V.set(pe,U[1]))}}return D.call(T.port1,U[0],U[1],U[2])})(T.port1.addEventListener),T.port1.removeEventListener=(D=>(...U)=>{if(U[0]==="message"){let pe=V.get(U[1]);pe!==void 0&&(V.delete(U[1]),U[1]=pe)}return D.call(T.port1,U[0],U[1],U[2])})(T.port1.removeEventListener);let H=null;Object.defineProperty(T.port1,"onmessage",{get:()=>H,set:D=>{typeof H=="function"&&T.port1.removeEventListener("message",H),H=typeof D=="function"?D:null,typeof H=="function"&&(T.port1.addEventListener("message",H),T.port1.start())}}),x.prototype.port=T.port1;let j=null;Bl(h,G,x,f).then(D=>j=D);let X=_t(f.numberOfInputs,f.channelCount),ue=_t(f.numberOfOutputs,g),Se=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((D,{name:U})=>F(N({},D),{[U]:new Float32Array(128)}),{}),J=!0,z=()=>{f.numberOfOutputs>0&&I.disconnect(E);for(let D=0,U=0;D<f.numberOfOutputs;D+=1){let pe=L[D];for(let ie=0;ie<g[D];ie+=1)E.disconnect(pe,U+ie,ie);U+=g[D]}},ft=new Map;I.onaudioprocess=({inputBuffer:D,outputBuffer:U})=>{if(j!==null){let pe=p(G);for(let ie=0;ie<R;ie+=128){for(let $=0;$<f.numberOfInputs;$+=1)for(let se=0;se<f.channelCount;se+=1)Ot(D,X[$],se,se,ie);x.parameterDescriptors!==void 0&&x.parameterDescriptors.forEach(({name:$},se)=>{Ot(D,Se,$,S+se,ie)});for(let $=0;$<f.numberOfInputs;$+=1)for(let se=0;se<g[$];se+=1)ue[$][se].byteLength===0&&(ue[$][se]=new Float32Array(128));try{let $=X.map((Ae,$e)=>{if(pe[$e].size>0)return ft.set($e,R/128),Ae;let so=ft.get($e);return so===void 0?[]:(Ae.every(HN=>HN.every(UN=>UN===0))&&(so===1?ft.delete($e):ft.set($e,so-1)),Ae)});J=d(h.currentTime+ie/h.sampleRate,h.sampleRate,()=>j.process($,ue,Se));for(let Ae=0,$e=0;Ae<f.numberOfOutputs;Ae+=1){for(let Xt=0;Xt<g[Ae];Xt+=1)Xr(U,ue[Ae],Xt,$e+Xt,ie);$e+=g[Ae]}}catch($){J=!1,G.dispatchEvent(new ErrorEvent("processorerror",{colno:$.colno,filename:$.filename,lineno:$.lineno,message:$.message}))}if(!J){for(let $=0;$<f.numberOfInputs;$+=1){w[$].disconnect(y[$]);for(let se=0;se<f.channelCount;se+=1)y[ie].disconnect(P,se,$*f.channelCount+se)}if(x.parameterDescriptors!==void 0){let $=x.parameterDescriptors.length;for(let se=0;se<$;se+=1){let Ae=C[se];Ae.disconnect(P,0,S+se),Ae.stop()}}P.disconnect(I),I.onaudioprocess=null,Gt?z():vt();break}}}};let Gt=!1,W=c(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),xt=()=>I.connect(W).connect(h.destination),vt=()=>{I.disconnect(W),W.disconnect()},jt=()=>{if(J){vt(),f.numberOfOutputs>0&&I.connect(E);for(let D=0,U=0;D<f.numberOfOutputs;D+=1){let pe=L[D];for(let ie=0;ie<g[D];ie+=1)E.connect(pe,U+ie,ie);U+=g[D]}}Gt=!0},qt=()=>{J&&(xt(),z()),Gt=!1};return xt(),m(G,jt,qt)}});var tn,Ul=i(()=>{He();Ye();he();tn=(t,o)=>{let e=t.createBiquadFilter();return q(e,o),K(e,o,"Q"),K(e,o,"detune"),K(e,o,"frequency"),K(e,o,"gain"),Z(e,o,"type"),e}});var zl,Gl=i(()=>{he();zl=(t,o)=>(e,r)=>{let n=e.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&o(e,n),q(n,r),n}});var jl,ql=i(()=>{cr();jl=t=>{let o=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>o,set:e=>{if(e!==o)throw ne()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw ne()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw ne()}})}});var Lt,Xl=i(()=>{he();ql();Lt=(t,o)=>{let e=t.createChannelSplitter(o.numberOfOutputs);return q(e,o),jl(e),e}});var Yl,Zl=i(()=>{He();he();$r();Kr();Yl=(t,o,e,r,n)=>(s,c)=>{if(s.createConstantSource===void 0)return e(s,c);let a=s.createConstantSource();return q(a,c),K(a,c,"offset"),o(r,()=>r(s))||Dt(a),o(n,()=>n(s))||Rt(a),t(s,a),a}});var Me,dt=i(()=>{Me=(t,o)=>(t.connect=o.connect.bind(o),t.disconnect=o.disconnect.bind(o),t)});var $l,Kl=i(()=>{dt();$l=(t,o,e,r)=>(n,a)=>{var l=a,{offset:s}=l,c=Ke(l,["offset"]);let u=n.createBuffer(1,2,44100),d=o(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),p=e(n,F(N({},c),{gain:s})),m=u.getChannelData(0);m[0]=1,m[1]=1,d.buffer=u,d.loop=!0;let h={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(f){p.channelCount=f},get channelCountMode(){return p.channelCountMode},set channelCountMode(f){p.channelCountMode=f},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(f){p.channelInterpretation=f},get context(){return p.context},get inputs(){return[]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get offset(){return p.gain},get onended(){return d.onended},set onended(f){d.onended=f},addEventListener(...f){return d.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return d.dispatchEvent(f[0])},removeEventListener(...f){return d.removeEventListener(f[0],f[1],f[2])},start(f=0){d.start.call(d,f)},stop(f=0){d.stop.call(d,f)}},v=()=>d.connect(p),x=()=>d.disconnect(p);return t(n,d),r(Me(h,p),v,x)}});var Ql,Jl=i(()=>{Ye();he();Ql=(t,o)=>(e,r)=>{let n=e.createConvolver();if(q(n,r),r.disableNormalization===n.normalize&&(n.normalize=!r.disableNormalization),Z(n,r,"buffer"),r.channelCount>2||(o(n,"channelCount",s=>()=>s.call(n),s=>c=>{if(c>2)throw t();return s.call(n,c)}),r.channelCountMode==="max"))throw t();return o(n,"channelCountMode",s=>()=>s.call(n),s=>c=>{if(c==="max")throw t();return s.call(n,c)}),n}});var rn,eu=i(()=>{He();he();rn=(t,o)=>{let e=t.createDelay(o.maxDelayTime);return q(e,o),K(e,o,"delayTime"),e}});var tu,ru=i(()=>{He();he();tu=t=>(o,e)=>{let r=o.createDynamicsCompressor();if(q(r,e),e.channelCount>2||e.channelCountMode==="max")throw t();return K(r,e,"attack"),K(r,e,"knee"),K(r,e,"ratio"),K(r,e,"release"),K(r,e,"threshold"),r}});var we,ou=i(()=>{He();he();we=(t,o)=>{let e=t.createGain();return q(e,o),K(e,o,"gain"),e}});var nu,iu=i(()=>{he();nu=t=>(o,e,r)=>{if(o.createIIRFilter===void 0)return t(o,e,r);let n=o.createIIRFilter(r.feedforward,r.feedback);return q(n,r),n}});function AS(t,o){let e=o[0]*o[0]+o[1]*o[1];return[(t[0]*o[0]+t[1]*o[1])/e,(t[1]*o[0]-t[0]*o[1])/e]}function ES(t,o){return[t[0]*o[0]-t[1]*o[1],t[0]*o[1]+t[1]*o[0]]}function su(t,o){let e=[0,0];for(let r=t.length-1;r>=0;r-=1)e=ES(e,o),e[0]+=t[r];return e}var au,cu=i(()=>{en();Qo();dt();au=(t,o,e,r)=>(n,s,{channelCount:c,channelCountMode:a,channelInterpretation:l,feedback:u,feedforward:d})=>{let p=Qr(s,n.sampleRate),m=u instanceof Float64Array?u:new Float64Array(u),h=d instanceof Float64Array?d:new Float64Array(d),v=m.length,x=h.length,f=Math.min(v,x);if(v===0||v>20)throw r();if(m[0]===0)throw o();if(x===0||x>20)throw r();if(h[0]===0)throw o();if(m[0]!==1){for(let C=0;C<x;C+=1)h[C]/=m[0];for(let C=1;C<v;C+=1)m[C]/=m[0]}let g=e(n,p,c,c);g.channelCount=c,g.channelCountMode=a,g.channelInterpretation=l;let S=32,A=[],M=[],T=[];for(let C=0;C<c;C+=1){A.push(0);let P=new Float32Array(S),R=new Float32Array(S);P.fill(0),R.fill(0),M.push(P),T.push(R)}g.onaudioprocess=C=>{let P=C.inputBuffer,R=C.outputBuffer,I=P.numberOfChannels;for(let E=0;E<I;E+=1){let L=P.getChannelData(E),b=R.getChannelData(E);A[E]=Zr(m,v,h,x,f,M[E],T[E],A[E],S,L,b)}};let w=n.sampleRate/2;return Me({get bufferSize(){return p},get channelCount(){return g.channelCount},set channelCount(C){g.channelCount=C},get channelCountMode(){return g.channelCountMode},set channelCountMode(C){g.channelCountMode=C},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(C){g.channelInterpretation=C},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...C){return g.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return g.dispatchEvent(C[0])},getFrequencyResponse(C,P,R){if(C.length!==P.length||P.length!==R.length)throw t();let I=C.length;for(let E=0;E<I;E+=1){let L=-Math.PI*(C[E]/w),b=[Math.cos(L),Math.sin(L)],k=su(h,b),_=su(m,b),B=AS(k,_);P[E]=Math.sqrt(B[0]*B[0]+B[1]*B[1]),R[E]=Math.atan2(B[1],B[0])}},removeEventListener(...C){return g.removeEventListener(C[0],C[1],C[2])}},g)}});var lu,uu=i(()=>{lu=(t,o)=>t.createMediaElementSource(o.mediaElement)});var du,pu=i(()=>{he();du=(t,o)=>{let e=t.createMediaStreamDestination();return q(e,o),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e}});var mu,hu=i(()=>{mu=(t,{mediaStream:o})=>{let e=o.getAudioTracks();e.sort((s,c)=>s.id<c.id?-1:s.id>c.id?1:0);let r=e.slice(0,1),n=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(n,"mediaStream",{value:o}),n}});var fu,xu=i(()=>{fu=(t,o)=>(e,{mediaStreamTrack:r})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(r);let n=new MediaStream([r]),s=e.createMediaStreamSource(n);if(r.kind!=="audio")throw t();if(o(e))throw new TypeError;return s}});var vu,gu=i(()=>{vu=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null});var yu,Cu=i(()=>{He();Ye();he();$r();Kr();yu=(t,o,e,r,n,s)=>(c,a)=>{let l=c.createOscillator();return q(l,a),K(l,a,"detune"),K(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Z(l,a,"type"),o(e,()=>e(c))||Dt(l),o(r,()=>r(c))||s(l,c),o(n,()=>n(c))||Rt(l),t(c,l),l}});var wu,Nu=i(()=>{He();Ye();he();wu=t=>(o,e)=>{let r=o.createPanner();return r.orientationX===void 0?t(o,e):(q(r,e),K(r,e,"orientationX"),K(r,e,"orientationY"),K(r,e,"orientationZ"),K(r,e,"positionX"),K(r,e,"positionY"),K(r,e,"positionZ"),Z(r,e,"coneInnerAngle"),Z(r,e,"coneOuterAngle"),Z(r,e,"coneOuterGain"),Z(r,e,"distanceModel"),Z(r,e,"maxDistance"),Z(r,e,"panningModel"),Z(r,e,"refDistance"),Z(r,e,"rolloffFactor"),r)}});var Su,Tu=i(()=>{he();dt();Su=(t,o,e,r,n,s,c,a,l,u)=>(d,R)=>{var I=R,{coneInnerAngle:p,coneOuterAngle:m,coneOuterGain:h,distanceModel:v,maxDistance:x,orientationX:f,orientationY:g,orientationZ:S,panningModel:A,positionX:M,positionY:T,positionZ:w,refDistance:y,rolloffFactor:C}=I,P=Ke(I,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);let E=d.createPanner();if(P.channelCount>2||P.channelCountMode==="max")throw c();q(E,P);let L={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},b=e(d,F(N({},L),{channelInterpretation:"speakers",numberOfInputs:6})),k=r(d,F(N({},P),{gain:1})),_=r(d,F(N({},L),{gain:1})),B=r(d,F(N({},L),{gain:0})),G=r(d,F(N({},L),{gain:0})),V=r(d,F(N({},L),{gain:0})),H=r(d,F(N({},L),{gain:0})),j=r(d,F(N({},L),{gain:0})),Q=n(d,256,6,1),X=s(d,F(N({},L),{curve:new Float32Array([1,1]),oversample:"none"})),ue=[f,g,S],Se=[M,T,w],J=new Float32Array(1);Q.onaudioprocess=({inputBuffer:W})=>{let xt=[l(W,J,0),l(W,J,1),l(W,J,2)];xt.some((jt,qt)=>jt!==ue[qt])&&(E.setOrientation(...xt),ue=xt);let vt=[l(W,J,3),l(W,J,4),l(W,J,5)];vt.some((jt,qt)=>jt!==Se[qt])&&(E.setPosition(...vt),Se=vt)},Object.defineProperty(B.gain,"defaultValue",{get:()=>0}),Object.defineProperty(G.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(H.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0});let z={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(W){if(W>2)throw c();k.channelCount=W,E.channelCount=W},get channelCountMode(){return E.channelCountMode},set channelCountMode(W){if(W==="max")throw c();k.channelCountMode=W,E.channelCountMode=W},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(W){k.channelInterpretation=W,E.channelInterpretation=W},get coneInnerAngle(){return E.coneInnerAngle},set coneInnerAngle(W){E.coneInnerAngle=W},get coneOuterAngle(){return E.coneOuterAngle},set coneOuterAngle(W){E.coneOuterAngle=W},get coneOuterGain(){return E.coneOuterGain},set coneOuterGain(W){if(W<0||W>1)throw o();E.coneOuterGain=W},get context(){return E.context},get distanceModel(){return E.distanceModel},set distanceModel(W){E.distanceModel=W},get inputs(){return[k]},get maxDistance(){return E.maxDistance},set maxDistance(W){if(W<0)throw new RangeError;E.maxDistance=W},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get orientationX(){return _.gain},get orientationY(){return B.gain},get orientationZ(){return G.gain},get panningModel(){return E.panningModel},set panningModel(W){E.panningModel=W},get positionX(){return V.gain},get positionY(){return H.gain},get positionZ(){return j.gain},get refDistance(){return E.refDistance},set refDistance(W){if(W<0)throw new RangeError;E.refDistance=W},get rolloffFactor(){return E.rolloffFactor},set rolloffFactor(W){if(W<0)throw new RangeError;E.rolloffFactor=W},addEventListener(...W){return k.addEventListener(W[0],W[1],W[2])},dispatchEvent(...W){return k.dispatchEvent(W[0])},removeEventListener(...W){return k.removeEventListener(W[0],W[1],W[2])}};p!==z.coneInnerAngle&&(z.coneInnerAngle=p),m!==z.coneOuterAngle&&(z.coneOuterAngle=m),h!==z.coneOuterGain&&(z.coneOuterGain=h),v!==z.distanceModel&&(z.distanceModel=v),x!==z.maxDistance&&(z.maxDistance=x),f!==z.orientationX.value&&(z.orientationX.value=f),g!==z.orientationY.value&&(z.orientationY.value=g),S!==z.orientationZ.value&&(z.orientationZ.value=S),A!==z.panningModel&&(z.panningModel=A),M!==z.positionX.value&&(z.positionX.value=M),T!==z.positionY.value&&(z.positionY.value=T),w!==z.positionZ.value&&(z.positionZ.value=w),y!==z.refDistance&&(z.refDistance=y),C!==z.rolloffFactor&&(z.rolloffFactor=C),(ue[0]!==1||ue[1]!==0||ue[2]!==0)&&E.setOrientation(...ue),(Se[0]!==0||Se[1]!==0||Se[2]!==0)&&E.setPosition(...Se);let ft=()=>{k.connect(E),t(k,X,0,0),X.connect(_).connect(b,0,0),X.connect(B).connect(b,0,1),X.connect(G).connect(b,0,2),X.connect(V).connect(b,0,3),X.connect(H).connect(b,0,4),X.connect(j).connect(b,0,5),b.connect(Q).connect(d.destination)},Gt=()=>{k.disconnect(E),a(k,X,0,0),X.disconnect(_),_.disconnect(b),X.disconnect(B),B.disconnect(b),X.disconnect(G),G.disconnect(b),X.disconnect(V),V.disconnect(b),X.disconnect(H),H.disconnect(b),X.disconnect(j),j.disconnect(b),b.disconnect(Q),Q.disconnect(d.destination)};return u(Me(z,E),ft,Gt)}});var Au,Eu=i(()=>{Au=t=>(o,{disableNormalization:e,imag:r,real:n})=>{let s=r instanceof Float32Array?r:new Float32Array(r),c=n instanceof Float32Array?n:new Float32Array(n),a=o.createPeriodicWave(c,s,{disableNormalization:e});if(Array.from(r).length<2)throw t();return a}});var Bt,Iu=i(()=>{Bt=(t,o,e,r)=>t.createScriptProcessor(o,e,r)});var bu,Mu=i(()=>{He();he();bu=(t,o)=>(e,r)=>{let n=r.channelCountMode;if(n==="clamped-max")throw o();if(e.createStereoPanner===void 0)return t(e,r);let s=e.createStereoPanner();return q(s,r),K(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>n,set:c=>{if(c!==n)throw o()}}),s}});var Pu,Fu=i(()=>{dt();Pu=(t,o,e,r,n,s)=>{let a=new Float32Array([1,1]),l=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},d=F(N({},u),{oversample:"none"}),p=(v,x,f,g)=>{let S=new Float32Array(16385),A=new Float32Array(16385);for(let P=0;P<16385;P+=1){let R=P/16384*l;S[P]=Math.cos(R),A[P]=Math.sin(R)}let M=e(v,F(N({},u),{gain:0})),T=r(v,F(N({},d),{curve:S})),w=r(v,F(N({},d),{curve:a})),y=e(v,F(N({},u),{gain:0})),C=r(v,F(N({},d),{curve:A}));return{connectGraph(){x.connect(M),x.connect(w.inputs===void 0?w:w.inputs[0]),x.connect(y),w.connect(f),f.connect(T.inputs===void 0?T:T.inputs[0]),f.connect(C.inputs===void 0?C:C.inputs[0]),T.connect(M.gain),C.connect(y.gain),M.connect(g,0,0),y.connect(g,0,1)},disconnectGraph(){x.disconnect(M),x.disconnect(w.inputs===void 0?w:w.inputs[0]),x.disconnect(y),w.disconnect(f),f.disconnect(T.inputs===void 0?T:T.inputs[0]),f.disconnect(C.inputs===void 0?C:C.inputs[0]),T.disconnect(M.gain),C.disconnect(y.gain),M.disconnect(g,0,0),y.disconnect(g,0,1)}}},m=(v,x,f,g)=>{let S=new Float32Array(16385),A=new Float32Array(16385),M=new Float32Array(16385),T=new Float32Array(16385),w=Math.floor(16385/2);for(let B=0;B<16385;B+=1)if(B>w){let G=(B-w)/(16384-w)*l;S[B]=Math.cos(G),A[B]=Math.sin(G),M[B]=0,T[B]=1}else{let G=B/(16384-w)*l;S[B]=1,A[B]=0,M[B]=Math.cos(G),T[B]=Math.sin(G)}let y=o(v,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),C=e(v,F(N({},u),{gain:0})),P=r(v,F(N({},d),{curve:S})),R=e(v,F(N({},u),{gain:0})),I=r(v,F(N({},d),{curve:A})),E=r(v,F(N({},d),{curve:a})),L=e(v,F(N({},u),{gain:0})),b=r(v,F(N({},d),{curve:M})),k=e(v,F(N({},u),{gain:0})),_=r(v,F(N({},d),{curve:T}));return{connectGraph(){x.connect(y),x.connect(E.inputs===void 0?E:E.inputs[0]),y.connect(C,0),y.connect(R,0),y.connect(L,1),y.connect(k,1),E.connect(f),f.connect(P.inputs===void 0?P:P.inputs[0]),f.connect(I.inputs===void 0?I:I.inputs[0]),f.connect(b.inputs===void 0?b:b.inputs[0]),f.connect(_.inputs===void 0?_:_.inputs[0]),P.connect(C.gain),I.connect(R.gain),b.connect(L.gain),_.connect(k.gain),C.connect(g,0,0),L.connect(g,0,0),R.connect(g,0,1),k.connect(g,0,1)},disconnectGraph(){x.disconnect(y),x.disconnect(E.inputs===void 0?E:E.inputs[0]),y.disconnect(C,0),y.disconnect(R,0),y.disconnect(L,1),y.disconnect(k,1),E.disconnect(f),f.disconnect(P.inputs===void 0?P:P.inputs[0]),f.disconnect(I.inputs===void 0?I:I.inputs[0]),f.disconnect(b.inputs===void 0?b:b.inputs[0]),f.disconnect(_.inputs===void 0?_:_.inputs[0]),P.disconnect(C.gain),I.disconnect(R.gain),b.disconnect(L.gain),_.disconnect(k.gain),C.disconnect(g,0,0),L.disconnect(g,0,0),R.disconnect(g,0,1),k.disconnect(g,0,1)}}},h=(v,x,f,g,S)=>{if(x===1)return p(v,f,g,S);if(x===2)return m(v,f,g,S);throw n()};return(v,A)=>{var M=A,{channelCount:x,channelCountMode:f,pan:g}=M,S=Ke(M,["channelCount","channelCountMode","pan"]);if(f==="max")throw n();let T=t(v,F(N({},S),{channelCount:1,channelCountMode:f,numberOfInputs:2})),w=e(v,F(N({},S),{channelCount:x,channelCountMode:f,gain:1})),y=e(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g}),{connectGraph:C,disconnectGraph:P}=h(v,x,w,y,T);Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"maxValue",{get:()=>1}),Object.defineProperty(y.gain,"minValue",{get:()=>-1});let R={get bufferSize(){},get channelCount(){return w.channelCount},set channelCount(b){w.channelCount!==b&&(I&&P(),{connectGraph:C,disconnectGraph:P}=h(v,b,w,y,T),I&&C()),w.channelCount=b},get channelCountMode(){return w.channelCountMode},set channelCountMode(b){if(b==="clamped-max"||b==="max")throw n();w.channelCountMode=b},get channelInterpretation(){return w.channelInterpretation},set channelInterpretation(b){w.channelInterpretation=b},get context(){return w.context},get inputs(){return[w]},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get pan(){return y.gain},addEventListener(...b){return w.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return w.dispatchEvent(b[0])},removeEventListener(...b){return w.removeEventListener(b[0],b[1],b[2])}},I=!1,E=()=>{C(),I=!0},L=()=>{P(),I=!1};return s(Me(R,T),E,L)}}});var Ou,_u=i(()=>{Ye();he();Ou=(t,o,e,r,n,s,c)=>(a,l)=>{let u=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return e(a,l);q(u,l);let d=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(d!==null&&d.length<2)throw o();Z(u,{curve:d},"curve"),Z(u,l,"oversample");let p=null,m=!1;return c(u,"curve",x=>()=>x.call(u),x=>f=>(x.call(u,f),m&&(r(f)&&p===null?p=t(a,u):!r(f)&&p!==null&&(p(),p=null)),f)),n(u,()=>{m=!0,r(u.curve)&&(p=t(a,u))},()=>{m=!1,p!==null&&(p(),p=null)})}});var ku,Du=i(()=>{he();dt();ku=(t,o,e,r,n)=>(s,u)=>{var d=u,{curve:c,oversample:a}=d,l=Ke(d,["curve","oversample"]);let p=s.createWaveShaper(),m=s.createWaveShaper();q(p,l),q(m,l);let h=e(s,F(N({},l),{gain:1})),v=e(s,F(N({},l),{gain:-1})),x=e(s,F(N({},l),{gain:1})),f=e(s,F(N({},l),{gain:-1})),g=null,S=!1,A=null,M={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(y){h.channelCount=y,v.channelCount=y,p.channelCount=y,x.channelCount=y,m.channelCount=y,f.channelCount=y},get channelCountMode(){return p.channelCountMode},set channelCountMode(y){h.channelCountMode=y,v.channelCountMode=y,p.channelCountMode=y,x.channelCountMode=y,m.channelCountMode=y,f.channelCountMode=y},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(y){h.channelInterpretation=y,v.channelInterpretation=y,p.channelInterpretation=y,x.channelInterpretation=y,m.channelInterpretation=y,f.channelInterpretation=y},get context(){return p.context},get curve(){return A},set curve(y){if(y!==null&&y.length<2)throw o();if(y===null)p.curve=y,m.curve=y;else{let C=y.length,P=new Float32Array(C+2-C%2),R=new Float32Array(C+2-C%2);P[0]=y[0],R[0]=-y[C-1];let I=Math.ceil((C+1)/2),E=(C+1)/2-1;for(let L=1;L<I;L+=1){let b=L/I*E,k=Math.floor(b),_=Math.ceil(b);P[L]=k===_?y[k]:(1-(b-k))*y[k]+(1-(_-b))*y[_],R[L]=k===_?-y[C-1-k]:-((1-(b-k))*y[C-1-k])-(1-(_-b))*y[C-1-_]}P[I]=C%2===1?y[I-1]:(y[I-2]+y[I-1])/2,p.curve=P,m.curve=R}A=y,S&&(r(A)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get oversample(){return p.oversample},set oversample(y){p.oversample=y,m.oversample=y},addEventListener(...y){return h.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return h.dispatchEvent(y[0])},removeEventListener(...y){return h.removeEventListener(y[0],y[1],y[2])}};c!==null&&(M.curve=c instanceof Float32Array?c:new Float32Array(c)),a!==M.oversample&&(M.oversample=a);let T=()=>{h.connect(p).connect(x),h.connect(v).connect(m).connect(f).connect(x),S=!0,r(A)&&(g=t(s,h))},w=()=>{h.disconnect(p),p.disconnect(x),h.disconnect(v),v.disconnect(m),m.disconnect(f),f.disconnect(x),S=!1,g!==null&&(g(),g=null)};return n(Me(M,x),T,w)}});var ge,Ru=i(()=>{ge=()=>new DOMException("","NotSupportedError")});var IS,Lu,Bu=i(()=>{sr();lr();IS={numberOfChannels:1},Lu=(t,o,e,r,n)=>class extends t{constructor(c,a,l){let u;if(typeof c=="number"&&a!==void 0&&l!==void 0)u={length:a,numberOfChannels:c,sampleRate:l};else if(typeof c=="object")u=c;else throw new Error("The given parameters are not valid.");let{length:d,numberOfChannels:p,sampleRate:m}=N(N({},IS),u),h=r(p,d,m);o(_e,()=>_e(h))||h.addEventListener("statechange",(()=>{let v=0,x=f=>{this._state==="running"&&(v>0?(h.removeEventListener("statechange",x),f.stopImmediatePropagation(),this._waitForThePromiseToSettle(f)):v+=1)};return x})()),super(h,p),this._length=d,this._nativeOfflineAudioContext=h,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,tt(this)}))}_waitForThePromiseToSettle(c){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(c):setTimeout(()=>this._waitForThePromiseToSettle(c))}}});var bS,Vu,Wu=i(()=>{st();Tt();At();bS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Vu=(t,o,e,r,n,s,c)=>class extends t{constructor(l,u){let d=n(l),p=N(N({},bS),u),m=e(d,p),h=s(d),v=h?r():null,x=l.sampleRate/2;super(l,!1,m,v),this._detune=o(this,h,m.detune,153600,-153600),this._frequency=o(this,h,m.frequency,x,-x),this._nativeOscillatorNode=m,this._onended=null,this._oscillatorNodeRenderer=v,this._oscillatorNodeRenderer!==null&&p.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=p.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){let u=typeof l=="function"?c(this,l):null;this._nativeOscillatorNode.onended=u;let d=this._nativeOscillatorNode.onended;this._onended=d!==null&&d===u?l:d}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Fe(this);let u=()=>{this._nativeOscillatorNode.removeEventListener("ended",u),Ce(this)&&We(this)};this._nativeOscillatorNode.addEventListener("ended",u)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}}});var Hu,Uu=i(()=>{ve();Hu=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=null,a=null,l=null,u=(d,p)=>O(void 0,null,function*(){let m=e(d),h=Y(m,p);if(!h){let v={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,detune:m.detune.value,frequency:m.frequency.value,periodicWave:c===null?void 0:c,type:m.type};m=o(p,v),a!==null&&m.start(a),l!==null&&m.stop(l)}return s.set(p,m),h?(yield t(p,d.detune,m.detune),yield t(p,d.frequency,m.frequency)):(yield r(p,d.detune,m.detune),yield r(p,d.frequency,m.frequency)),yield n(d,p,m),m});return{set periodicWave(d){c=d},set start(d){a=d},set stop(d){l=d},render(d,p){let m=s.get(p);return m!==void 0?Promise.resolve(m):u(d,p)}}}});var MS,zu,Gu=i(()=>{Je();MS={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},zu=(t,o,e,r,n,s,c)=>class extends t{constructor(l,u){let d=n(l),p=N(N({},MS),u),m=e(d,p),h=s(d),v=h?r():null;super(l,!1,m,v),this._nativePannerNode=m,this._orientationX=o(this,h,m.orientationX,ae,ce),this._orientationY=o(this,h,m.orientationY,ae,ce),this._orientationZ=o(this,h,m.orientationZ,ae,ce),this._positionX=o(this,h,m.positionX,ae,ce),this._positionY=o(this,h,m.positionY,ae,ce),this._positionZ=o(this,h,m.positionZ,ae,ce),c(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}}});var ju,qu=i(()=>{ct();ve();ju=(t,o,e,r,n,s,c,a,l,u)=>()=>{let d=new WeakMap,p=null,m=(h,v)=>O(void 0,null,function*(){let x=null,f=s(h),g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation},S=F(N({},g),{coneInnerAngle:f.coneInnerAngle,coneOuterAngle:f.coneOuterAngle,coneOuterGain:f.coneOuterGain,distanceModel:f.distanceModel,maxDistance:f.maxDistance,panningModel:f.panningModel,refDistance:f.refDistance,rolloffFactor:f.rolloffFactor}),A=Y(f,v);if("bufferSize"in f)x=r(v,F(N({},g),{gain:1}));else if(!A){let M=F(N({},S),{orientationX:f.orientationX.value,orientationY:f.orientationY.value,orientationZ:f.orientationZ.value,positionX:f.positionX.value,positionY:f.positionY.value,positionZ:f.positionZ.value});f=n(v,M)}if(d.set(v,x===null?f:x),x!==null){if(p===null){if(c===null)throw new Error("Missing the native OfflineAudioContext constructor.");let I=new c(6,h.context.length,v.sampleRate),E=o(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});E.connect(I.destination),p=(()=>O(void 0,null,function*(){let L=yield Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map((b,k)=>O(void 0,null,function*(){let _=e(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:k===0?1:0});return yield a(I,b,_.offset),_})));for(let b=0;b<6;b+=1)L[b].connect(E,0,b),L[b].start(0);return u(I)}))()}let M=yield p,T=r(v,F(N({},g),{gain:1}));yield l(h,v,T);let w=[];for(let I=0;I<M.numberOfChannels;I+=1)w.push(M.getChannelData(I));let y=[w[0][0],w[1][0],w[2][0]],C=[w[3][0],w[4][0],w[5][0]],P=r(v,F(N({},g),{gain:1})),R=n(v,F(N({},S),{orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:C[0],positionY:C[1],positionZ:C[2]}));T.connect(P).connect(R.inputs[0]),R.connect(x);for(let I=128;I<M.length;I+=128){let E=[w[0][I],w[1][I],w[2][I]],L=[w[3][I],w[4][I],w[5][I]];if(E.some((b,k)=>b!==y[k])||L.some((b,k)=>b!==C[k])){y=E,C=L;let b=I/v.sampleRate;P.gain.setValueAtTime(0,b),P=r(v,F(N({},g),{gain:0})),R=n(v,F(N({},S),{orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:C[0],positionY:C[1],positionZ:C[2]})),P.gain.setValueAtTime(1,b),T.connect(P).connect(R.inputs[0]),R.connect(x)}}return x}return A?(yield t(v,h.orientationX,f.orientationX),yield t(v,h.orientationY,f.orientationY),yield t(v,h.orientationZ,f.orientationZ),yield t(v,h.positionX,f.positionX),yield t(v,h.positionY,f.positionY),yield t(v,h.positionZ,f.positionZ)):(yield a(v,h.orientationX,f.orientationX),yield a(v,h.orientationY,f.orientationY),yield a(v,h.orientationZ,f.orientationZ),yield a(v,h.positionX,f.positionX),yield a(v,h.positionY,f.positionY),yield a(v,h.positionZ,f.positionZ)),be(f)?yield l(h,v,f.inputs[0]):yield l(h,v,f),f});return{render(h,v){let x=d.get(v);return x!==void 0?Promise.resolve(x):m(h,v)}}}});var PS,Xu,Zu=i(()=>{PS={disableNormalization:!1},Xu=(t,o,e,r)=>class Yu{constructor(s,c){let a=o(s),l=r(N(N({},PS),c)),u=t(a,l);return e.add(u),u}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Yu.prototype||e.has(s)}}});var $u,Ku=i(()=>{$u=(t,o)=>(e,r,n)=>(t(r).replay(n),o(r,e,n))});var Qu,Ju=i(()=>{Qu=(t,o,e)=>(r,n,s)=>O(void 0,null,function*(){let c=t(r);yield Promise.all(c.activeInputs.map((a,l)=>Array.from(a).map(p=>O(void 0,[p],function*([u,d]){let h=yield o(u).render(u,n),v=r.context.destination;!e(u)&&(r!==v||!e(r))&&h.connect(s,d,l)}))).reduce((a,l)=>[...a,...l],[]))})});var ed,td=i(()=>{ed=(t,o,e)=>(r,n,s)=>O(void 0,null,function*(){let c=o(r);yield Promise.all(Array.from(c.activeInputs).map(u=>O(void 0,[u],function*([a,l]){let p=yield t(a).render(a,n);e(a)||p.connect(s,l)})))})});var rd,od=i(()=>{lr();rd=(t,o,e,r)=>n=>t(_e,()=>_e(n))?Promise.resolve(t(r,r)).then(s=>{if(!s){let c=e(n,512,0,1);n.oncomplete=()=>{c.onaudioprocess=null,c.disconnect()},c.onaudioprocess=()=>n.currentTime,c.connect(n.destination)}return n.startRendering()}):new Promise(s=>{let c=o(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.oncomplete=a=>{c.disconnect(),s(a.renderedBuffer)},c.connect(n.destination),n.startRendering()})});var nd,id=i(()=>{nd=t=>(o,e)=>{t.set(o,e)}});var sd,ad=i(()=>{sd=t=>(o,e)=>t.set(o,e)});var cd,ld=i(()=>{Br();cd=(t,o,e,r,n,s,c,a)=>(l,u)=>e(l).render(l,u).then(()=>Promise.all(Array.from(r(u)).map(d=>e(d).render(d,u)))).then(()=>n(u)).then(d=>(typeof d.copyFromChannel!="function"?(c(d),It(d)):o(s,()=>s(d))||a(d),t.add(d),d))});var FS,ud,dd=i(()=>{FS={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},ud=(t,o,e,r,n,s)=>class extends t{constructor(a,l){let u=n(a),d=N(N({},FS),l),p=e(u,d),m=s(u),h=m?r():null;super(a,!1,p,h),this._pan=o(this,m,p.pan)}get pan(){return this._pan}}});var pd,md=i(()=>{ct();ve();pd=(t,o,e,r,n)=>()=>{let s=new WeakMap,c=(a,l)=>O(void 0,null,function*(){let u=e(a),d=Y(u,l);if(!d){let p={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=o(l,p)}return s.set(l,u),d?yield t(l,a.pan,u.pan):yield r(l,a.pan,u.pan),be(u)?yield n(a,l,u.inputs[0]):yield n(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var hd,fd=i(()=>{hd=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch(o){return!1}return!0}});var xd,vd=i(()=>{xd=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createBuffer(1,1,44100);if(e.copyToChannel===void 0)return!0;let r=new Float32Array(2);try{e.copyFromChannel(r,0,0)}catch(n){return!1}return!0}});var gd,yd=i(()=>{gd=t=>()=>{if(t===null)return!1;if(t.prototype!==void 0&&t.prototype.close!==void 0)return!0;let o=new t,e=o.close!==void 0;try{o.close()}catch(r){}return e}});var Cd,wd=i(()=>{Cd=t=>()=>{if(t===null)return Promise.resolve(!1);let o=new t(1,1,44100);return new Promise(e=>{let r=!0,n=c=>{r&&(r=!1,o.startRendering(),e(c instanceof TypeError))},s;try{s=o.decodeAudioData(null,()=>{},n)}catch(c){n(c)}s!==void 0&&s.catch(n)})}});var Nd,Sd=i(()=>{Nd=t=>()=>{if(t===null)return!1;let o;try{o=new t({latencyHint:"balanced"})}catch(e){return!1}return o.close(),!0}});var Td,Ad=i(()=>{Td=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createGain(),r=e.connect(e)===e;return e.disconnect(e),r}});var Ed,Id=i(()=>{Ed=(t,o)=>()=>O(void 0,null,function*(){if(t===null)return!0;if(o===null)return!1;let e=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new MessageChannel,n=new o(1,128,44100),s=URL.createObjectURL(e),c=!1;try{yield n.audioWorklet.addModule(s);let a=new t(n,"a",{numberOfOutputs:0}),l=n.createOscillator();yield new Promise(u=>{a.port.onmessage=()=>u(),a.port.postMessage(r.port2,[r.port2])}),a.port.onmessage=()=>c=!0,l.connect(a),l.start(0),yield n.startRendering(),c=yield new Promise(u=>{r.port1.onmessage=({data:d})=>u(d===1),r.port1.postMessage(0)})}catch(a){}finally{r.port1.close(),URL.revokeObjectURL(s)}return c})});var bd,Md=i(()=>{bd=(t,o)=>()=>O(void 0,null,function*(){if(t===null)return!0;if(o===null)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new o(1,128,44100),n=URL.createObjectURL(e),s=!1,c=!1;try{yield r.audioWorklet.addModule(n);let a=new t(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>c=!0,l.connect(a),l.start(0),yield r.startRendering(),yield new Promise(u=>setTimeout(u))}catch(a){}finally{URL.revokeObjectURL(n)}return s&&!c})});var Pd,Fd=i(()=>{Pd=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createChannelMerger();if(e.channelCountMode==="max")return!0;try{e.channelCount=2}catch(r){return!0}return!1}});var Od,_d=i(()=>{Od=t=>()=>{if(t===null)return!1;let o=new t(1,1,44100);return o.createConstantSource===void 0?!0:o.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}});var kd,Dd=i(()=>{kd=t=>()=>{if(t===null)return!1;let o=new t(1,1,44100),e=o.createConvolver();e.buffer=o.createBuffer(1,1,o.sampleRate);try{e.buffer=o.createBuffer(1,1,o.sampleRate)}catch(r){return!1}return!0}});var Rd,Ld=i(()=>{Rd=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch(r){return!1}return!0}});var Bd,Vd=i(()=>{Bd=t=>()=>t!==null&&t.hasOwnProperty("isSecureContext")});var Wd,Hd=i(()=>{Wd=t=>()=>{if(t===null)return!1;let o=new t;try{return o.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}finally{o.close()}}});var Ud,zd=i(()=>{Ud=(t,o)=>()=>{if(o===null)return Promise.resolve(!1);let e=new o(1,1,44100),r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(n=>{e.oncomplete=()=>{r.disconnect(),n(e.currentTime!==0)},e.startRendering()})}});var Gd,jd=i(()=>{Gd=t=>()=>{if(t===null)return Promise.resolve(!1);let o=new t(1,1,44100);if(o.createStereoPanner===void 0||o.createConstantSource===void 0)return Promise.resolve(!0);let e=o.createConstantSource(),r=o.createStereoPanner();return e.channelCount=1,e.offset.value=1,r.channelCount=1,e.start(),e.connect(r).connect(o.destination),o.startRendering().then(n=>n.getChannelData(0)[0]!==1)}});var on,qd=i(()=>{on=()=>new DOMException("","UnknownError")});var OS,Xd,Yd=i(()=>{OS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Xd=(t,o,e,r,n,s,c)=>class extends t{constructor(l,u){let d=n(l),p=N(N({},OS),u),m=e(d,p),v=s(d)?r():null;super(l,!0,m,v),this._isCurveNullified=!1,this._nativeWaveShaperNode=m,c(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw o();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}}});var Zd,$d=i(()=>{ct();ve();Zd=(t,o,e)=>()=>{let r=new WeakMap,n=(s,c)=>O(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(c,u)}return r.set(c,a),be(a)?yield e(s,c,a.inputs[0]):yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):n(s,c)}}}});var Kd,Qd=i(()=>{Kd=()=>typeof window=="undefined"?null:window});var Jd,ep=i(()=>{Jd=(t,o)=>e=>{e.copyFromChannel=(r,n,s=0)=>{let c=t(s),a=t(n);if(a>=e.numberOfChannels)throw o();let l=e.length,u=e.getChannelData(a),d=r.length;for(let p=c<0?-c:0;p+c<l&&p<d;p+=1)r[p]=u[p+c]},e.copyToChannel=(r,n,s=0)=>{let c=t(s),a=t(n);if(a>=e.numberOfChannels)throw o();let l=e.length,u=e.getChannelData(a),d=r.length;for(let p=c<0?-c:0;p+c<l&&p<d;p+=1)u[p+c]=r[p]}}});var tp,rp=i(()=>{tp=t=>o=>{o.copyFromChannel=(e=>(r,n,s=0)=>{let c=t(s),a=t(n);if(c<o.length)return e.call(o,r,a,c)})(o.copyFromChannel),o.copyToChannel=(e=>(r,n,s=0)=>{let c=t(s),a=t(n);if(c<o.length)return e.call(o,r,a,c)})(o.copyToChannel)}});var op,np=i(()=>{op=t=>(o,e)=>{let r=e.createBuffer(1,1,44100);o.buffer===null&&(o.buffer=r),t(o,"buffer",n=>()=>{let s=n.call(o);return s===r?null:s},n=>s=>n.call(o,s===null?r:s))}});var ip,sp=i(()=>{ip=(t,o)=>(e,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});let n=e.createBufferSource();o(r,()=>{let a=r.numberOfInputs;for(let l=0;l<a;l+=1)n.connect(r,0,l)},()=>n.disconnect(r))}});var nn,ap=i(()=>{nn=(t,o,e)=>t.copyFromChannel===void 0?t.getChannelData(e)[0]:(t.copyFromChannel(o,e),o[0])});var sn,cp=i(()=>{sn=t=>{if(t===null)return!1;let o=t.length;return o%2!==0?t[Math.floor(o/2)]!==0:t[o/2-1]+t[o/2]!==0}});var Vt,lp=i(()=>{Vt=(t,o,e,r)=>{let n=t;for(;!n.hasOwnProperty(o);)n=Object.getPrototypeOf(n);let{get:s,set:c}=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(t,o,{get:e(s),set:r(c)})}});var up,dp=i(()=>{up=t=>F(N({},t),{outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)})});var pp,mp=i(()=>{pp=t=>F(N({},t),{channelCount:t.numberOfOutputs})});var hp,fp=i(()=>{hp=t=>{let{imag:o,real:e}=t;return o===void 0?e===void 0?F(N({},t),{imag:[0,0],real:[0,0]}):F(N({},t),{imag:Array.from(e,()=>0),real:e}):e===void 0?F(N({},t),{imag:o,real:Array.from(o,()=>0)}):F(N({},t),{imag:o,real:e})}});var an,xp=i(()=>{an=(t,o,e)=>{try{t.setValueAtTime(o,e)}catch(r){if(r.code!==9)throw r;an(t,o,e+1e-7)}}});var vp,gp=i(()=>{vp=t=>{let o=t.createBufferSource();o.start();try{o.start()}catch(e){return!0}return!1}});var yp,Cp=i(()=>{yp=t=>{let o=t.createBufferSource(),e=t.createBuffer(1,1,44100);o.buffer=e;try{o.start(0,1)}catch(r){return!1}return!0}});var wp,Np=i(()=>{wp=t=>{let o=t.createBufferSource();o.start();try{o.stop()}catch(e){return!1}return!0}});var Jr,Sp=i(()=>{Jr=t=>{let o=t.createOscillator();try{o.start(-1)}catch(e){return e instanceof RangeError}return!1}});var cn,Tp=i(()=>{cn=t=>{let o=t.createBuffer(1,1,44100),e=t.createBufferSource();e.buffer=o,e.start(),e.stop();try{return e.stop(),!0}catch(r){return!1}}});var eo,Ap=i(()=>{eo=t=>{let o=t.createOscillator();try{o.stop(-1)}catch(e){return e instanceof RangeError}return!1}});var Ep,Ip=i(()=>{Ep=t=>{let{port1:o,port2:e}=new MessageChannel;try{o.postMessage(t)}finally{o.close(),e.close()}}});var bp,Mp=i(()=>{bp=()=>{try{new DOMException}catch(t){return!1}return!0}});var Pp,Fp=i(()=>{Pp=()=>new Promise(t=>{let o=new ArrayBuffer(0),{port1:e,port2:r}=new MessageChannel;e.onmessage=({data:n})=>t(n!==null),r.postMessage(o,[o])})});var Op,_p=i(()=>{Op=t=>{t.start=(o=>(e=0,r=0,n)=>{let s=t.buffer,c=s===null?r:Math.min(s.duration,r);s!==null&&c>s.duration-.5/t.context.sampleRate?o.call(t,e,0,0):o.call(t,e,c,n)})(t.start)}});var ln,kp=i(()=>{dt();ln=(t,o)=>{let e=o.createGain();t.connect(e);let r=(n=>()=>{n.call(t,e),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Me(t,e),t.stop=(n=>{let s=!1;return(c=0)=>{if(s)try{n.call(t,c)}catch(a){e.gain.setValueAtTime(0,c)}else n.call(t,c),s=!0}})(t.stop)}});var pt,Dp=i(()=>{pt=(t,o)=>e=>{let r={value:t};return Object.defineProperties(e,{currentTarget:r,target:r}),typeof o=="function"?o.call(t,e):o.handleEvent.call(t,e)}});var Rp=i(()=>{});var Lp=i(()=>{});var Bp=i(()=>{});var Vp=i(()=>{});var Wp=i(()=>{});var Hp=i(()=>{});var Up=i(()=>{});var zp=i(()=>{});var Gp=i(()=>{});var jp=i(()=>{});var qp=i(()=>{});var Xp=i(()=>{});var Yp=i(()=>{});var Zp=i(()=>{});var $p=i(()=>{});var Kp=i(()=>{});var Qp=i(()=>{});var Jp=i(()=>{});var em=i(()=>{});var tm=i(()=>{});var rm=i(()=>{});var om=i(()=>{});var nm=i(()=>{});var im=i(()=>{});var sm=i(()=>{});var am=i(()=>{});var cm=i(()=>{});var lm=i(()=>{});var um=i(()=>{});var dm=i(()=>{});var pm=i(()=>{});var mm=i(()=>{});var hm=i(()=>{});var fm=i(()=>{});var xm=i(()=>{});var vm=i(()=>{});var gm=i(()=>{});var ym=i(()=>{});var Cm=i(()=>{});var wm=i(()=>{});var Nm=i(()=>{});var Sm=i(()=>{});var Tm=i(()=>{});var Am=i(()=>{});var Em=i(()=>{});var Im=i(()=>{});var bm=i(()=>{});var Mm=i(()=>{});var Pm=i(()=>{});var Fm=i(()=>{});var Om=i(()=>{});var _m=i(()=>{});var km=i(()=>{});var Dm=i(()=>{});var Rm=i(()=>{});var Lm=i(()=>{});var Bm=i(()=>{});var Vm=i(()=>{});var Wm=i(()=>{});var Hm=i(()=>{});var Um=i(()=>{});var zm=i(()=>{});var Gm=i(()=>{});var jm=i(()=>{});var qm=i(()=>{});var Xm=i(()=>{});var Ym=i(()=>{});var Zm=i(()=>{});var $m=i(()=>{});var Km=i(()=>{});var Qm=i(()=>{});var Jm=i(()=>{});var eh=i(()=>{});var th=i(()=>{});var rh=i(()=>{});var oh=i(()=>{});var nh=i(()=>{});var ih=i(()=>{});var sh=i(()=>{});var ah=i(()=>{});var ch=i(()=>{});var lh=i(()=>{});var uh=i(()=>{});var dh=i(()=>{});var ph=i(()=>{Rp();Lp();Bp();Vp();Wp();Hp();Up();zp();Gp();jp();qp();Xp();Yp();Zp();$p();Kp();Qp();Jp();em();tm();rm();om();nm();im();sm();am();cm();lm();um();dm();pm();mm();hm();fm();xm();vm();gm();ym();Cm();wm();Nm();Sm();Tm();Am();Em();Im();bm();Mm();Pm();Fm();Om();_m();km();Dm();Rm();Lm();Bm();Vm();Wm();Hm();Um();zm();Gm();jm();qm();Xm();Ym();Zm();$m();Km();Qm();Jm();eh();th();rh();oh();nh();ih();sh();ah();ch();lh();uh();dh()});var mh=i(()=>{});var hh=i(()=>{});var fh=i(()=>{});var xh=i(()=>{});var vh=i(()=>{});var gh=i(()=>{});var yh=i(()=>{});var Ch=i(()=>{});var wh=i(()=>{});var Nh=i(()=>{});var Sh=i(()=>{});var Th=i(()=>{});var Ah=i(()=>{});var Eh=i(()=>{});var Ih=i(()=>{});var bh=i(()=>{});var Mh=i(()=>{});var Ph=i(()=>{});var Fh=i(()=>{});var Oh=i(()=>{});var _h=i(()=>{});var kh=i(()=>{});var Dh=i(()=>{});var Rh=i(()=>{});var Lh=i(()=>{});var Bh=i(()=>{});var Vh=i(()=>{});var Wh=i(()=>{});var Hh=i(()=>{});var Uh=i(()=>{});var zh=i(()=>{});var Gh=i(()=>{});var jh=i(()=>{});var qh=i(()=>{});var Xh=i(()=>{});var Yh=i(()=>{});var Zh=i(()=>{});var $h=i(()=>{});var Kh=i(()=>{});var Qh=i(()=>{});var Jh=i(()=>{});var ef=i(()=>{});var tf=i(()=>{});var rf=i(()=>{});var of=i(()=>{});var nf=i(()=>{});var sf=i(()=>{});var af=i(()=>{});var cf=i(()=>{});var lf=i(()=>{});var uf=i(()=>{});var df=i(()=>{});var pf=i(()=>{});var mf=i(()=>{});var hf=i(()=>{});var ff=i(()=>{});var xf=i(()=>{});var vf=i(()=>{});var gf=i(()=>{});var yf=i(()=>{});var Cf=i(()=>{});var wf=i(()=>{});var Nf=i(()=>{});var Sf=i(()=>{});var Tf=i(()=>{});var Af=i(()=>{});var Ef=i(()=>{});var If=i(()=>{});var bf=i(()=>{});var Mf=i(()=>{});var Pf=i(()=>{});var Ff=i(()=>{});var Of=i(()=>{});var _f=i(()=>{});var kf=i(()=>{});var Df=i(()=>{});var Rf=i(()=>{});var Lf=i(()=>{});var Bf=i(()=>{});var Vf=i(()=>{});var Wf=i(()=>{});var Hf=i(()=>{});var Uf=i(()=>{});var zf=i(()=>{});var Gf=i(()=>{});var jf=i(()=>{});var qf=i(()=>{});var Xf=i(()=>{});var Yf=i(()=>{});var Zf=i(()=>{});var $f=i(()=>{});var Kf=i(()=>{});var Qf=i(()=>{});var Jf=i(()=>{});var ex=i(()=>{});var tx=i(()=>{});var rx=i(()=>{});var ox=i(()=>{});var nx=i(()=>{});var ix=i(()=>{});var sx=i(()=>{});var ax=i(()=>{});var cx=i(()=>{});var lx=i(()=>{});var ux=i(()=>{});var dx=i(()=>{});var px=i(()=>{});var mx=i(()=>{});var hx=i(()=>{});var fx=i(()=>{});var xx=i(()=>{});var vx=i(()=>{});var gx=i(()=>{});var yx=i(()=>{});var Cx=i(()=>{});var wx=i(()=>{});var Nx=i(()=>{});var Sx=i(()=>{});var Tx=i(()=>{});var Ax=i(()=>{});var Ex=i(()=>{});var Ix=i(()=>{});var bx=i(()=>{});var Mx=i(()=>{});var Px=i(()=>{});var Fx=i(()=>{});var Ox=i(()=>{});var _x=i(()=>{});var kx=i(()=>{});var Dx=i(()=>{});var Rx=i(()=>{});var Lx=i(()=>{});var Bx=i(()=>{});var Vx=i(()=>{});var Wx=i(()=>{});var Hx=i(()=>{});var Ux=i(()=>{});var zx=i(()=>{});var Gx=i(()=>{});var jx=i(()=>{});var qx=i(()=>{});var Xx=i(()=>{});var Yx=i(()=>{});var Zx=i(()=>{});var $x=i(()=>{});var Kx=i(()=>{});var Qx=i(()=>{});var Jx=i(()=>{});var ev=i(()=>{});var tv=i(()=>{});var rv=i(()=>{});var ov=i(()=>{});var nv=i(()=>{});var iv=i(()=>{});var sv=i(()=>{});var av=i(()=>{});var cv=i(()=>{});var lv=i(()=>{});var uv=i(()=>{});var dv=i(()=>{});var pv=i(()=>{});var mv=i(()=>{});var hv=i(()=>{});var fv=i(()=>{});var xv=i(()=>{});var vv=i(()=>{});var gv=i(()=>{});var yv=i(()=>{});var Cv=i(()=>{});var wv=i(()=>{});var Nv=i(()=>{});var Sv=i(()=>{});var Tv=i(()=>{});var Av=i(()=>{});var Ev=i(()=>{});var Iv=i(()=>{});var bv=i(()=>{});var Mv=i(()=>{});var Pv=i(()=>{});var Fv=i(()=>{});var Ov=i(()=>{});var _v=i(()=>{});var kv=i(()=>{});var Dv=i(()=>{});var Rv=i(()=>{});var Lv=i(()=>{});var Bv=i(()=>{});var Vv=i(()=>{});var Wv=i(()=>{});var Hv=i(()=>{});var Uv=i(()=>{});var zv=i(()=>{});var Gv=i(()=>{});var jv=i(()=>{});var qv=i(()=>{});var Xv=i(()=>{});var Yv=i(()=>{});var Zv=i(()=>{});var $v=i(()=>{});var Kv=i(()=>{});var Qv=i(()=>{});var Jv=i(()=>{});var eg=i(()=>{});var tg=i(()=>{});var rg=i(()=>{});var og=i(()=>{});var ng=i(()=>{});var ig=i(()=>{});var sg=i(()=>{});var ag=i(()=>{});var cg=i(()=>{});var lg=i(()=>{});var ug=i(()=>{});var dg=i(()=>{});var pg=i(()=>{});var mg=i(()=>{});var hg=i(()=>{});var fg=i(()=>{});var xg=i(()=>{});var vg=i(()=>{});var gg=i(()=>{});var yg=i(()=>{});var Cg=i(()=>{});var wg=i(()=>{});var Ng=i(()=>{});var Sg=i(()=>{});var Tg=i(()=>{});var Ag=i(()=>{});var Eg=i(()=>{});var Ig=i(()=>{});var bg=i(()=>{});var Mg=i(()=>{});var Pg=i(()=>{});var Fg=i(()=>{});var Og=i(()=>{});var _g=i(()=>{});var kg=i(()=>{});var Dg=i(()=>{});var Rg=i(()=>{});var Lg=i(()=>{});var Bg=i(()=>{});var Vg=i(()=>{});var Wg=i(()=>{});var Hg=i(()=>{});var Ug=i(()=>{});var zg=i(()=>{});var Gg=i(()=>{});var jg=i(()=>{});var qg=i(()=>{});var Xg=i(()=>{});var Yg=i(()=>{});var Zg=i(()=>{});var $g=i(()=>{});var Kg=i(()=>{});var Qg=i(()=>{});var Jg=i(()=>{});var ey=i(()=>{});var ty=i(()=>{});var ry=i(()=>{});var oy=i(()=>{});var ny=i(()=>{});var iy=i(()=>{});var sy=i(()=>{});var ay=i(()=>{});var cy=i(()=>{});var ly=i(()=>{});var uy=i(()=>{});var dy=i(()=>{});var py=i(()=>{});var my=i(()=>{});var hy=i(()=>{});var fy=i(()=>{});var xy=i(()=>{});var vy=i(()=>{});var gy=i(()=>{});var yy=i(()=>{});var Cy=i(()=>{});var wy=i(()=>{});var Ny=i(()=>{});var Sy=i(()=>{});var Ty=i(()=>{});var Ay=i(()=>{});var Ey=i(()=>{});var Iy=i(()=>{});var by=i(()=>{});var My=i(()=>{});var Py=i(()=>{});var Fy=i(()=>{});var Oy=i(()=>{});var _y=i(()=>{});var ky=i(()=>{});var Dy=i(()=>{});var Ry=i(()=>{});var Ly=i(()=>{});var By=i(()=>{});var Vy=i(()=>{});var Wy=i(()=>{});var Hy=i(()=>{});var Uy=i(()=>{});var zy=i(()=>{});var Gy=i(()=>{});var jy=i(()=>{});var qy=i(()=>{});var Xy=i(()=>{});var Yy=i(()=>{});var Zy=i(()=>{});var $y=i(()=>{});var Ky=i(()=>{});var Qy=i(()=>{});var Jy=i(()=>{});var eC=i(()=>{});var tC=i(()=>{});var rC=i(()=>{});var oC=i(()=>{});var nC=i(()=>{});var iC=i(()=>{});var sC=i(()=>{});var aC=i(()=>{});var cC=i(()=>{});var lC=i(()=>{});var uC=i(()=>{});var dC=i(()=>{});var pC=i(()=>{});var mC=i(()=>{});var hC=i(()=>{});var fC=i(()=>{});var xC=i(()=>{});var vC=i(()=>{});var gC=i(()=>{});var yC=i(()=>{});var CC=i(()=>{});var wC=i(()=>{});var NC=i(()=>{});var SC=i(()=>{});var TC=i(()=>{});var AC=i(()=>{});var EC=i(()=>{});var IC=i(()=>{});var bC=i(()=>{});var MC=i(()=>{});var PC=i(()=>{});var FC=i(()=>{});var OC=i(()=>{});var _C=i(()=>{});var kC=i(()=>{});var DC=i(()=>{});var RC=i(()=>{});var LC=i(()=>{});var BC=i(()=>{});var VC=i(()=>{});var WC=i(()=>{});var HC=i(()=>{});var UC=i(()=>{});var zC=i(()=>{});var GC=i(()=>{});var jC=i(()=>{});var qC=i(()=>{});var XC=i(()=>{});var YC=i(()=>{});var ZC=i(()=>{});var $C=i(()=>{});var KC=i(()=>{});var QC=i(()=>{});var JC=i(()=>{});var ew=i(()=>{});var tw=i(()=>{});var rw=i(()=>{});var ow=i(()=>{});var nw=i(()=>{});var iw=i(()=>{});var sw=i(()=>{});var aw=i(()=>{});var cw=i(()=>{});var lw=i(()=>{});var uw=i(()=>{});var dw=i(()=>{});var pw=i(()=>{});var mw=i(()=>{});var hw=i(()=>{});var fw=i(()=>{});var xw=i(()=>{});var vw=i(()=>{});var gw=i(()=>{});var yw=i(()=>{});var Cw=i(()=>{});var ww=i(()=>{});var Nw=i(()=>{});var Sw=i(()=>{});var Tw=i(()=>{});var Aw=i(()=>{});var Ew=i(()=>{});var Iw=i(()=>{});var bw=i(()=>{});var Mw=i(()=>{});var Pw=i(()=>{});var Fw=i(()=>{mh();hh();fh();xh();vh();gh();yh();Ch();wh();Nh();Sh();Th();Ah();Eh();Ih();bh();Mh();Ph();Fh();Oh();_h();kh();Dh();Rh();Lh();Bh();Vh();Wh();Hh();Uh();zh();Gh();jh();qh();Xh();Yh();Zh();$h();Kh();Qh();Jh();ef();tf();rf();of();nf();sf();af();cf();lf();uf();df();pf();mf();hf();ff();xf();vf();gf();yf();Cf();wf();Nf();Sf();Tf();Af();Ef();If();bf();Mf();Pf();Ff();Of();_f();kf();Df();Rf();Lf();Bf();Vf();Wf();Hf();Uf();zf();Gf();jf();qf();Xf();Yf();Zf();$f();Kf();Qf();Jf();ex();tx();rx();ox();nx();ix();sx();ax();cx();lx();ux();dx();px();mx();hx();fx();xx();vx();gx();yx();Cx();wx();Nx();Sx();Tx();Ax();Ex();Ix();bx();Mx();Px();Fx();Ox();_x();kx();Dx();Rx();Lx();Bx();Vx();Wx();Hx();Ux();zx();Gx();jx();qx();Xx();Yx();Zx();$x();Kx();Qx();Jx();ev();tv();rv();ov();nv();iv();sv();av();cv();lv();uv();dv();pv();mv();hv();fv();xv();vv();gv();yv();Cv();wv();Nv();Sv();Tv();Av();Ev();Iv();bv();Mv();Pv();Fv();Ov();_v();kv();Dv();Rv();Lv();Bv();Vv();Wv();Hv();Uv();zv();Gv();jv();qv();Xv();Yv();Zv();$v();Kv();Qv();Jv();eg();tg();rg();og();ng();ig();sg();ag();cg();lg();ug();dg();pg();mg();hg();fg();xg();vg();gg();yg();Cg();wg();Ng();Sg();Tg();Ag();Eg();Ig();bg();Mg();Pg();Fg();Og();_g();kg();Dg();Rg();Lg();Bg();Vg();Wg();Hg();Ug();zg();Gg();jg();qg();Xg();Yg();Zg();$g();Kg();Qg();Jg();ey();ty();ry();oy();ny();iy();sy();ay();cy();ly();uy();dy();py();my();hy();fy();xy();vy();gy();yy();Cy();wy();Ny();Sy();Ty();Ay();Ey();Iy();by();My();Py();Fy();Oy();_y();ky();Dy();Ry();Ly();By();Vy();Wy();Hy();Uy();zy();Gy();jy();qy();Xy();Yy();Zy();$y();Ky();Qy();Jy();eC();tC();rC();oC();nC();iC();sC();aC();cC();lC();uC();dC();pC();mC();hC();fC();xC();vC();gC();yC();CC();wC();NC();SC();TC();AC();EC();IC();bC();MC();PC();FC();OC();_C();kC();DC();RC();LC();BC();VC();WC();HC();UC();zC();GC();jC();qC();XC();YC();ZC();$C();KC();QC();JC();ew();tw();rw();ow();nw();iw();sw();aw();cw();lw();uw();dw();pw();mw();hw();fw();xw();vw();gw();yw();Cw();ww();Nw();Sw();Tw();Aw();Ew();Iw();bw();Mw();Pw()});var TN={};$N(TN,{AnalyserNode:()=>Bw,AudioBuffer:()=>Ww,AudioBufferSourceNode:()=>Uw,AudioContext:()=>d0,AudioWorkletNode:()=>C0,BiquadFilterNode:()=>zw,ChannelMergerNode:()=>Gw,ChannelSplitterNode:()=>jw,ConstantSourceNode:()=>qw,ConvolverNode:()=>Yw,DelayNode:()=>Zw,DynamicsCompressorNode:()=>Kw,GainNode:()=>Qw,IIRFilterNode:()=>Jw,MediaElementAudioSourceNode:()=>fN,MediaStreamAudioDestinationNode:()=>xN,MediaStreamAudioSourceNode:()=>vN,MediaStreamTrackAudioSourceNode:()=>gN,MinimalAudioContext:()=>w0,MinimalOfflineAudioContext:()=>N0,OfflineAudioContext:()=>S0,OscillatorNode:()=>rN,PannerNode:()=>iN,PeriodicWave:()=>sN,StereoPannerNode:()=>cN,WaveShaperNode:()=>lN,addAudioWorkletModule:()=>pN,decodeAudioData:()=>mN,isAnyAudioContext:()=>T0,isAnyAudioNode:()=>A0,isAnyAudioParam:()=>E0,isAnyOfflineAudioContext:()=>I0,isSupported:()=>b0});var _S,kS,DS,_w,RS,Te,ke,kw,un,ye,LS,re,xe,te,Dw,Rw,Ze,dn,pn,Lw,Wt,le,Bw,mn,Ow,Vw,hn,fn,Ww,to,Hw,Ue,Ht,ze,BS,De,Uw,VS,WS,mt,zw,ot,HS,nt,US,Gw,zS,jw,GS,Ut,jS,qw,Xw,qS,Yw,XS,Zw,$w,YS,Kw,ZS,Qw,$S,ro,KS,QS,Jw,JS,eN,xn,tN,e0,rN,oN,t0,oo,r0,nN,o0,iN,n0,sN,i0,aN,s0,cN,a0,lN,uN,vn,dN,c0,pN,l0,mN,hN,fN,xN,vN,u0,gN,d0,gn,p0,yN,m0,CN,wN,h0,f0,x0,v0,g0,y0,C0,w0,NN,SN,N0,S0,T0,A0,E0,I0,b0,AN=i(()=>{Ao();fi();vi();yi();wi();Pi();Oi();ki();Ri();Bi();Wi();Ui();ji();Xi();Zi();us();ps();hs();xs();Ms();Fs();_s();Ds();Vs();Hs();zs();js();Xs();Zs();Ks();Js();ta();oa();ia();aa();la();da();ma();fa();va();ya();wa();Ta();Ea();ba();Pa();Oa();ka();Ba();Wa();Ua();Ga();qa();Ya();$a();Qa();ec();rc();nc();sc();cc();uc();pc();hc();xc();gc();Cc();Tc();Ec();bc();Fo();Ko();cr();Pc();Oc();kc();Rc();Bc();Wc();Uc();Gc();qc();Yc();$c();Qc();el();rl();nl();sl();cl();ul();pl();vl();yl();Sl();Al();Il();Ml();_l();Hl();Ul();Gl();Xl();Zl();Kl();Jl();eu();ru();ou();iu();cu();uu();pu();hu();xu();gu();Cu();Nu();Tu();Eu();Iu();Mu();Fu();_u();Du();Ru();Bu();Wu();Uu();Gu();qu();Zu();Ku();Ju();td();od();id();ad();ld();dd();md();fd();vd();yd();wd();Sd();Ad();Id();Md();Fd();_d();Dd();Ld();Vd();Hd();zd();jd();qd();Yd();$d();Qd();ep();rp();np();sp();fe();Do();Vo();ir();Vr();St();ap();Gr();Wo();Be();ar();st();cp();Ho();Uo();lp();or();dp();mp();fp();xp();Po();gp();Cp();Np();Sp();Tp();Ap();Ip();Mp();lr();Fp();_p();kp();Dp();ph();Fw();_S=xi(Oe),kS=_i(Oe),DS=Fa(Qe),_w=new WeakMap,RS=lc(_w),Te=qs(new Map,new WeakMap),ke=Kd(),kw=xl(Te,Ie),un=ac(me),ye=Qu(me,un,Xe),LS=Hi(kw,ee,ye),re=fc(Nt),xe=vu(ke),te=jc(xe),Dw=new WeakMap,Rw=Za(pt),Ze=Tl(ke),dn=Lc(Ze),pn=Vc(ke),Lw=Hc(ke),Wt=bl(ke),le=bs(gi(_r),Fi(_S,kS,bt,DS,Mt,me,RS,Ve,ee,Oe,Ce,Xe,Pt),Te,Ic(er,Mt,me,ee,lt,Ce),Ie,kt,ge,Aa(bt,er,me,ee,lt,re,Ce,te),La(Dw,me,de),Rw,re,dn,pn,Lw,te,Wt),Bw=Vi(le,LS,Ie,kw,re,te),mn=new WeakSet,Ow=gl(ke),Vw=pa(new Uint32Array(1)),hn=Jd(Vw,Ie),fn=tp(Vw),Ww=zi(mn,Te,ge,Ow,xe,hd(Ow),hn,fn),to=Di(we),Hw=ed(un,et,Xe),Ue=ra(Hw),Ht=Nl(to,Te,vp,yp,wp,Jr,cn,eo,Op,op(Vt),ln),ze=$u(dc(et),Hw),BS=Yi(Ue,Ht,ee,ze,ye),De=Ps(Ci(kr),Dw,Jt,Os,Co,wo,No,So,To,gt,Yt,Ze,an),Uw=qi(le,BS,De,ne,Ht,re,te,pt),VS=ds(le,ms,Ie,ne,El(we,Vt),re,te,ye),WS=Gs(Ue,tn,ee,ze,ye),mt=sd(_w),zw=Us(le,De,WS,kt,tn,re,te,mt),ot=dl(Oe,pn),HS=ip(ne,ot),nt=zl(Ze,HS),US=$s(nt,ee,ye),Gw=Ys(le,US,nt,re,te),zS=ea(Lt,ee,ye),jw=Qs(le,zS,Lt,re,te,pp),GS=$l(to,Ht,we,ot),Ut=Yl(to,Te,GS,Jr,eo),jS=ua(Ue,Ut,ee,ze,ye),qw=ca(le,De,jS,Ut,re,te,pt),Xw=Ql(ge,Vt),qS=xa(Xw,ee,ye),Yw=ha(le,qS,Xw,re,te,mt),XS=Ma(Ue,rn,ee,ze,ye),Zw=Ia(le,De,XS,rn,re,te,mt),$w=tu(ge),YS=za(Ue,$w,ee,ze,ye),Kw=Ha(le,De,YS,$w,ge,re,te,mt),ZS=oc(Ue,we,ee,ze,ye),Qw=tc(le,De,ZS,we,re,te),$S=au(kt,ne,Bt,ge),ro=rd(Te,we,Bt,Ud(we,xe)),KS=Ac(Ht,ee,xe,ye,ro),QS=nu($S),Jw=Sc(le,QS,KS,re,te,mt),JS=fs(De,nt,Ut,Bt,ge,nn,te,Vt),eN=new WeakMap,xn=al(VS,JS,Rw,te,eN,pt),tN=yu(to,Te,Jr,cn,eo,ln),e0=Hu(Ue,tN,ee,ze,ye),rN=Vu(le,De,tN,e0,re,te,pt),oN=sa(Ht),t0=ku(oN,ne,we,sn,ot),oo=Ou(oN,ne,t0,sn,ot,Ze,Vt),r0=Su(bt,ne,nt,we,Bt,oo,ge,Mt,nn,ot),nN=wu(r0),o0=ju(Ue,nt,Ut,we,nN,ee,xe,ze,ye,ro),iN=zu(le,De,nN,o0,re,te,mt),n0=Au(Ie),sN=Xu(n0,re,new WeakSet,hp),i0=Pu(nt,Lt,we,oo,ge,ot),aN=bu(i0,ge),s0=pd(Ue,aN,ee,ze,ye),cN=ud(le,De,aN,s0,re,te),a0=Zd(oo,ee,ye),lN=Xd(le,ne,oo,a0,re,te,mt),uN=Xc(ke),vn=Ka(ke),dN=new WeakMap,c0=vc(dN,xe),pN=uN?Mi(Te,ge,Xa(ke),vn,Ja(hi),re,c0,te,Wt,new WeakMap,new WeakMap,bd(Wt,xe),ke):void 0,l0=zc(dn,te),mN=Sa(mn,Te,Ca,ja,new WeakSet,re,l0,Et,_e,hn,fn),hN=Ws(pN,Bw,Ww,Uw,zw,Gw,jw,qw,Yw,mN,Zw,Kw,Qw,Jw,xn,rN,iN,sN,cN,lN),fN=Kc(le,lu,re,te),xN=Jc(le,du,re,te),vN=tl(le,mu,re,te),u0=fu(ne,te),gN=ol(le,u0,re),d0=ls(hN,ne,ge,on,fN,xN,vN,gN,Ze),gn=yc(eN),p0=Li(gn),yN=na(Ie),m0=_a(gn),CN=Va(Ie),wN=new WeakMap,h0=ic(wN,de),f0=Wl(yN,Ie,ne,nt,Lt,Ut,we,Bt,ge,CN,vn,h0,ot),x0=Ol(ne,f0,we,ge,ot),v0=Bs(Ue,yN,Ht,nt,Lt,Ut,we,m0,CN,vn,ee,Wt,xe,ze,ye,ro),g0=mc(dN),y0=nd(wN),C0=uN?ks(p0,le,De,v0,x0,me,g0,re,te,Wt,up,y0,Ep,pt):void 0,w0=il(ne,ge,on,xn,Ze),NN=ga(ge,xe),SN=cd(mn,Te,un,gn,ro,Et,hn,fn),N0=ll(Te,ne,NN,xn,SN),S0=Lu(hN,Te,ne,NN,SN),T0=Mc(Nt,dn),A0=Fc(wt,pn),E0=_c(Jt,Lw),I0=Dc(Nt,te),b0=()=>Zc(Te,xd(xe),gd(Ze),Cd(xe),Nd(Ze),Td(xe),Ed(Wt,xe),Pd(xe),Od(xe),kd(xe),Rd(xe),bp,Bd(ke),Wd(Ze),Gd(xe),Pp)});var PN=ZN((PG,MN)=>{"use strict";function M0(t){for(var o=1/0,e=-1/0,r=0,n=t.length,s;r<n;r++)s=t[r],o>s&&(o=s),e<s&&(e=s);return{min:o,max:e}}function EN(t,o){var e=Math.pow(2,o-1),r=t<0?t*e:t*(e-1);return Math.max(-e,Math.min(e-1,r))}function IN(t,o,e){var r,n=t.length,s=Math.ceil(n/o),c,a,l,u,d,p,m=bN(e,s*2);for(r=0;r<s;r++)c=r*o,a=(r+1)*o>n?n:(r+1)*o,l=t.subarray(c,a),p=M0(l),d=EN(p.min,e),u=EN(p.max,e),m[r*2]=d,m[r*2+1]=u;return m}function bN(t,o){return new(new Function(`return Int${t}Array`)())(o)}function P0(t,o){var e=t.length,r=1/e,n=t[0].length/2,s=0,c=0,a,l,u=bN(o,n*2);for(c=0;c<n;c++){for(a=0,l=0,s=0;s<e;s++)a+=r*t[s][c*2],l+=r*t[s][c*2+1];u[c*2]=a,u[c*2+1]=l}return[u]}function no(t,o){return typeof t=="number"?t:o}MN.exports=function(t,o,e,r,n,s){if(o=no(o,1e3),s=no(s,16),e==null&&(e=!0),[8,16,32].indexOf(s)<0)throw new Error("Invalid number of bits specified for peaks.");var c=t.numberOfChannels,a=[],l,u,d,p;if(r=no(r,0),n=no(n,t.length),typeof t.subarray=="undefined")for(l=0;l<c;l++)d=t.getChannelData(l),p=d.subarray(r,n),a.push(IN(p,o,s));else a.push(IN(t.subarray(r,n),o,s));return e&&a.length>1&&(a=P0(a,s)),u=a[0].length/2,{length:u,data:a,bits:s}}});var Re=(t,o)=>{let e=t.target===document.body,r=o.uiContainer.contains(t.target),n=o.playerControlsContainer.contains(t.target),s=o.videoElement.contains(t.target),c=o.canvas.contains(t.target);return r||n||s||c||e};function mr(t){return t.pointerType==="touch"&&t.isPrimary===!1}function Sn(t,o){if(!Re(t,o))return;let e=o.uiContainer.contains(t.target),r=o.playerControlsContainer.contains(t.target);if(e||r)return;let n=o.videoElement;n.tagName==="VIDEO"&&(n.paused||(o.currentTool=null,n.pause(),o.raf(()=>O(this,null,function*(){o.redrawFullCanvas()}))))}function Tn(t,o){var e;Re(t,o)&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),(e=t.clipboardData)==null||e.setData("application/json",JSON.stringify(o.saveCurrentFrame())))}function An(t,o){var r;if(!Re(t,o))return;t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();let e=o.saveCurrentFrame();o.replaceFrame(o.playbackFrame,[]),o.redrawFullCanvas(),(r=t.clipboardData)==null||r.setData("application/json",JSON.stringify(e))}function En(t,o){if(!Re(t,o))return;let e=o.videoElement;e.tagName==="VIDEO"&&(t.key==="ArrowLeft"||t.key==="ArrowRight"?(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),t.key==="ArrowLeft"?o.prevFrame():t.key==="ArrowRight"&&o.nextFrame()):t.code==="Space"&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.paused?e.play().then(()=>{o.redrawFullCanvas()}):(e.pause(),o.raf(()=>{o.redrawFullCanvas()}))))}function In(t,o){var s,c,a,l,u;if(!Re(t,o))return;let e=(c=(s=t.clipboardData)==null?void 0:s.types)!=null?c:[];if(e.includes("application/json"))t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();else if(e.includes("Files")){let d=(a=t.clipboardData)==null?void 0:a.files;if(d&&d.length>0){let p=d[0];if(p.type.startsWith("image/")){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();let m=new Image;m.addEventListener("load",()=>{let h=m.naturalWidth/m.naturalHeight,v=.25,x=v/h*o.aspectRatio;o.addShapesToFrame(o.playbackFrame,[{type:"image",image:m,x:0,y:0,width:v,height:x,strokeStyle:"red",fillStyle:"red",lineWidth:2}]),o.redrawFullCanvas(),o.raf(()=>{o.show()}),o.currentTool="move"},{once:!0}),m.src=URL.createObjectURL(p),o.redrawFullCanvas()}}}else if(e.includes("text/plain")){let d=(l=t.clipboardData)==null?void 0:l.getData("text/plain");d&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),o.addShapesToFrame(o.playbackFrame,[{type:"text",text:d,x:.4,y:.4,strokeStyle:o.ctx.strokeStyle,fillStyle:o.ctx.fillStyle,lineWidth:o.ctx.lineWidth}]),o.show(),o.currentTool="move",o.redrawFullCanvas())}else return;let r=(u=t.clipboardData)==null?void 0:u.getData("application/json");if(!r)return;let n=JSON.parse(r);n&&n.shapes&&n.version===1&&(o.addShapesToFrame(o.playbackFrame,n.shapes),o.redrawFullCanvas())}function bn(t,o){let e=document.createElement("button");e.type="button",e.style.margin="5px",e.style.float="right",e.title="Download current frame",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path></svg>',o.addEvent(e,"click",()=>{let r=o.frameToDataUrl();if(!r)return;let n=document.createElement("a");n.download=`frame_${String(o.activeTimeFrame).padStart(3,"0")}.png`,n.href=r,n.click()}),o.buttons.push(e),o.playerControlsContainer.appendChild(e)}var Mn='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-x"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="22" x2="16" y1="9" y2="15"></line><line x1="16" x2="22" y1="9" y2="15"></line></svg>',Pn='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></svg>';function Fn(t,o){let e=document.createElement("button");e.type="button",e.style.margin="5px",t.muted||t.volume===0?e.innerHTML=Pn:e.innerHTML=Mn,o.addEvent(t,"volumechange",()=>{t.muted||t.volume===0?e.innerHTML=Mn:e.innerHTML=Pn}),o.addEvent(e,"click",()=>{t.muted&&(t.muted=!1),t.volume===0?t.volume=1:t.volume=0}),o.buttons.push(e),o.playerControlsContainer.appendChild(e)}var On='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>',JN='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pause"><rect width="4" height="16" x="6" y="4"></rect><rect width="4" height="16" x="14" y="4"></rect></svg>';function _n(t,o){let e=document.createElement("button");e.type="button",e.innerHTML=On,e.style.margin="5px",o.addEvent(t,"play",()=>{e.innerHTML=JN}),o.addEvent(t,"pause",()=>{e.innerHTML=On}),o.addEvent(e,"click",()=>{o.withRefVideo(r=>{r.paused&&r.play().then(()=>{o.showButton("compare")})}),t.paused?t.play().then(()=>{o.redrawFullCanvas()}):(t.pause(),o.raf(()=>{o.redrawFullCanvas()}))}),o.buttons.push(e),o.playerControlsContainer.appendChild(e)}function kn(t){return`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-superscript">
        <style>
            .small {
                font-family: auto;
                font-size: ${t===1?"16":"24"}px;
            }
        </style>
        <text x="${t===1?3:2}" y="${t===1?17:20}" font-weight="normal" class="small">${{"0.25":"\xBC","0.5":"\xBD","0.75":"\xBE",1:"1\xD7"}[String(t)]}</text>
        
    </svg>`}function Dn(t,o){let e=[.25,.5,.75,1],r=document.createElement("button"),n=e[e.length-1];r.type="button",t.playbackRate=n,r.innerHTML=kn(n),r.style.margin="5px",o.addEvent(r,"click",()=>{let s=e.indexOf(t.playbackRate),c=s+1>=e.length?0:s+1;t.playbackRate=e[c],r.innerHTML=kn(e[c])}),o.buttons.push(r),o.playerControlsContainer.appendChild(r)}var eS="#F3CE32";function Rn(){var d,p;let t=document.createElement("div");t.style.position="absolute",t.style.top="-40px",t.style.left="0",t.style.zIndex="2",(d=this.canvas.parentNode)==null||d.insertBefore(t,this.canvas);let o=document.createElement("div");o.style.position="relative",o.style.top="0",o.style.left="0",o.style.zIndex="2",(p=this.canvas.parentNode)==null||p.insertBefore(o,this.canvas.nextSibling),this.playerControlsContainer=o;let e=this.videoElement.tagName==="VIDEO"?this.videoElement:null;this.uiContainer=t;let r=(m,h,v=t)=>{let x=document.createElement("button");if(x.type="button",x.innerHTML=m,x.style.margin="5px",v.appendChild(x),this.buttons.push(x),typeof h=="function")this.addEvent(x,"click",h);else{x.dataset.tool=h;let f=()=>{this.currentTool===h?this.currentTool=null:this.currentTool=h};this.addEvent(x,"click",f)}return x},n=()=>{let m=document.createElement("div");return m.style.display="inline-flex",m.style.alignItems="center",m.style.margin="5px",t.appendChild(m),m};r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>',"rectangle"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle></svg>',"circle"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.3 8.7 8.7 21.3c-1 1-2.5 1-3.4 0l-2.6-2.6c-1-1-1-2.5 0-3.4L15.3 2.7c1-1 2.5-1 3.4 0l2.6 2.6c1 1 1 2.5 0 3.4Z"></path><path d="m7.5 10.5 2 2"></path><path d="m10.5 7.5 2 2"></path><path d="m13.5 4.5 2 2"></path><path d="m4.5 13.5 2 2"></path></svg>',"line"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08"></path><path d="M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z"></path></svg>',"curve"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>',"arrow"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 7 4 4 20 4 20 7"></polyline><line x1="9" y1="20" x2="15" y2="20"></line><line x1="12" y1="4" x2="12" y2="20"></line></svg>',"text"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"></path><path d="M22 21H7"></path><path d="m5 11 9 9"></path></svg>',"eraser"),this.isMobile&&(this.hideButton("line"),this.hideButton("circle"),this.hideButton("rectangle"),this.hideButton("eraser")),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="5 9 2 12 5 15"></polyline><polyline points="9 5 12 2 15 5"></polyline><polyline points="15 19 12 22 9 19"></polyline><polyline points="19 9 22 12 19 15"></polyline><line x1="2" y1="12" x2="22" y2="12"></line><line x1="12" y1="2" x2="12" y2="22"></line></svg>',"move"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flip-horizontal"><path d="M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3"></path><path d="M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3"></path><path d="M12 20v2"></path><path d="M12 14v2"></path><path d="M12 8v2"></path><path d="M12 2v2"></path></svg>',"compare"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>',()=>{this.handleUndo()}),e&&(r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>',()=>{this.prevFrame()},this.playerControlsContainer),_n(e,this),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>',()=>{this.nextFrame()},this.playerControlsContainer),Fn(e,this),Dn(e,this),bn(e,this));let s=document.createElement("input");s.type="color",s.value=eS,s.style.margin="5px",this.colorPicker=s,t.appendChild(s);let c=n(),a=document.createElement("input");a.type="number",a.step="1",a.min="1",a.max="10",a.value="5",a.style.margin="5px",c.appendChild(a);let l=m=>{this.ctx.lineWidth=m.target.valueAsNumber,this.focusOnMediaNode()};this.addEvent(a,"input",l);let u=m=>{this.ctx.strokeStyle=m.target.value,this.ctx.fillStyle=m.target.value,this.focusOnMediaNode()};this.addEvent(s,"input",u),this.colorPicker=s,this.strokeSizePicker=a,this.hideButton("compare"),e&&(this.hide(),this.addEvent(e,"pause",()=>{this.show()}),this.addEvent(e,"seek",()=>{e.paused&&this.show()}),this.addEvent(e,"timeupdate",()=>{e.currentTime<2e-4&&!e.paused&&this.startAnnotationsAsVideo()}),this.addEvent(e,"error",()=>{this.hide()}),this.addEvent(e,"stalled",()=>{this.hide()}),this.addEvent(e,"play",()=>{this.hideControls(),this.startAnnotationsAsVideo()}),this.addEvent(document,"copy",m=>{Tn(m,this)}),this.addEvent(document,"cut",m=>{An(m,this)}),this.addEvent(document,"paste",m=>{In(m,this)}),this.addEvent(document,"click",m=>{Sn(m,this)}),this.addEvent(document,"keydown",m=>{En(m,this)}))}function Ln(){var t;this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),(t=this.videoElement.parentNode)==null||t.insertBefore(this.canvas,this.videoElement.nextSibling),this.canvas.style.position="absolute",this.canvas.style.backgroundColor="transparent",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.zIndex="1",this.addEvent(this.canvas,"pointerdown",this.handleMouseDown),this.addEvent(this.canvas,"pointermove",this.handleMouseMove),this.addEvent(this.canvas,"pointerup",this.handleMouseUp),this.addEvent(this.canvas,"pointercancel",this.handleMouseUp),this.addEvent(window,"resize",this.setCanvasSize),this.addEvent(document,"keydown",this.onKeyDown)}var hr=class{constructor(){this.destructors=[];this.isDestroyed=!1;this.activeTimeFrame=1;this.globalShapes=[];this.timeStack=new Map;this.undoTimeStack=new Map}cleanFrameStacks(){this.timeStack.clear(),this.undoTimeStack.clear()}destroy(){this.destructors.forEach(o=>o()),this.destructors=[],this.globalShapes=[],this.cleanFrameStacks()}raf(o){return requestAnimationFrame(o)}addEvent(o,e,r){let n=s=>{this.isDestroyed||r(s)};o.addEventListener(e,n),this.destructors.push(()=>{o.removeEventListener(e,n)})}addProgressBarOverlay(){throw new Error("Method not implemented.")}initUI(){throw new Error("Method not implemented.")}initCanvas(){throw new Error("Method not implemented.")}addFrameSquareOverlay(o=this.activeTimeFrame){throw new Error("Method not implemented.")}addVideoOverlay(){throw new Error("Method not implemented.")}withRefVideo(o){this.isDestroyed||this.referenceVideoElement&&o(this.referenceVideoElement)}withVideo(o){if(this.isDestroyed)return;let e=this.videoElement;!e||e.tagName!=="VIDEO"||o(e)}};var oe=class{constructor(o){this.startX=0;this.startY=0;this.isDrawing=!1;this.annotationTool=o}get ctx(){return this.annotationTool.ctx}onDeactivate(){}onActivate(){}reset(){this.startX=0,this.startY=0,this.isDrawing=!1}save(o){this.annotationTool.addShape(o)}};var fr=class extends oe{constructor(){super(...arguments);this.name="rectangle"}move(e,r,n){return e.x+=r,e.y+=n,e}normalize(e,r,n){return F(N({},e),{x:e.x/r,y:e.y/n,width:e.width/r,height:e.height/n})}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.drawRectangle(this.startX,this.startY,r-this.startX,n-this.startY)}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.save({type:"rectangle",x:this.startX,y:this.startY,width:r-this.startX,height:n-this.startY,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth}),this.drawRectangle(this.startX,this.startY,r-this.startX,n-this.startY),this.isDrawing=!1}drawRectangle(e,r,n,s){this.ctx.beginPath(),this.ctx.rect(e,r,n,s),this.ctx.stroke()}draw(e){this.drawRectangle(e.x,e.y,e.width,e.height)}};var xr=class extends oe{constructor(){super(...arguments);this.name="circle"}move(e,r,n){return e.x+=r,e.y+=n,e}normalize(e,r,n){return F(N({},e),{x:e.x/r,y:e.y/n,radius:e.radius/r})}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e),s=Math.sqrt(Math.pow(r-this.startX,2)+Math.pow(n-this.startY,2));this.drawCircle(this.startX,this.startY,s)}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e),s=Math.sqrt(Math.pow(r-this.startX,2)+Math.pow(n-this.startY,2));this.save({type:"circle",x:this.startX,y:this.startY,radius:s,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth}),this.drawCircle(this.startX,this.startY,s),this.isDrawing=!1}drawCircle(e,r,n){this.ctx.beginPath(),this.ctx.arc(e,r,n,0,2*Math.PI),this.ctx.stroke()}draw(e){this.drawCircle(e.x,e.y,e.radius)}};var vr=class{constructor(o,e){this.x=o;this.y=e}distanceToLine(o,e){let r=e.x-o.x,n=e.y-o.y,s=Math.abs(n*this.x-r*this.y+e.x*o.y-e.y*o.x),c=Math.sqrt(n*n+r*r);return s/c}};function gr(t,o){if(t.length<=2)return t;let e=t[0],r=t[t.length-1],n=-1,s=0;for(let c=1;c<t.length-1;c++){let a=t[c].distanceToLine(e,r);a>s&&(n=c,s=a)}if(s>o){let c=gr(t.slice(0,n+1),o),a=gr(t.slice(n),o);return c.slice(0,c.length-1).concat(a)}else return[e,r]}var yr=class extends oe{constructor(){super(...arguments);this.name="curve";this.curvePoints=[]}move(e,r,n){return e.points=e.points.map(s=>({x:s.x+r,y:s.y+n})),e}normalize(e,r,n){return F(N({},e),{points:e.points.map(s=>({x:s.x/r,y:s.y/n}))})}draw(e){this.drawCurve(e)}reset(){super.reset(),this.curvePoints=[]}onPointerDown(e){if(this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.curvePoints=[],this.startX=r,this.startY=n,this.isDrawing=!0,this.curvePoints.push({x:r,y:n})}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.curvePoints.push({x:r,y:n}),this.drawCurve({points:this.curvePoints,lineWidth:this.ctx.lineWidth})}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.curvePoints.push({x:r,y:n});let s=this.curvePoints.map(d=>new vr(d.x,d.y)),u={type:"curve",points:gr(s,2).map(d=>({x:d.x,y:d.y})),strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth};this.save(u),this.curvePoints=[],this.isDrawing=!1}drawCurve(e){if(e.points.length===2&&e.points[0].x===e.points[1].x&&e.points[0].y===e.points[1].y){let r=e.lineWidth/4,n=0,s=2*Math.PI;this.ctx.beginPath(),this.ctx.arc(e.points[0].x,e.points[0].y,r,n,s),this.ctx.stroke()}else{this.ctx.beginPath(),this.ctx.moveTo(e.points[0].x,e.points[0].y);for(let r=1;r<e.points.length-1;r++){let n=e.points[r],s=e.points[r+1];this.ctx.quadraticCurveTo(n.x,n.y,s.x,s.y)}this.ctx.stroke()}}};var Cr=class extends oe{constructor(){super(...arguments);this.name="line"}move(e,r,n){return e.x1+=r,e.y1+=n,e.x2+=r,e.y2+=n,e}normalize(e,r,n){return F(N({},e),{x1:e.x1/r,y1:e.y1/n,x2:e.x2/r,y2:e.y2/n})}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.drawLine(this.startX,this.startY,r,n)}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.save({type:"line",x1:this.startX,y1:this.startY,x2:r,y2:n,fillStyle:this.ctx.fillStyle,strokeStyle:this.ctx.strokeStyle,lineWidth:this.ctx.lineWidth}),this.drawLine(this.startX,this.startY,r,n),this.isDrawing=!1}drawLine(e,r,n,s){this.ctx.beginPath(),this.ctx.moveTo(e,r),this.ctx.lineTo(n,s),this.ctx.stroke()}draw(e){this.drawLine(e.x1,e.y1,e.x2,e.y2)}};var wr=class extends oe{constructor(){super(...arguments);this.name="arrow"}normalize(e,r,n){return F(N({},e),{x1:e.x1/r,y1:e.y1/n,x2:e.x2/r,y2:e.y2/n})}move(e,r,n){return e.x1+=r,e.y1+=n,e.x2+=r,e.y2+=n,e}draw(e){this.drawArrow(e.x1,e.y1,e.x2,e.y2)}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.drawArrow(this.startX,this.startY,r,n)}onPointerUp(e){if(!this.isDrawing)return;this.isDrawing=!1;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.save({type:"arrow",x1:this.startX,y1:this.startY,x2:r,y2:n,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth})}drawArrow(e,r,n,s){let c=10+2.5*this.ctx.lineWidth,a=Math.PI/6,l=Math.atan2(s-r,n-e);this.ctx.beginPath(),this.ctx.moveTo(e,r),this.ctx.lineTo(n,s),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(n,s),this.ctx.lineTo(n-c*Math.cos(l+a),s-c*Math.sin(l+a)),this.ctx.moveTo(n,s),this.ctx.lineTo(n-c*Math.cos(l-a),s-c*Math.sin(l-a)),this.ctx.stroke()}};var Nr=class extends oe{constructor(){super(...arguments);this.name="text"}move(e,r,n){return e.x+=r,e.y+=n,e}onActivate(){this.annotationTool.canvas.style.cursor="text",this.isDrawing=!0}onDeactivate(){this.annotationTool.canvas.style.cursor="default",this.isDrawing=!1}draw(e){let r=e.text.split(`
`);for(let n=0;n<r.length;n++)this.drawText(e.x,e.y+n*20,r[n])}drawText(e,r,n){let s=16+this.ctx.lineWidth*.5;this.ctx.font=`${s}px Helvetica Neue, Arial`,this.ctx.fillText(n,e,r)}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n}onPointerMove(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.ctx.beginPath(),this.ctx.arc(r,n,5,0,2*Math.PI),this.ctx.fill()}normalize(e,r,n){return F(N({},e),{x:e.x/r,y:e.y/n})}onPointerUp(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e),s=prompt("Enter the text to be drawn:");s!==null&&this.save({type:"text",x:r,y:n,text:s,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth})}};var Sr=class extends oe{constructor(){super(...arguments);this.name="eraser"}move(e,r,n){return e.x+=r,e.y+=n,e}normalize(e,r,n){return F(N({},e),{x:e.x/r,y:e.y/n,width:e.width/r,height:e.height/n})}draw(e){this.drawEraser(e.x,e.y,e.width,e.height)}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.ctx.save(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.lineWidth=1,this.ctx.fillStyle="rgba(255, 255, 255, 0.3)",this.ctx.fillRect(this.startX,this.startY,r-this.startX,n-this.startY),this.ctx.strokeRect(this.startX,this.startY,r-this.startX,n-this.startY),this.ctx.restore()}onPointerUp(e){if(!this.isDrawing)return;this.isDrawing=!1;let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.save({type:"eraser",x:this.startX,y:this.startY,width:r-this.startX,height:n-this.startY,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth})}drawEraser(e,r,n,s){this.ctx.clearRect(e,r,n,s)}};var Tr=class extends oe{constructor(){super(...arguments);this.name="move";this.shape=null;this.lastDrawnShape=null;this.shapeRemoved=!1;this.isScale=!1}move(e){return e}normalize(e){return N({},e)}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e),s=this.annotationTool.shapes.slice(0).pop();s&&(this.shape=s,this.shapeRemoved=!1,this.lastDrawnShape=null,this.startX=r,this.startY=n,this.isDrawing=!0,this.isScale=s.type==="image"?this.isPointerAtCorner(s,r,n):!1)}isPointerAtCorner(e,r,n){let s=this.annotationTool.deserialize([e])[0],c=15,a=Math.abs(s.y-n)<c,l=Math.abs(s.x-r)<c,u=Math.abs(s.x+s.width-r)<c,d=Math.abs(s.y+s.height-n)<c;return a&&l||a&&u||d&&l||d&&u}onPointerMove(e){if(!this.isDrawing||!this.shape)return;this.shapeRemoved||(this.annotationTool.removeLastShape(),this.shapeRemoved=!0);let{x:r,y:n}=this.annotationTool.getRelativeCoords(e),s=r-this.startX,c=n-this.startY;this.startX=r-s,this.startY=n-c;let a=this.annotationTool.deserialize([this.shape])[0],l=a.type==="image"?a:JSON.parse(JSON.stringify(a));if(l.type==="image")if(this.isScale){let{width:u,height:d}=l,p=u/d,m=u+s,h=m/p;l.width=m,l.height=h,this.lastDrawnShape=l,this.annotationTool.pluginForTool(l.type).draw(l)}else{let u=this.annotationTool.pluginForTool(l.type).move(l,s,c);this.lastDrawnShape=u,this.annotationTool.pluginForTool(l.type).draw(u)}else{let u=this.annotationTool.pluginForTool(l.type).move(l,s,c);this.lastDrawnShape=u,this.annotationTool.pluginForTool(l.type).draw(u)}}onPointerUp(e){!this.isDrawing||!this.lastDrawnShape||(this.lastDrawnShape&&(this.lastDrawnShape.fillStyle=this.annotationTool.ctx.fillStyle,this.lastDrawnShape.strokeStyle=this.annotationTool.ctx.strokeStyle,this.lastDrawnShape.lineWidth=this.annotationTool.ctx.lineWidth,this.save(this.lastDrawnShape)),this.isDrawing=!1,this.isScale=!1,this.shape=null,this.shapeRemoved=!1,this.lastDrawnShape=null)}draw(){throw new Error("Method not implemented.")}reset(){this.isDrawing=!1,this.shape=null,this.isScale=!1,this.lastDrawnShape=null,this.shapeRemoved=!1}};var Ar=class extends oe{constructor(){super(...arguments);this.name="image"}move(e,r,n){return e.x+=r,e.y+=n,e}onPointerDown(e){}onPointerMove(e){}onPointerUp(e){}normalize(e,r,n){return F(N({},e),{x:e.x/r,y:e.y/n,width:e.width/r,height:e.height/n})}draw(e){if(!(e.image instanceof HTMLImageElement)){console.error("Image is not an instance of HTMLImageElement");return}this.ctx.drawImage(e.image,e.x,e.y,e.width,e.height)}};var tS=.7,Er=class extends oe{constructor(){super(...arguments);this.name="compare";this.comparisonLine=0;this.leftOpacity=1;this.rightOpacity=1;this.isDrawing=!1}move(e,r,n){return e.x+=r,e}onActivate(){this.comparisonLine=this.annotationTool.canvasWidth/2,this.leftOpacity=1,this.rightOpacity=this.annotationTool.isMobile?1:tS,this.annotationTool.canvas.style.cursor="col-resize"}onDeactivate(){this.annotationTool.canvas.style.cursor="default",this.comparisonLine=0,this.leftOpacity=1,this.rightOpacity=1,this.isDrawing=!1}normalize(e,r){return F(N({},e),{x:e.x/r})}onPointerDown(e){let{x:r,y:n}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=n,this.isDrawing=!0,this.disablePreviousCompare(),this.onPointerMove(e)}onPointerMove(e){if(!this.isDrawing){if(this.annotationTool.globalShapes.length>0){let s=this.annotationTool.globalShapes[0];if(s.type==="compare"){let c=this.annotationTool.deserialize([s])[0];this.draw(c),this.annotationTool.addFrameSquareOverlay()}}return}let{x:r}=this.annotationTool.getRelativeCoords(e);this.comparisonLine=r;let n={type:"compare",strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth,x:r};this.draw(n),this.drawDelimiter(n)}onPointerUp(){this.isDrawing&&(this.save({type:"compare",strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth,disabled:!1,x:this.comparisonLine}),this.isDrawing=!1)}removePreviousCompare(){this.annotationTool.globalShapes=this.annotationTool.globalShapes.filter(e=>e.type!=="compare")}disablePreviousCompare(){this.annotationTool.globalShapes=this.annotationTool.globalShapes.map(e=>e.type==="compare"?F(N({},e),{disabled:!0}):e)}save(e){this.removePreviousCompare();let r=this.annotationTool.serialize([e])[0];r.x<.05||r.x>.95||this.annotationTool.addGlobalShape(r)}drawDelimiter(e){this.ctx.beginPath(),this.ctx.moveTo(e.x,0),this.ctx.lineTo(e.x,this.annotationTool.canvasWidth),this.ctx.stroke()}drawShape(e){var k,_,B,G,V,H,j,Q;let r=this.annotationTool.videoElement,n=this.annotationTool.referenceVideoElement;if(!r||!n)return;let s=this.ctx.globalAlpha,c=this.annotationTool.canvasWidth,a=this.annotationTool.canvasHeight,l=e.x,u=n.videoHeight-r.videoHeight,d=n.videoWidth-r.videoWidth,p=this.annotationTool.isMobile;this.ctx.globalAlpha=this.leftOpacity;let m=(_=(k=this.annotationTool.referenceVideoFrameBuffer)==null?void 0:k.frameNumberFromTime(r.currentTime))!=null?_:1,h=m;if(d>r.videoWidth&&u>r.videoHeight&&!this.annotationTool.isMobile){let X=(H=(V=this.annotationTool.referenceVideoFrameBuffer)==null?void 0:V.getFrameNumberBySignature((G=(B=this.annotationTool.videoFrameBuffer)==null?void 0:B.getHistogram(m))!=null?G:null,m))!=null?H:m,ue=Math.abs(m-X);ue>=1&&ue<=3&&(h=X)}let x=(j=this.annotationTool.referenceVideoFrameBuffer)==null?void 0:j.getFrame(h),f=(Q=this.annotationTool.videoFrameBuffer)==null?void 0:Q.getFrame(m);if(p){this.ctx.imageSmoothingQuality="low";let X=l/c,ue=l;this.ctx.drawImage(f!=null?f:r,0,0,X*r.videoWidth,r.videoHeight,0,0,ue,a)}else{let X=f?f.width:r.videoWidth,ue=f?f.height:r.videoHeight;this.ctx.drawImage(f!=null?f:r,0,0,X,ue,0,0,c,a)}this.ctx.globalAlpha=this.rightOpacity;let g=0,S=0,A=r.videoWidth/r.videoHeight,M=n.videoWidth/n.videoHeight,w=Math.abs(A-M)>.1,y=10,C=Math.abs(u)>y,P=r.videoWidth,R=r.videoHeight,I=0;if(d<-y)if(w){let X=r.videoWidth/c;I=Math.abs(d/2),I=I/X,I<=y&&(I=0)}else P=n.videoWidth;else d>y&&(P=n.videoWidth);if(u===0)g=0;else if(u>0)w?(g=u/2,g<=y&&(g=0)):R=C?n.videoHeight:r.videoHeight;else if(!w)R=C?n.videoHeight:r.videoHeight;else{S=Math.abs(u/2);let X=r.videoHeight/a;S=S/X,S<=y&&(S=0)}let E=l-I,L=c-E,b=L/c*P;x?(p&&(this.ctx.imageSmoothingQuality="low"),this.ctx.drawImage(x,E/c*P,g,b,R,E+I,S,L,a)):console.log("no video data",m),this.ctx.globalAlpha=s}draw(e){if(e.disabled)return;let r=this.annotationTool.videoElement,n=this.annotationTool.referenceVideoElement;!r||!n||this.drawShape(e)}};var io=class extends oe{constructor(e){super(e);this.name="audio-peaks";this.props={scale:1,peaks:[],theme:{waveOutlineColor:"rgba(255,192,203,0.7)",waveFillColor:"grey",waveProgressColor:"orange"},waveHeight:40,bits:16};e.setVideoBlob=r=>{let n=new FileReader;n.onload=s=>{setTimeout(()=>{var c;this.init((c=s.target)==null?void 0:c.result)},3e3)},n.readAsArrayBuffer(r)}}init(e){return O(this,null,function*(){let{AudioContext:r}=yield Promise.resolve().then(()=>(AN(),TN)),{default:n}=yield Promise.resolve().then(()=>QN(PN(),1));new r().decodeAudioData(e,c=>{let l=this.annotationTool.progressBarCoordinates.width,u=Math.ceil(c.length/l),d=n(c,u,!0),p=Math.min(...d.data[0]),m=Math.max(...d.data[0]),h=Math.pow(2,d.bits-1)-1,v=-Math.pow(2,d.bits-1);this.props.peaks=d.data[0].map(x=>x<0?Math.round(x/p*v):Math.round(x/m*h)),this.props.bits=d.bits,this.annotationTool.addGlobalShape({x:0,y:0,strokeStyle:"red",fillStyle:"red",lineWidth:1,type:"audio-peaks"}),console.log(d)})})}move(e,r,n){return e.x+=r,e.y+=n,e}normalize(e,r,n){return F(N({},e),{x:e.x/r,y:e.y/n})}onPointerDown(e){}onPointerMove(e){}onPointerUp(e){}draw(e){if(this.annotationTool.videoElement.muted)return;this.ctx.clearRect(0,0,this.annotationTool.canvasWidth,this.annotationTool.canvasHeight);let{peaks:n,bits:s,waveHeight:c,theme:a}=this.props,l=this.ctx,u=0,d=this.annotationTool.progressBarCoordinates.x,p=c/2,m=pr(2,s-1),h=this.annotationTool.progressBarCoordinates.y-40;l.fillStyle=a.waveOutlineColor;let v=this.annotationTool.progressBarCoordinates.width*this.annotationTool.pixelRatio,{x,width:f}=this.annotationTool.progressBarCoordinates,g=this.annotationTool.playbackFrame,S=this.annotationTool.videoElement.duration*this.annotationTool.fps,A=Math.ceil(g/S*f)+x;for(let M=0;M<v;M+=1){let T=n[(M+u)*2]/m,w=n[(M+u)*2+1]/m,y=Math.abs(T*p),C=Math.abs(w*p);M+d===A?(l.fillStyle=a.waveProgressColor,l.fillRect(M+d,h+0,1,p*2)):(l.fillStyle=a.waveOutlineColor,l.fillRect(M+d,h+0+p-C,1,C+y))}}};var FN=[fr,xr,Cr,wr,Nr,Sr,yr,Tr,Ar,Er,io];function ON(t,o){let e,r,n,s=[],c=!0;function a(d,p){let m=Math.abs(p.mediaTime-e),h=Math.abs(p.presentedFrames-r),v=m/h;v&&v<1&&c&&s.length<50&&t.playbackRate===1&&document.hasFocus()&&(s.push(v),n=Math.round(1/u()),o(n,s.length*2)),c=!0,e=p.mediaTime,r=p.presentedFrames,t.requestVideoFrameCallback(a)}t.requestVideoFrameCallback(a);let l=()=>{s.pop(),c=!1};t.addEventListener("seeked",l);function u(){return s.reduce((d,p)=>d+p)/s.length}return()=>{t.removeEventListener("seeked",l)}}function _N(t,o,e){return .299*t+.587*o+.114*e}var F0=0,Cn=class extends Array{constructor(){super(...arguments);this.id=F0++}};function kN(t){let o=t.width,e=t.height,r=new Array(o*e),n=new Cn,s=0;for(let c=0;c<t.data.length;c+=4)r[s]=_N(t.data[c],t.data[c+1],t.data[c+2]),s++;for(let c=1;c<e-1;c++)for(let a=1;a<o-1;a++){let l=c*o+a,u=-r[l-o-1]+r[l-o+1]-2*r[l-1]+2*r[l+1]-r[l+o-1]+r[l+o+1],d=r[l-o-1]+2*r[l-o]+r[l-o+1]-r[l+o-1]-2*r[l+o]-r[l+o+1],p=Math.sqrt(u*u+d*d);n.push(p)}return n}var yn=new Map,O0=(t,o)=>Math.max(t.id,o.id)+"-"+Math.min(t.id,o.id);function DN(t,o){let e=O0(t,o);if(yn.has(e))return yn.get(e);let r=0;for(let s=0;s<t.length;s++)r+=(t[s]-o[s])*(t[s]-o[s]);let n=1/(1+Math.sqrt(r));return yn.set(e,n),n}var zt=64,ht=class{constructor(o,e,r=!0){this.isDestroyed=!1;this.autoHide=!0;this.isMobile=!1;this.seenFrames=0;this.isCanvasSizeSet=!1;this.frames=new Map;this.histograms=new Map;this.video=o,this.fps=e,this.autoHide=r,this.createCanvas(),this.createTransformCanvas()}createTransformCanvas(){this.transformCanvas=document.createElement("canvas"),this.transformCanvasCtx=this.canvas.getContext("2d",{willReadFrequently:!0,alpha:!1}),this.transformCanvas.width=zt,this.transformCanvas.height=zt}normalizeImage(o){return this.transformCanvasCtx.drawImage(o,0,0,o.width,o.height,0,0,zt,zt),this.transformCanvasCtx.getImageData(0,0,zt,zt)}toHistogram(o){return this.imageHistogram(this.normalizeImage(o))}imageHistogram(o){return kN(o)}start(){this.addRequestFrameCallback()}destroy(){this.isDestroyed=!0,this.frames.forEach(o=>o.close()),this.frames.clear()}tick(o,e){if(this.setCanvasSize(),e.expectedDisplayTime-performance.now()>10&&console.log("looks like frame is not yet rendered"),this.isDestroyed)return!1;if(this.seenFrames>=this.totalFrames){if(this.autoHide)try{this.video.paused||this.video.pause(),this.video.style.display="none"}catch(a){}return!1}if(this.video.videoWidth===0||this.video.videoHeight===0)return!0;let n=this.video,s=this.frameNumberFromTime(e.mediaTime);if(!Math.max(1,e.presentedFrames>this.totalFrames?e.presentedFrames%this.totalFrames:e.presentedFrames))throw new Error("expectedFrame is 0");if(this.hasFrame(s))this.seenFrames++;else{this.ctx.drawImage(n,0,0,this.width,this.height,0,0,this.width,this.height);let a=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);createImageBitmap(a,0,0,this.width,this.height).then(l=>O(this,null,function*(){this.setFrame(s,l),this.isMobile||this.setHistogram(s,this.toHistogram(l))}))}return!0}addRequestFrameCallback(){this.isDestroyed||this.video.requestVideoFrameCallback((o,e)=>{this.tick(o,e)&&this.addRequestFrameCallback()})}createCanvas(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0,alpha:!1})}setCanvasSize(){this.isCanvasSizeSet||(this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.isCanvasSizeSet=!0)}get width(){return this.video.videoWidth}get height(){return this.video.videoHeight}hasFrame(o){return this.frames.has(o)}getFrame(o){return this.frames.has(o)?this.frames.get(o):null}getFrameNumberBySignature(o,e){if(!o)return e;let r=0,n=e;return[e-3,e-2,e-1,e,e+1,e+2,e+3].filter(c=>c>0&&c<=this.totalFrames).forEach(c=>{let a=this.getHistogram(c);if(a){let l=DN(o,a);l>r&&(r=l,n=c)}}),n}setFrame(o,e){this.frames.set(o,e)}setHistogram(o,e){this.histograms.set(o,e)}getHistogram(o){var e;return(e=this.histograms.get(o))!=null?e:null}get totalFrames(){return Math.round(this.video.duration*this.fps)}frameNumberFromTime(o){return Math.max(1,Math.round(o*this.fps))}};var _0=window.devicePixelRatio||1,RN=25,Ge=class extends hr{constructor(e){super();this.referenceVideoFrameBuffer=null;this.videoFrameBuffer=null;this.isMouseDown=!1;this.buttons=[];this.plugins=[];this.annotatedFrameCoordinates=[];this.fps=RN;this.plannedFn=null;this.ct=0;this.isCanvasInitialized=!1;this.enforcedCanvasSize=null;this.lastNavigatedFrame=0;this.isProgressBarNavigation=!1;this.isAnnotationsAsVideoActive=!1;this.plugins=FN.map(r=>new r(this)),this.init(e)}prevFrame(){let e=this.playbackFrame,r=Math.max(1,e-1);r===this.playbackFrame?this.playbackFrame=this.totalFrames-1:this.playbackFrame=r}nextFrame(){let e=this.playbackFrame,r=Math.min(this.totalFrames,e+1);r===this.totalFrames?this.playbackFrame=1:this.playbackFrame=r}addGlobalShape(e){this.globalShapes.push(e)}get selectedColor(){return this.colorPicker.value}get selectedStrokeSize(){return this.strokeSizePicker.valueAsNumber}get currentTool(){return this._currentTool}set currentTool(e){let r=this._currentTool;r&&(this.getButtonForTool(r).classList.remove("active"),this.pluginForTool(r).onDeactivate()),this._currentTool=e,this.canvas.style.cursor=e?"pointer":"default",e&&(this.getButtonForTool(e).classList.add("active"),this.pluginForTool(e).onActivate())}enableFrameRateDetection(){if(this.destructors.find(n=>n.name==="frameRateDetector"))return;let e=this.videoElement;if(e.tagName==="IMG")return;let r=ON(e,n=>{this.fps=n});Object.defineProperty(r,"name",{value:"frameRateDetector"}),this.destructors.push(r)}timeToFrame(e){return Math.max(1,Math.round(e*this.fps))}get playbackFrame(){return this.videoElement instanceof HTMLImageElement?1:this.timeToFrame(this.videoElement.currentTime)}set playbackFrame(e){if(this.videoElement instanceof HTMLImageElement)return;let r=e/this.fps;this.videoElement.currentTime=r,this.rvf(()=>{this.show()})}rvf(e){this.plannedFn=e}get canvasWidth(){var e,r;return(r=(e=this.enforcedCanvasSize)==null?void 0:e.width)!=null?r:0}get canvasHeight(){var e,r;return(r=(e=this.enforcedCanvasSize)==null?void 0:e.height)!=null?r:0}get aspectRatio(){return this.canvasWidth/this.canvasHeight}get isMobile(){return window.innerWidth<960}get progressBarCoordinates(){let e=this.isMobile?30:10,r=5,n=55,s=this.canvasWidth-r-n,c=r,a=this.canvasHeight-e;return{x:c,y:a,width:s,height:e}}get shapes(){return this.timeStack.has(this.activeTimeFrame)||this.timeStack.set(this.activeTimeFrame,[]),this.timeStack.get(this.activeTimeFrame)}set shapes(e){this.timeStack.set(this.activeTimeFrame,e)}get undoStack(){return this.undoTimeStack.has(this.activeTimeFrame)||this.undoTimeStack.set(this.activeTimeFrame,[]),this.undoTimeStack.get(this.activeTimeFrame)}set undoStack(e){this.undoTimeStack.set(this.activeTimeFrame,e)}get pixelRatio(){return _0}setVideoUrl(n){return O(this,arguments,function*(e,r=this.fps){if(this.videoElement instanceof HTMLImageElement)return;let s=this.videoElement;s.src=e,yield this.videoElement.load(),this.setFrameRate(r),this.videoFrameBuffer&&(this.videoFrameBuffer.destroy(),this.videoFrameBuffer=new ht(s,r,!1),this.videoFrameBuffer.isMobile=this.isMobile),this.setCanvasSize()})}enableVideoFrameBuffer(){this.videoElement instanceof HTMLImageElement||(this.videoFrameBuffer=new ht(this.videoElement,this.fps,!1),this.videoFrameBuffer.isMobile=this.isMobile)}hide(){this.stopAnnotationsAsVideo(),this.hideControls(),this.hideCanvas()}showControls(){this.uiContainer.style.display="block"}hideControls(){this.uiContainer.style.display="none"}showCanvas(){this.canvas.style.display="block"}hideCanvas(){this.canvas.style.display="none"}updateActiveTimeFrame(e=void 0){this.activeTimeFrame=e?this.timeToFrame(e):this.playbackFrame}show(){this.stopAnnotationsAsVideo(),this.updateActiveTimeFrame(),this.showCanvas(),this.showControls(),this.redrawFullCanvas()}setCanvasSettings(){this.ctx.strokeStyle=this.selectedColor,this.ctx.fillStyle=this.selectedColor,this.ctx.lineWidth=this.selectedStrokeSize}pluginForTool(e){if(this.isDestroyed)throw new Error("AnnotationTool is destroyed");let r=this.plugins.find(n=>n.name===e);if(!r)throw new Error(`No plugin found for tool ${e}`);return r}getButtonForTool(e){return this.buttons.find(r=>r.dataset.tool===e)}bindContext(){this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.setCanvasSize=this.setCanvasSize.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}initProperties(){this.isDestroyed=!1,this.isProgressBarNavigation=!1,this.shapes=[],this.globalShapes=[],this.currentTool=this.isMobile?null:"curve"}setVideoStyles(){this.videoElement.style.objectFit="cover",this.videoElement.style.objectPosition="left top"}get frameCallbackSupported(){return"requestVideoFrameCallback"in HTMLVideoElement.prototype}initFrameCounter(){if(!this.frameCallbackSupported){setTimeout(()=>{var e;(e=this.plannedFn)==null||e.call(this),this.plannedFn=null,this.initFrameCounter(),this.updateActiveTimeFrame(),this.playAnnotationsAsVideo()},1e3/this.fps);return}this.withVideo(e=>{e.requestVideoFrameCallback((r,n)=>{var s,c;this.isCanvasInitialized||this._setCanvasSize(),(s=this.videoFrameBuffer)==null||s.tick(r,n),(c=this.plannedFn)==null||c.call(this),this.plannedFn=null,this.raf(()=>{this.initFrameCounter(),this.updateActiveTimeFrame(n.mediaTime),this.playAnnotationsAsVideo()})})})}init(e){this.videoElement=e,this.setVideoStyles(),this.initFrameCounter(),this.bindContext(),this.initCanvas(),this.initUI(),this.initProperties(),this.setCanvasSize()}onKeyDown(e){(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="z"&&this.handleUndo()}removeLastShape(){this.shapes.pop(),this.redrawFullCanvas()}handleUndo(){this.undoStack.length>0&&(this.shapes=this.undoStack.pop(),this.redrawFullCanvas())}destroy(){var s,c,a,l,u,d,p,m;if(this.isDestroyed)return;super.destroy(),this.stopAnnotationsAsVideo(),this._currentTool=null,this.plugins.forEach(h=>h.reset()),this.annotatedFrameCoordinates=[],this.setFrameRate(RN);let e=this.strokeSizePicker.parentElement;if((s=e==null?void 0:e.parentNode)==null||s.removeChild(e),this.referenceVideoElement){let h=this.referenceVideoElement.parentElement;(c=h==null?void 0:h.parentNode)==null||c.removeChild(h),this.referenceVideoElement=null}let r=this.colorPicker.parentElement;(a=r==null?void 0:r.parentNode)==null||a.removeChild(r),this.buttons.forEach(h=>{var v;(v=h.parentNode)==null||v.removeChild(h)}),this.buttons=[],(l=this.uiContainer.parentNode)==null||l.removeChild(this.uiContainer),(u=this.canvas.parentNode)==null||u.removeChild(this.canvas),(d=this.playerControlsContainer.parentElement)==null||d.removeChild(this.playerControlsContainer),["strokeSizePicker","colorPicker","uiContainer","playerControlsContainer","canvas","ctx","videoElement"].forEach(h=>{delete this[h]}),this.activeTimeFrame=0,this.isDestroyed=!0,(p=this.referenceVideoFrameBuffer)==null||p.destroy(),this.referenceVideoFrameBuffer=null,(m=this.videoFrameBuffer)==null||m.destroy(),this.videoFrameBuffer=null}_setCanvasSize(){let e=getComputedStyle(this.videoElement),r=parseInt(e.width,10),n=this.videoElement,s=n.videoWidth/n.videoHeight;if(isNaN(r)||!n.videoWidth||!n.videoHeight)return this.isCanvasInitialized=!1,this.setCanvasSettings(),!1;let c=Math.min(r,n.videoWidth),a=Math.floor(c/s);return n.style.width=`${c}px`,n.style.height=`${a}px`,this.isCanvasInitialized=n.videoWidth>0&&n.videoHeight>0,this.canvas.width=c*this.pixelRatio,this.canvas.height=a*this.pixelRatio,this.canvas.style.width=`${c}px`,this.canvas.style.height=`${a}px`,this.enforcedCanvasSize={width:c,height:a},this.ctx.scale(this.pixelRatio,this.pixelRatio),this.setCanvasSettings(),!0}setCanvasSize(){this._setCanvasSize()&&(this.syncVideoSizes(),this.redrawFullCanvas())}addShape(e){let r=this.serialize([e])[0];this.undoStack.push([...this.shapes]),this.shapes.push(r)}get msPerFrame(){return this.fps/1e3}syncVideoSizes(){this.withRefVideo(e=>{let n=this.videoElement.getBoundingClientRect();e.style.position="fixed",e.style.top=`${n.top}px`,e.style.left=`${n.left}px`})}addReferenceVideoByURL(s){return O(this,arguments,function*(e,r=this.fps,n="video/mp4"){var u;let c=yield fetch(e).then(d=>d.blob()),a=new Blob([c],{type:n}),l=window.URL.createObjectURL(a);this.referenceVideoElement?((u=this.referenceVideoFrameBuffer)==null||u.destroy(),this.referenceVideoFrameBuffer=new ht(this.referenceVideoElement,r),this.referenceVideoFrameBuffer.isMobile=this.isMobile,this.referenceVideoFrameBuffer.start()):(this.referenceVideoElement=document.createElement("video"),this.withRefVideo(d=>{this.isMobile?(d.style.zIndex="2",d.style.display="block",d.style.top="0",d.style.left="0",d.style.opacity="0.25",d.style.width="20px",d.style.height="15px"):(d.style.zIndex="-1",d.style.display="none",d.style.width="100px",d.style.height="70px"),d.style.objectFit="cover",d.style.objectPosition="left top",d.muted=!0,d.volume=0,d.playsInline=!0,d.autoplay=!1,d.controls=!1,d.loop=!0,this.videoElement.after(d),this.referenceVideoFrameBuffer=new ht(d,r),this.referenceVideoFrameBuffer.isMobile=this.isMobile,this.referenceVideoFrameBuffer.start()}),this.syncVideoSizes()),this.referenceVideoElement.src=l,this.referenceVideoElement.play().then(()=>{this.showButton("compare")}).catch(()=>{this.hideButton("compare")})})}hideButton(e){let r=this.getButtonForTool(e);r.style.display="none"}showButton(e){let r=this.getButtonForTool(e);r.style.display=""}addSingletonShape(e){let r=this.serialize([e])[0],n=this.shapes.filter(s=>s.type!==e.type);this.replaceFrame(this.playbackFrame,[...n,r])}serialize(e=this.shapes){let r=this.canvasWidth,n=this.canvasHeight;return e.map(s=>this.pluginForTool(s.type).normalize(s,r,n))}deserialize(e){let r=1/this.canvasWidth,n=1/this.canvasHeight;return e.map(s=>this.pluginForTool(s.type).normalize(s,r,n))}getRelativeCoords(e){let r=this.canvas.getBoundingClientRect();return{x:this.getEventX(e)-r.left,y:this.getEventY(e)-r.top}}handleMouseDown(e){if(e.preventDefault(),this.isMouseDown=!0,mr(e))return;let r=this.frameFromProgressBar(e,!0);if(r){this.isProgressBarNavigation=!0;let n=this.getAnnotationFrame(e);this.isVideoPaused&&(n!==null?this.playbackFrame=n:this.playbackFrame=r);return}this.currentTool&&this.pluginForTool(this.currentTool).onPointerDown(e)}get isDrawing(){return this.currentTool?this.pluginForTool(this.currentTool).isDrawing:!1}get isVideoPaused(){return this.videoElement.tagName==="VIDEO"?this.videoElement.paused:!0}get hasGlobalOverlays(){return this.globalShapes.length>0}handleMouseMove(e){if(e.preventDefault(),!mr(e)){if(this.isMouseDown){let r=this.isProgressBarNavigation?this.frameFromProgressBar(e,!1):null;if(r!==null&&!this.isDrawing){if(r===this.lastNavigatedFrame)return;this.lastNavigatedFrame=r,this.isVideoPaused&&(this.playbackFrame=r);return}else this.hideControls(),this.clearCanvas(),this.hasGlobalOverlays||this.addVideoOverlay(),this.drawShapesOverlay()}else this.redrawFullCanvas();this.currentTool&&this.pluginForTool(this.currentTool).onPointerMove(e)}}getEventX(e){return e.clientX}getEventY(e){return e.clientY}handleMouseUp(e){this.isMouseDown=!1,this.isProgressBarNavigation=!1,this.showControls(),!mr(e)&&(this.currentTool&&this.pluginForTool(this.currentTool).onPointerUp(e),this.redrawFullCanvas())}focusOnMediaNode(){this.videoElement.focus()}drawShapesOverlay(){let e={strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth};for(let r of this.deserialize(this.globalShapes)){this.ctx.strokeStyle=r.strokeStyle,this.ctx.fillStyle=r.fillStyle,this.ctx.lineWidth=r.lineWidth;try{this.pluginForTool(r.type).draw(r)}catch(n){console.error(n)}}for(let r of this.deserialize(this.shapes)){this.ctx.strokeStyle=r.strokeStyle,this.ctx.fillStyle=r.fillStyle,this.ctx.lineWidth=r.lineWidth;try{this.pluginForTool(r.type).draw(r)}catch(n){console.error(n)}}this.ctx.strokeStyle=e.strokeStyle,this.ctx.fillStyle=e.fillStyle,this.ctx.lineWidth=e.lineWidth}clearCanvas(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)}frameToDataUrl(){try{this.clearCanvas(),this.addVideoOverlay(),this.addFrameSquareOverlay(),this.drawShapesOverlay();let e=this.canvas.toDataURL("image/png");return this.redrawFullCanvas(),e}catch(e){return console.error(e),null}}redrawFullCanvas(){this.hasGlobalOverlays||(this.clearCanvas(),this.addVideoOverlay()),this.drawShapesOverlay(),this.addFrameSquareOverlay(),this.addProgressBarOverlay()}replaceFrame(e,r){this.timeStack.set(e,this.parseShapes(this.stringifyShapes(r)))}addShapesToFrame(e,r){let n=this.timeStack.get(e)||[];this.timeStack.set(e,[...n,...this.parseShapes(this.stringifyShapes(r))])}setFrameRate(e){var r;(r=this.destructors.find(n=>n.name==="frameRateDetector"))==null||r(),this.fps=e}stringifyShapes(e){return JSON.stringify(e,(r,n)=>r==="image"?n.src:n)}parseShapes(e){return JSON.parse(e,(r,n)=>{if(r==="image"){let s=new Image;return s.src=n,s}return n})}filterNonSerializableShapes(e){return e.filter(r=>r.type!=="image")}saveCurrentFrame(){return{frame:this.playbackFrame,version:1,fps:this.fps,shapes:this.parseShapes(this.stringifyShapes(this.filterNonSerializableShapes(this.shapes)))}}loadAllFrames(e){this.cleanFrameStacks(),e.forEach(r=>{this.timeStack.set(r.frame,r.shapes)})}appendFrames(e){e.forEach(r=>{this.addShapesToFrame(r.frame,r.shapes)})}saveAllFrames(){return Array.from(this.timeStack.keys()).filter(s=>{var c;return(c=this.timeStack.get(s))==null?void 0:c.length}).map(s=>{var c;return{frame:s,fps:this.fps,version:1,shapes:this.filterNonSerializableShapes((c=this.timeStack.get(s))!=null?c:[])}})}getAnnotationFrame(e){var a,l;let r=e.offsetX,n=e.offsetY,s=this.isMobile?10:5;return(l=(a=this.annotatedFrameCoordinates.find(u=>r>=u.x-s&&r<=u.x+s&&n>=u.y-s&&n<=u.y+s))==null?void 0:a.frame)!=null?l:null}get totalFrames(){let e=this.videoElement;return e.tagName!=="VIDEO"?1:Math.ceil(e.duration*this.fps)}frameFromProgressBar(e,r=!0){let n=this.videoElement;if(n.tagName!=="VIDEO")return null;let{x:s,width:c,height:a,y:l}=this.progressBarCoordinates,u=e.offsetX,d=e.offsetY;return r?u>=s&&u<=s+c&&d>=l&&d<=l+a?Math.ceil((u-s)/c*(n.duration*this.fps)):null:u>=s&&u<=s+c?Math.ceil((u-s)/c*(n.duration*this.fps)):null}hasAnnotationsForFrame(e){if(this.globalShapes.length>0)return!0;if(this.timeStack.has(e)){let r=this.timeStack.get(e);return r&&r.length>0}return!1}stopAnnotationsAsVideo(){this.isAnnotationsAsVideoActive=!1}startAnnotationsAsVideo(){this.isAnnotationsAsVideoActive=!0,this.playAnnotationsAsVideo()}playAnnotationsAsVideo(){this.isAnnotationsAsVideoActive&&(this.hasGlobalOverlays||this.clearCanvas(),this.isMobile?this.hasGlobalOverlays||this.addVideoOverlay():this.addVideoOverlay(),this.drawShapesOverlay(),this.addFrameSquareOverlay(),this.addProgressBarOverlay())}};function LN(t=this.activeTimeFrame){this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)";let o=50,e=30,r=20;this.ctx.fillRect(this.canvasWidth-o,this.canvasHeight-e,o,e),this.ctx.fillStyle="white",this.ctx.font=`${r}px sans-serif`,this.ctx.fillText(`${t}`.padStart(3,"0"),this.canvasWidth-40,this.canvasHeight-7),this.ctx.restore()}function BN(){var s,c,a;let t=this.videoElement;if(t.tagName!=="VIDEO")return;let o=(s=this.videoFrameBuffer)==null?void 0:s.frameNumberFromTime(t.currentTime),e=(a=(c=this.videoFrameBuffer)==null?void 0:c.getFrame(o||0))!=null?a:t,r=e?e.width:t.videoWidth,n=e?e.height:t.videoHeight;this.ctx.drawImage(e,0,0,r,n,0,0,this.canvasWidth,this.canvasHeight)}function VN(){let t=this.videoElement;if(t.tagName!=="VIDEO")return;this.annotatedFrameCoordinates=[];let e=Array.from(this.timeStack.keys()).filter(v=>{var x;return(x=this.timeStack.get(v))==null?void 0:x.length}),r=t.duration*this.fps,{x:n,width:s,height:c,y:a}=this.progressBarCoordinates,l=e.map(v=>Math.ceil(v/r*s));this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(n,a,s,c),this.ctx.fillStyle="#F3CE32";let u=this.isMobile?16:8;l.forEach((v,x)=>{this.ctx.beginPath();let f=n+v,g=this.canvasHeight-c/2;this.ctx.fillRect(f-u/2,g-u/2,u,u),this.annotatedFrameCoordinates.push({x:f,y:g,frame:e[x]})});let d=this.playbackFrame,p=Math.ceil(d/r*s)+n;this.ctx.fillStyle="white",this.ctx.beginPath();let m=p,h=this.canvasHeight-c/2;this.ctx.beginPath(),this.ctx.fillRect(m-u/2,h-u/2,u,u),this.ctx.fill(),this.ctx.restore()}Ge.prototype.initUI=Rn;Ge.prototype.initCanvas=Ln;Ge.prototype.addFrameSquareOverlay=LN;Ge.prototype.addVideoOverlay=BN;Ge.prototype.addProgressBarOverlay=VN;new EventSource("/esbuild").addEventListener("change",()=>location.reload());var Ne=document.querySelector("video");function WN(){return O(this,null,function*(){let t=window.getComputedStyle(Ne),o=parseFloat(t.width),e=parseFloat(t.height),r=window.innerHeight-80;if(e>r){let x=o/e,f=r,g=f*x;Ne.style.width=`${g}px`,Ne.style.height=`${f}px`}let n=yield fetch(Ne.currentSrc).then(x=>x.blob()),s=new Promise(x=>{setTimeout(()=>{x(!0)},250),Ne.addEventListener("loadeddata",()=>{x(!0)},{once:!0})}),c=yield fetch("./frame_29.png").then(x=>O(this,null,function*(){let f=yield x.blob(),g=new Blob([f],{type:"image/png"}),S=new Image,A=new Promise(M=>{S.addEventListener("load",()=>{M(!0)},{once:!0})});return S.src=window.URL.createObjectURL(g),yield A,S}));Ne.paused||Ne.pause();let a=new Blob([n],{type:"video/mp4"}),l=new Blob([n],{type:"video/mp4"});Ne.src=window.URL.createObjectURL(a),yield s;let u=new Ge(Ne);u.setVideoBlob(l),u.setFrameRate(30),yield u.addReferenceVideoByURL("./mov_bbb_g.mp4"),requestAnimationFrame(()=>{u.setCanvasSize()}),u.enableVideoFrameBuffer(),console.log({tool:u}),u.addShapesToFrame(29,[{type:"image",image:c,x:0,y:0,width:1,height:1,strokeStyle:"red",lineWidth:2,fillStyle:"red"}]),Ne.paused||Ne.pause(),setInterval(()=>{u.destroy(),u.init(Ne)},1e8),setInterval(()=>{console.log(u.saveAllFrames())},1e5);let d=document.getElementById("file"),p=document.getElementById("download"),m=document.getElementById("sample"),h=document.getElementById("video"),v=document.getElementById("ref-video");h.addEventListener("change",x=>O(this,null,function*(){if(!h.files||h.files.length===0)return;let f=prompt("Enter FPS","30");if(!f)return;let g=h.files[0],S=new Blob([g],{type:g.type}),A=window.URL.createObjectURL(S);yield u.setVideoUrl(A,parseInt(f,10))})),v.addEventListener("change",x=>O(this,null,function*(){if(!v.files||v.files.length===0)return;let f=prompt("Enter FPS","30");if(!f)return;let g=v.files[0],S=new Blob([g],{type:g.type}),A=window.URL.createObjectURL(S);yield u.addReferenceVideoByURL(A,parseInt(f,10),g.type)})),m.addEventListener("click",x=>{x.stopPropagation(),x.preventDefault(),fetch("./annotations-sample.json").then(f=>f.json()).then(f=>{u.loadAllFrames(f),u.redrawFullCanvas()})}),d.addEventListener("change",x=>{if(!d.files||d.files.length===0)return;let f=d.files[0],g=new FileReader;g.onload=S=>{if(!S.target)return;let A=S.target.result,M=JSON.parse(A);confirm("Append to existing annotations?")?u.appendFrames(M):u.loadAllFrames(M),u.redrawFullCanvas()},g.readAsText(f)}),p.addEventListener("click",x=>{x.stopPropagation(),x.preventDefault();let f=u.saveAllFrames(),g=document.createElement("a");g.href=URL.createObjectURL(new Blob([JSON.stringify(f)],{type:"application/json"}));let S=new Date().toISOString().replace(/:/g,"-");g.download=`annotations-${S}.json`,g.click()})})}Ne.readyState===0?Ne.addEventListener("loadedmetadata",()=>{requestAnimationFrame(()=>{WN()})},{once:!0}):WN();})();
