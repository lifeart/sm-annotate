var Hw=Object.create;var ur=Object.defineProperty,zw=Object.defineProperties,Gw=Object.getOwnPropertyDescriptor,Uw=Object.getOwnPropertyDescriptors,qw=Object.getOwnPropertyNames,lr=Object.getOwnPropertySymbols,jw=Object.getPrototypeOf,so=Object.prototype.hasOwnProperty,Nn=Object.prototype.propertyIsEnumerable;var pr=Math.pow,Cn=(t,o,e)=>o in t?ur(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,w=(t,o)=>{for(var e in o||(o={}))so.call(o,e)&&Cn(t,e,o[e]);if(lr)for(var e of lr(o))Nn.call(o,e)&&Cn(t,e,o[e]);return t},F=(t,o)=>zw(t,Uw(o));var Ze=(t,o)=>{var e={};for(var r in t)so.call(t,r)&&o.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&lr)for(var r of lr(t))o.indexOf(r)<0&&Nn.call(t,r)&&(e[r]=t[r]);return e};var n=(t,o)=>()=>(t&&(o=t(t=0)),o);var Xw=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports),Yw=(t,o)=>{for(var e in o)ur(t,e,{get:o[e],enumerable:!0})},Zw=(t,o,e,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of qw(o))!so.call(t,i)&&i!==e&&ur(t,i,{get:()=>o[i],enumerable:!(r=Gw(o,i))||r.enumerable});return t};var Kw=(t,o,e)=>(e=t!=null?Hw(jw(t)):{},Zw(o||!t||!t.__esModule?ur(e,"default",{value:t,enumerable:!0}):e,t));var D=(t,o,e)=>new Promise((r,i)=>{var s=l=>{try{a(e.next(l))}catch(u){i(u)}},c=l=>{try{a(e.throw(l))}catch(u){i(u)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,c);a((e=e.apply(t,o)).next())});var ao,Bn=n(()=>{ao=(t,o,e)=>({endTime:o,insertTime:e,type:"exponentialRampToValue",value:t})});var co,Ln=n(()=>{co=(t,o,e)=>({endTime:o,insertTime:e,type:"linearRampToValue",value:t})});var vt,lo=n(()=>{vt=(t,o)=>({startTime:o,type:"setValue",value:t})});var Xt,uo=n(()=>{Xt=(t,o,e)=>({duration:e,startTime:o,type:"setValueCurve",values:t})});var Er,po=n(()=>{Er=(t,o,{startTime:e,target:r,timeConstant:i})=>r+(o-r)*Math.exp((e-t)/i)});var Ge,Ir=n(()=>{Ge=t=>t.type==="exponentialRampToValue"});var nt,br=n(()=>{nt=t=>t.type==="linearRampToValue"});var Me,Mr=n(()=>{Ir();br();Me=t=>Ge(t)||nt(t)});var gt,Pr=n(()=>{gt=t=>t.type==="setValue"});var Ae,Fr=n(()=>{Ae=t=>t.type==="setValueCurve"});var yt,mo=n(()=>{po();Mr();Pr();Fr();yt=(t,o,e,r)=>{let i=t[o];return i===void 0?r:Me(i)||gt(i)?i.value:Ae(i)?i.values[i.values.length-1]:Er(e,yt(t,o-1,i.startTime,r),i)}});var ho,Vn=n(()=>{mo();Mr();Pr();Fr();ho=(t,o,e,r,i)=>e===void 0?[r.insertTime,i]:Me(e)?[e.endTime,e.value]:gt(e)?[e.startTime,e.value]:Ae(e)?[e.startTime+e.duration,e.values[e.values.length-1]]:[e.startTime,yt(t,o-1,e.startTime,i)]});var Yt,fo=n(()=>{Yt=t=>t.type==="cancelAndHold"});var Zt,xo=n(()=>{Zt=t=>t.type==="cancelScheduledValues"});var Ue,Wn=n(()=>{fo();xo();Ir();br();Ue=t=>Yt(t)||Zt(t)?t.cancelTime:Ge(t)||nt(t)?t.endTime:t.startTime});var vo,Hn=n(()=>{vo=(t,o,e,{endTime:r,value:i})=>e===i?i:0<e&&0<i||e<0&&i<0?e*pr(i/e,(t-o)/(r-o)):0});var go,zn=n(()=>{go=(t,o,e,{endTime:r,value:i})=>e+(t-o)/(r-o)*(i-e)});var Gn,Un=n(()=>{Gn=(t,o)=>{let e=Math.floor(o),r=Math.ceil(o);return e===r?t[e]:(1-(o-e))*t[e]+(1-(r-o))*t[r]}});var qn,jn=n(()=>{Un();qn=(t,{duration:o,startTime:e,values:r})=>{let i=(t-e)/o*(r.length-1);return Gn(r,i)}});var Kt,Xn=n(()=>{Kt=t=>t.type==="setTarget"});var $t,Yn=n(()=>{Bn();Ln();lo();uo();Vn();Wn();Hn();zn();po();jn();mo();Mr();fo();xo();Ir();br();Xn();Pr();Fr();$t=class{constructor(o){this._automationEvents=[],this._currenTime=0,this._defaultValue=o}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(o){let e=Ue(o);if(Yt(o)||Zt(o)){let r=this._automationEvents.findIndex(s=>Zt(o)&&Ae(s)?s.startTime+s.duration>=e:Ue(s)>=e),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Yt(o)){let s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Me(i)){if(s!==void 0&&Kt(s))throw new Error("The internal list is malformed.");let c=s===void 0?i.insertTime:Ae(s)?s.startTime+s.duration:Ue(s),a=s===void 0?this._defaultValue:Ae(s)?s.values[s.values.length-1]:s.value,l=Ge(i)?vo(e,c,a,i):go(e,c,a,i),u=Ge(i)?ao(l,e,this._currenTime):co(l,e,this._currenTime);this._automationEvents.push(u)}if(s!==void 0&&Kt(s)&&this._automationEvents.push(vt(this.getValue(e),e)),s!==void 0&&Ae(s)&&s.startTime+s.duration>e){let c=e-s.startTime,a=(s.values.length-1)/s.duration,l=Math.max(2,1+Math.ceil(c*a)),u=c/(l-1)*a,p=s.values.slice(0,l);if(u<1)for(let d=1;d<l;d+=1){let m=u*d%1;p[d]=s.values[d-1]*(1-m)+s.values[d]*m}this._automationEvents[this._automationEvents.length-1]=Xt(p,s.startTime,c)}}}else{let r=this._automationEvents.findIndex(c=>Ue(c)>e),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ae(i)&&Ue(i)+i.duration>e)return!1;let s=Ge(o)?ao(o.value,o.endTime,this._currenTime):nt(o)?co(o.value,e,this._currenTime):o;if(r===-1)this._automationEvents.push(s);else{if(Ae(o)&&e+o.duration>Ue(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(o){let e=this._automationEvents.findIndex(r=>Ue(r)>o);if(e>1){let r=this._automationEvents.slice(e-1),i=r[0];Kt(i)&&r.unshift(vt(yt(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(o){if(this._automationEvents.length===0)return this._defaultValue;let e=this._automationEvents.findIndex(c=>Ue(c)>o),r=this._automationEvents[e],i=(e===-1?this._automationEvents.length:e)-1,s=this._automationEvents[i];if(s!==void 0&&Kt(s)&&(r===void 0||!Me(r)||r.insertTime>o))return Er(o,yt(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&gt(s)&&(r===void 0||!Me(r)))return s.value;if(s!==void 0&&Ae(s)&&(r===void 0||!Me(r)||s.startTime+s.duration>o))return o<s.startTime+s.duration?qn(o,s):s.values[s.values.length-1];if(s!==void 0&&Me(s)&&(r===void 0||!Me(r)))return s.value;if(r!==void 0&&Ge(r)){let[c,a]=ho(this._automationEvents,i,s,r,this._defaultValue);return vo(o,c,a,r)}if(r!==void 0&&nt(r)){let[c,a]=ho(this._automationEvents,i,s,r,this._defaultValue);return go(o,c,a,r)}return this._defaultValue}}});var yo,Zn=n(()=>{yo=t=>({cancelTime:t,type:"cancelAndHold"})});var Co,Kn=n(()=>{Co=t=>({cancelTime:t,type:"cancelScheduledValues"})});var No,$n=n(()=>{No=(t,o)=>({endTime:o,type:"exponentialRampToValue",value:t})});var wo,Qn=n(()=>{wo=(t,o)=>({endTime:o,type:"linearRampToValue",value:t})});var So,Jn=n(()=>{So=(t,o,e)=>({startTime:o,target:t,timeConstant:e,type:"setTarget"})});var ei=n(()=>{});var ti=n(()=>{});var ri=n(()=>{});var oi=n(()=>{});var ni=n(()=>{});var ii=n(()=>{});var si=n(()=>{});var ai=n(()=>{});var ci=n(()=>{});var li=n(()=>{ei();ti();ri();oi();ni();ii();si();ai();ci()});var ui=n(()=>{});var pi=n(()=>{});var di=n(()=>{ui();pi()});var To=n(()=>{Yn();Zn();Kn();$n();Qn();Jn();lo();uo();li();di()});var mi,hi=n(()=>{mi=()=>new DOMException("","AbortError")});var fi,xi=n(()=>{fi=t=>(o,e,[r,i,s],c)=>{t(o[i],[e,r,s],a=>a[0]===e&&a[1]===r,c)}});var vi,gi=n(()=>{vi=t=>(o,e,r)=>{let i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);t.set(o,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}});var yi,Ci=n(()=>{yi=t=>(o,e)=>{t.set(o,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}});var Re,Or,Ct,_r,Qt,Nt,kr,Jt,er,tr,fe=n(()=>{Re=new WeakSet,Or=new WeakMap,Ct=new WeakMap,_r=new WeakMap,Qt=new WeakMap,Nt=new WeakMap,kr=new WeakMap,Jt=new WeakMap,er=new WeakMap,tr=new WeakMap});var Ni,wi,Si=n(()=>{Ni={construct(){return Ni}},wi=t=>{try{let o=new Proxy(t,Ni);new o}catch(o){return!1}return!0}});var Ti,Ao,Ai=n(()=>{Ti=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Ao=(t,o)=>{let e=[],r=t.replace(/^[\s]+/,""),i=r.match(Ti);for(;i!==null;){let s=i[1].slice(1,-1),c=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,o).toString());e.push(c),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(Ti)}return[e.join(";"),r]}});var Ei,Ii,bi,Mi=n(()=>{fe();Si();Ai();Ei=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Ii=t=>{if(!wi(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},bi=(t,o,e,r,i,s,c,a,l,u,p,d,m)=>{let h=0;return(f,x,v={credentials:"omit"})=>{let g=p.get(f);if(g!==void 0&&g.has(x))return Promise.resolve();let T=u.get(f);if(T!==void 0){let S=T.get(x);if(S!==void 0)return S}let A=s(f),M=A.audioWorklet===void 0?i(x).then(([S,N])=>{let[y,C]=Ao(S,N),P=`${y};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${C}
})})(window,'_AWGS')`;return e(P)}).then(()=>{let S=m._AWGS.pop();if(S===void 0)throw new SyntaxError;r(A.currentTime,A.sampleRate,()=>S(class{},void 0,(N,y)=>{if(N.trim()==="")throw o();let C=er.get(A);if(C!==void 0){if(C.has(N))throw o();Ii(y),Ei(y.parameterDescriptors),C.set(N,y)}else Ii(y),Ei(y.parameterDescriptors),er.set(A,new Map([[N,y]]))},A.sampleRate,void 0,void 0))}):Promise.all([i(x),Promise.resolve(t(d,d))]).then(([[S,N],y])=>{let C=h+1;h=C;let[P,R]=Ao(S,N),b=`${P};((AudioWorkletProcessor,registerProcessor)=>{${R}
})(${y?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${y?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${y?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${C}',class extends AudioWorkletProcessor{process(){return !1}})`,_=new Blob([b],{type:"application/javascript; charset=utf-8"}),O=URL.createObjectURL(_);return A.audioWorklet.addModule(O,v).then(()=>{if(a(A))return A;let L=c(A);return L.audioWorklet.addModule(O,v).then(()=>L)}).then(L=>{if(l===null)throw new SyntaxError;try{new l(L,`__sac${C}`)}catch(U){throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(O))});return T===void 0?u.set(f,new Map([[x,M]])):T.set(x,M),M.then(()=>{let S=p.get(f);S===void 0?p.set(f,new Set([x])):S.add(x)}).finally(()=>{let S=u.get(f);S!==void 0&&S.delete(x)}),M}}});var pe,Be=n(()=>{pe=(t,o)=>{let e=t.get(o);if(e===void 0)throw new Error("A value with the given key could not be found.");return e}});var Ke,rr=n(()=>{Ke=(t,o)=>{let e=Array.from(t).filter(o);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");let[r]=e;return t.delete(r),r}});var Dr,Eo=n(()=>{Be();rr();Dr=(t,o,e,r)=>{let i=pe(t,o),s=Ke(i,c=>c[0]===e&&c[1]===r);return i.size===0&&t.delete(o),s}});var Le,wt=n(()=>{fe();Be();Le=t=>pe(kr,t)});var Pe,St=n(()=>{fe();wt();Pe=t=>{if(Re.has(t))throw new Error("The AudioNode is already stored.");Re.add(t),Le(t).forEach(o=>o(!0))}});var Rr,Io=n(()=>{Rr=t=>"port"in t});var Ve,Tt=n(()=>{fe();wt();Ve=t=>{if(!Re.has(t))throw new Error("The AudioNode is not stored.");Re.delete(t),Le(t).forEach(o=>o(!1))}});var or,bo=n(()=>{Io();Tt();or=(t,o)=>{!Rr(t)&&o.every(e=>e.size===0)&&Ve(t)}});var Pi,Fi=n(()=>{Eo();St();bo();Pi=(t,o,e,r,i,s,c,a,l,u,p,d,m)=>{let h=new WeakMap;return(f,x,v,g,T)=>{let{activeInputs:A,passiveInputs:M}=s(x),{outputs:S}=s(f),N=a(f),y=C=>{let P=l(x),R=l(f);if(C){let I=Dr(M,f,v,g);t(A,f,I,!1),!T&&!d(f)&&e(R,P,v,g),m(x)&&Pe(x)}else{let I=r(A,f,v,g);o(M,g,I,!1),!T&&!d(f)&&i(R,P,v,g);let E=c(x);if(E===0)p(x)&&or(x,A);else{let B=h.get(x);B!==void 0&&clearTimeout(B),h.set(x,setTimeout(()=>{p(x)&&or(x,A)},E*1e3))}}};return u(S,[x,v,g],C=>C[0]===x&&C[1]===v&&C[2]===g,!0)?(N.add(y),p(f)?t(A,f,[v,g,y],!0):o(M,g,[f,v,y],!0),!0):!1}}});var Oi,_i=n(()=>{Oi=t=>(o,e,[r,i,s],c)=>{let a=o.get(r);a===void 0?o.set(r,new Set([[i,e,s]])):t(a,[i,e,s],l=>l[0]===i&&l[1]===e,c)}});var ki,Di=n(()=>{ki=t=>(o,e)=>{let r=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(r).connect(o.destination);let i=()=>{e.removeEventListener("ended",i),e.disconnect(r),r.disconnect()};e.addEventListener("ended",i)}});var Ri,Bi=n(()=>{Ri=t=>(o,e)=>{t(o).add(e)}});var eS,Li,Vi=n(()=>{eS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Li=(t,o,e,r,i,s)=>class extends t{constructor(a,l){let u=i(a),p=w(w({},eS),l),d=r(u,p),m=s(u)?o():null;super(a,!1,d,m),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){let l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){let l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}}});var Y,ve=n(()=>{Y=(t,o)=>t.context===o});var Wi,Hi=n(()=>{ve();Wi=(t,o,e)=>()=>{let r=new WeakMap,i=(s,c)=>D(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(c,u)}return r.set(c,a),yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):i(s,c)}}}});var At,Mo=n(()=>{At=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch(o){return!1}return!0}});var Ee,Po=n(()=>{Ee=()=>new DOMException("","IndexSizeError")});var Et,Br=n(()=>{Po();Et=t=>{t.getChannelData=(o=>e=>{try{return o.call(t,e)}catch(r){throw r.code===12?Ee():r}})(t.getChannelData)}});var tS,zi,Ui=n(()=>{Mo();Br();tS={numberOfChannels:1},zi=(t,o,e,r,i,s,c,a)=>{let l=null;return class Gi{constructor(p){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:d,numberOfChannels:m,sampleRate:h}=w(w({},tS),p);l===null&&(l=new i(1,1,44100));let f=r!==null&&o(s,s)?new r({length:d,numberOfChannels:m,sampleRate:h}):l.createBuffer(m,d,h);if(f.numberOfChannels===0)throw e();return typeof f.copyFromChannel!="function"?(c(f),Et(f)):o(At,()=>At(f))||a(f),t.add(f),f}static[Symbol.hasInstance](p){return p!==null&&typeof p=="object"&&Object.getPrototypeOf(p)===Gi.prototype||t.has(p)}}}});var ce,ae,$e=n(()=>{ce=-34028234663852886e22,ae=-ce});var Ce,it=n(()=>{fe();Ce=t=>Re.has(t)});var rS,qi,ji=n(()=>{$e();it();St();Tt();rS={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},qi=(t,o,e,r,i,s,c,a)=>class extends t{constructor(u,p){let d=s(u),m=w(w({},rS),p),h=i(d,m),f=c(d),x=f?o():null;super(u,!1,h,x),this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=m.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=e(this,f,h.playbackRate,ae,ce)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){let p=typeof u=="function"?a(this,u):null;this._nativeAudioBufferSourceNode.onended=p;let d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===p?u:d}get playbackRate(){return this._playbackRate}start(u=0,p=0,d){if(this._nativeAudioBufferSourceNode.start(u,p,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[u,p]:[u,p,d]),this.context.state!=="closed"){Pe(this);let m=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",m),Ce(this)&&Ve(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",m)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}}});var Xi,Yi=n(()=>{ve();Xi=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=null,a=null,l=(u,p)=>D(void 0,null,function*(){let d=e(u),m=Y(d,p);if(!m){let h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=o(p,h),c!==null&&d.start(...c),a!==null&&d.stop(a)}return s.set(p,d),m?yield t(p,u.playbackRate,d.playbackRate):yield r(p,u.playbackRate,d.playbackRate),yield i(u,p,d),d});return{set start(u){c=u},set stop(u){a=u},render(u,p){let d=s.get(p);return d!==void 0?Promise.resolve(d):l(u,p)}}}});var Zi,Ki=n(()=>{Zi=t=>"playbackRate"in t});var $i,Qi=n(()=>{$i=t=>"frequency"in t&&"gain"in t});var Ji,es=n(()=>{Ji=t=>"offset"in t});var ts,rs=n(()=>{ts=t=>!("frequency"in t)&&"gain"in t});var os,ns=n(()=>{os=t=>"detune"in t&&"frequency"in t});var is,ss=n(()=>{is=t=>"pan"in t});var me,nr=n(()=>{fe();Be();me=t=>pe(Or,t)});var Qe,Lr=n(()=>{fe();Be();Qe=t=>pe(_r,t)});var Vr,as=n(()=>{Ki();Io();Qi();es();rs();ns();ss();nr();Lr();it();Tt();Vr=(t,o)=>{let{activeInputs:e}=me(t);e.forEach(i=>i.forEach(([s])=>{o.includes(t)||Vr(s,[...o,t])}));let r=Zi(t)?[t.playbackRate]:Rr(t)?Array.from(t.parameters.values()):$i(t)?[t.Q,t.detune,t.frequency,t.gain]:Ji(t)?[t.offset]:ts(t)?[t.gain]:os(t)?[t.detune,t.frequency]:is(t)?[t.pan]:[];for(let i of r){let s=Qe(i);s!==void 0&&s.activeInputs.forEach(([c])=>Vr(c,o))}Ce(t)&&Ve(t)}});var Je,ir=n(()=>{as();Je=t=>{Vr(t.destination,[])}});var Wr,Fo=n(()=>{Wr=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback")});var cs,ls=n(()=>{ir();Fo();cs=(t,o,e,r,i,s,c,a,l)=>class extends t{constructor(p={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(p)}catch(f){throw f.code===12&&f.message==="sampleRate is not in range"?e():f}if(d===null)throw r();if(!Wr(p.latencyHint))throw new TypeError(`The provided value '${p.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(p.sampleRate!==void 0&&d.sampleRate!==p.sampleRate)throw e();super(d,2);let{latencyHint:m}=p,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:m==="balanced"?512/h:m==="interactive"||m===void 0?256/h:m==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(m*h/128)))*128/h,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";let f=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",f)};d.addEventListener("statechange",f)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw o()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Je(this)}))}createMediaElementSource(p){return new i(this,{mediaElement:p})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(p){return new c(this,{mediaStream:p})}createMediaStreamTrackSource(p){return new a(this,{mediaStreamTrack:p})}resume(){return this._state==="suspended"?new Promise((p,d)=>{let m=()=>{this._nativeAudioContext.removeEventListener("statechange",m),this._nativeAudioContext.state==="running"?p():this.resume().then(p,d)};this._nativeAudioContext.addEventListener("statechange",m)}):this._nativeAudioContext.resume().catch(p=>{throw p===void 0||p.code===15?o():p})}suspend(){return this._nativeAudioContext.suspend().catch(p=>{throw p===void 0?o():p})}}});var us,ps=n(()=>{us=(t,o,e,r,i,s,c,a)=>class extends t{constructor(u,p){let d=s(u),m=c(d),h=i(d,p,m),f=m?o(a):null;super(u,!1,h,f),this._isNodeOfNativeOfflineAudioContext=m,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}});var ds,ms=n(()=>{ds=t=>{let o=new WeakMap,e=(r,i)=>D(void 0,null,function*(){let s=i.destination;return o.set(i,s),yield t(r,i,s),s});return{render(r,i){let s=o.get(i);return s!==void 0?Promise.resolve(s):e(r,i)}}}});var hs,fs=n(()=>{$e();hs=(t,o,e,r,i,s,c,a)=>(l,u)=>{let p=u.listener,d=()=>{let S=new Float32Array(1),N=o(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),y=c(u),C=!1,P=[0,0,-1,0,1,0],R=[0,0,0],I=()=>{if(C)return;C=!0;let _=r(u,256,9,0);_.onaudioprocess=({inputBuffer:O})=>{let L=[s(O,S,0),s(O,S,1),s(O,S,2),s(O,S,3),s(O,S,4),s(O,S,5)];L.some((V,H)=>V!==P[H])&&(p.setOrientation(...L),P=L);let U=[s(O,S,6),s(O,S,7),s(O,S,8)];U.some((V,H)=>V!==R[H])&&(p.setPosition(...U),R=U)},N.connect(_)},E=_=>O=>{O!==P[_]&&(P[_]=O,p.setOrientation(...P))},B=_=>O=>{O!==R[_]&&(R[_]=O,p.setPosition(...R))},b=(_,O,L)=>{let U=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:O});U.connect(N,0,_),U.start(),Object.defineProperty(U.offset,"defaultValue",{get(){return O}});let V=t({context:l},y,U.offset,ae,ce);return a(V,"value",H=>()=>H.call(V),H=>q=>{try{H.call(V,q)}catch(Q){if(Q.code!==9)throw Q}I(),y&&L(q)}),V.cancelAndHoldAtTime=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.cancelAndHoldAtTime),V.cancelScheduledValues=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.cancelScheduledValues),V.exponentialRampToValueAtTime=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.exponentialRampToValueAtTime),V.linearRampToValueAtTime=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.linearRampToValueAtTime),V.setTargetAtTime=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.setTargetAtTime),V.setValueAtTime=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.setValueAtTime),V.setValueCurveAtTime=(H=>y?()=>{throw i()}:(...q)=>{let Q=H.apply(V,q);return I(),Q})(V.setValueCurveAtTime),V};return{forwardX:b(0,0,E(0)),forwardY:b(1,0,E(1)),forwardZ:b(2,-1,E(2)),positionX:b(6,0,B(0)),positionY:b(7,0,B(1)),positionZ:b(8,0,B(2)),upX:b(3,0,E(3)),upY:b(4,1,E(4)),upZ:b(5,0,E(5))}},{forwardX:m,forwardY:h,forwardZ:f,positionX:x,positionY:v,positionZ:g,upX:T,upY:A,upZ:M}=p.forwardX===void 0?d():p;return{get forwardX(){return m},get forwardY(){return h},get forwardZ(){return f},get positionX(){return x},get positionY(){return v},get positionZ(){return g},get upX(){return T},get upY(){return A},get upZ(){return M}}}});var st,Hr=n(()=>{st=t=>"context"in t});var et,zr=n(()=>{Hr();et=t=>st(t[0])});var Fe,sr=n(()=>{Fe=(t,o,e,r)=>{for(let i of t)if(e(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(o),!0}});var Oo,xs=n(()=>{sr();Oo=(t,o,[e,r],i)=>{Fe(t,[o,e,r],s=>s[0]===o&&s[1]===e,i)}});var _o,vs=n(()=>{sr();_o=(t,[o,e,r],i)=>{let s=t.get(o);s===void 0?t.set(o,new Set([[e,r]])):Fe(s,[e,r],c=>c[0]===e,i)}});var Ie,at=n(()=>{Ie=t=>"inputs"in t});var It,ko=n(()=>{at();It=(t,o,e,r)=>{if(Ie(o)){let i=o.inputs[r];return t.connect(i,e,0),[i,e,0]}return t.connect(o,e,r),[o,e,r]}});var Do,gs=n(()=>{Do=(t,o,e)=>{for(let r of t)if(r[0]===o&&r[1]===e)return t.delete(r),r;return null}});var ys,Cs=n(()=>{rr();ys=(t,o,e)=>Ke(t,r=>r[0]===o&&r[1]===e)});var Ro,Ns=n(()=>{wt();Ro=(t,o)=>{if(!Le(t).delete(o))throw new Error("Missing the expected event listener.")}});var Bo,ws=n(()=>{Be();rr();Bo=(t,o,e)=>{let r=pe(t,o),i=Ke(r,s=>s[0]===e);return r.size===0&&t.delete(o),i}});var bt,Lo=n(()=>{at();bt=(t,o,e,r)=>{Ie(o)?t.disconnect(o.inputs[r],e,0):t.disconnect(o,e,r)}});var ee,Gr=n(()=>{fe();Be();ee=t=>pe(Ct,t)});var ct,Vo=n(()=>{fe();Be();ct=t=>pe(Qt,t)});var qe,Wo=n(()=>{fe();qe=t=>Jt.has(t)});var Mt,Ho=n(()=>{fe();Mt=t=>!Re.has(t)});var zo,Ss=n(()=>{zo=(t,o)=>new Promise(e=>{if(o!==null)e(!0);else{let r=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),c=s.getChannelData(0);c[0]=1,c[1]=1;let a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=l=>{let u=l.inputBuffer.getChannelData(0);Array.prototype.some.call(u,p=>p===1)?e(!0):e(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}})});var Ur,Ts=n(()=>{Ur=(t,o)=>{let e=new Map;for(let r of t)for(let i of r){let s=e.get(i);e.set(i,s===void 0?1:s+1)}e.forEach((r,i)=>o(i,r))}});var lt,qr=n(()=>{lt=t=>"context"in t});var As,Es=n(()=>{qr();As=t=>{let o=new Map;t.connect=(e=>(r,i=0,s=0)=>{let c=lt(r)?e(r,i,s):e(r,i),a=o.get(r);return a===void 0?o.set(r,[{input:s,output:i}]):a.every(l=>l.input!==s||l.output!==i)&&a.push({input:s,output:i}),c})(t.connect.bind(t)),t.disconnect=(e=>(r,i,s)=>{if(e.apply(t),r===void 0)o.clear();else if(typeof r=="number")for(let[c,a]of o){let l=a.filter(u=>u.output!==r);l.length===0?o.delete(c):o.set(c,l)}else if(o.has(r))if(i===void 0)o.delete(r);else{let c=o.get(r);if(c!==void 0){let a=c.filter(l=>l.output!==i&&(l.input!==s||s===void 0));a.length===0?o.delete(r):o.set(r,a)}}for(let[c,a]of o)a.forEach(l=>{lt(c)?t.connect(c,l.output,l.input):t.connect(c,l.output)})})(t.disconnect)}});var oS,nS,iS,Go,Uo,sS,aS,cS,Is,bs=n(()=>{fe();Hr();zr();xs();vs();ko();gs();Cs();Ns();Eo();ws();Lo();nr();Lr();wt();Gr();Vo();sr();it();Wo();Ho();St();bo();Ss();Ts();Es();oS=(t,o,e,r)=>{let{activeInputs:i,passiveInputs:s}=Qe(o),{outputs:c}=me(t),a=Le(t),l=u=>{let p=ee(t),d=ct(o);if(u){let m=Bo(s,t,e);Oo(i,t,m,!1),!r&&!qe(t)&&p.connect(d,e)}else{let m=ys(i,t,e);_o(s,m,!1),!r&&!qe(t)&&p.disconnect(d,e)}};return Fe(c,[o,e],u=>u[0]===o&&u[1]===e,!0)?(a.add(l),Ce(t)?Oo(i,t,[e,l],!0):_o(s,[t,e,l],!0),!0):!1},nS=(t,o,e,r)=>{let{activeInputs:i,passiveInputs:s}=me(o),c=Do(i[r],t,e);return c===null?[Dr(s,t,e,r)[2],!1]:[c[2],!0]},iS=(t,o,e)=>{let{activeInputs:r,passiveInputs:i}=Qe(o),s=Do(r,t,e);return s===null?[Bo(i,t,e)[1],!1]:[s[2],!0]},Go=(t,o,e,r,i)=>{let[s,c]=nS(t,e,r,i);if(s!==null&&(Ro(t,s),c&&!o&&!qe(t)&&bt(ee(t),ee(e),r,i)),Ce(e)){let{activeInputs:a}=me(e);or(e,a)}},Uo=(t,o,e,r)=>{let[i,s]=iS(t,e,r);i!==null&&(Ro(t,i),s&&!o&&!qe(t)&&ee(t).disconnect(ct(e),r))},sS=(t,o)=>{let e=me(t),r=[];for(let i of e.outputs)et(i)?Go(t,o,...i):Uo(t,o,...i),r.push(i[0]);return e.outputs.clear(),r},aS=(t,o,e)=>{let r=me(t),i=[];for(let s of r.outputs)s[1]===e&&(et(s)?Go(t,o,...s):Uo(t,o,...s),i.push(s[0]),r.outputs.delete(s));return i},cS=(t,o,e,r,i)=>{let s=me(t);return Array.from(s.outputs).filter(c=>c[0]===e&&(r===void 0||c[1]===r)&&(i===void 0||c[2]===i)).map(c=>(et(c)?Go(t,o,...c):Uo(t,o,...c),s.outputs.delete(c),c[0]))},Is=(t,o,e,r,i,s,c,a,l,u,p,d,m,h,f,x)=>class extends u{constructor(g,T,A,M){super(A),this._context=g,this._nativeAudioNode=A;let S=p(g);d(S)&&e(zo,()=>zo(S,x))!==!0&&As(A),Ct.set(this,A),kr.set(this,new Set),g.state!=="closed"&&T&&Pe(this),t(this,M,A)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,T=0,A=0){if(T<0||T>=this._nativeAudioNode.numberOfOutputs)throw i();let M=p(this._context),S=f(M);if(m(g)||h(g))throw s();if(st(g)){let C=ee(g);try{let R=It(this._nativeAudioNode,C,T,A),I=Mt(this);(S||I)&&this._nativeAudioNode.disconnect(...R),this.context.state!=="closed"&&!I&&Mt(g)&&Pe(g)}catch(R){throw R.code===12?s():R}if(o(this,g,T,A,S)){let R=l([this],g);Ur(R,r(S))}return g}let N=ct(g);if(N.name==="playbackRate"&&N.maxValue===1024)throw c();try{this._nativeAudioNode.connect(N,T),(S||Mt(this))&&this._nativeAudioNode.disconnect(N,T)}catch(C){throw C.code===12?s():C}if(oS(this,g,T,S)){let C=l([this],g);Ur(C,r(S))}}disconnect(g,T,A){let M,S=p(this._context),N=f(S);if(g===void 0)M=sS(this,N);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw i();M=aS(this,N,g)}else{if(T!==void 0&&(T<0||T>=this.numberOfOutputs)||st(g)&&A!==void 0&&(A<0||A>=g.numberOfInputs))throw i();if(M=cS(this,N,g,T,A),M.length===0)throw s()}for(let y of M){let C=l([this],y);Ur(C,a)}}}});var Ms,Ps=n(()=>{To();Ms=(t,o,e,r,i,s,c,a,l,u,p,d,m)=>(h,f,x,v=null,g=null)=>{let T=x.value,A=new $t(T),M=f?r(A):null,S={get defaultValue(){return T},get maxValue(){return v===null?x.maxValue:v},get minValue(){return g===null?x.minValue:g},get value(){return x.value},set value(N){x.value=N,S.setValueAtTime(N,h.context.currentTime)},cancelAndHoldAtTime(N){if(typeof x.cancelAndHoldAtTime=="function")M===null&&A.flush(h.context.currentTime),A.add(i(N)),x.cancelAndHoldAtTime(N);else{let y=Array.from(A).pop();M===null&&A.flush(h.context.currentTime),A.add(i(N));let C=Array.from(A).pop();x.cancelScheduledValues(N),y!==C&&C!==void 0&&(C.type==="exponentialRampToValue"?x.exponentialRampToValueAtTime(C.value,C.endTime):C.type==="linearRampToValue"?x.linearRampToValueAtTime(C.value,C.endTime):C.type==="setValue"?x.setValueAtTime(C.value,C.startTime):C.type==="setValueCurve"&&x.setValueCurveAtTime(C.values,C.startTime,C.duration))}return S},cancelScheduledValues(N){return M===null&&A.flush(h.context.currentTime),A.add(s(N)),x.cancelScheduledValues(N),S},exponentialRampToValueAtTime(N,y){if(N===0)throw new RangeError;if(!Number.isFinite(y)||y<0)throw new RangeError;let C=h.context.currentTime;return M===null&&A.flush(C),Array.from(A).length===0&&(A.add(u(T,C)),x.setValueAtTime(T,C)),A.add(c(N,y)),x.exponentialRampToValueAtTime(N,y),S},linearRampToValueAtTime(N,y){let C=h.context.currentTime;return M===null&&A.flush(C),Array.from(A).length===0&&(A.add(u(T,C)),x.setValueAtTime(T,C)),A.add(a(N,y)),x.linearRampToValueAtTime(N,y),S},setTargetAtTime(N,y,C){return M===null&&A.flush(h.context.currentTime),A.add(l(N,y,C)),x.setTargetAtTime(N,y,C),S},setValueAtTime(N,y){return M===null&&A.flush(h.context.currentTime),A.add(u(N,y)),x.setValueAtTime(N,y),S},setValueCurveAtTime(N,y,C){let P=N instanceof Float32Array?N:new Float32Array(N);if(d!==null&&d.name==="webkitAudioContext"){let R=y+C,I=h.context.sampleRate,E=Math.ceil(y*I),B=Math.floor(R*I),b=B-E,_=new Float32Array(b);for(let L=0;L<b;L+=1){let U=(P.length-1)/C*((E+L)/I-y),V=Math.floor(U),H=Math.ceil(U);_[L]=V===H?P[V]:(1-(U-V))*P[V]+(1-(H-U))*P[H]}M===null&&A.flush(h.context.currentTime),A.add(p(_,y,C)),x.setValueCurveAtTime(_,y,C);let O=B/I;O<R&&m(S,_[_.length-1],O),m(S,P[P.length-1],R)}else M===null&&A.flush(h.context.currentTime),A.add(p(P,y,C)),x.setValueCurveAtTime(P,y,C);return S}};return e.set(S,x),o.set(S,h),t(S,M),S}});var Fs,Os=n(()=>{Fs=t=>({replay(o){for(let e of t)if(e.type==="exponentialRampToValue"){let{endTime:r,value:i}=e;o.exponentialRampToValueAtTime(i,r)}else if(e.type==="linearRampToValue"){let{endTime:r,value:i}=e;o.linearRampToValueAtTime(i,r)}else if(e.type==="setTarget"){let{startTime:r,target:i,timeConstant:s}=e;o.setTargetAtTime(i,r,s)}else if(e.type==="setValue"){let{startTime:r,value:i}=e;o.setValueAtTime(i,r)}else if(e.type==="setValueCurve"){let{duration:r,startTime:i,values:s}=e;o.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}})});var Pt,qo=n(()=>{Pt=class{constructor(o){this._map=new Map(o)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(o,e=null){return this._map.forEach((r,i)=>o.call(e,r,i,this))}get(o){return this._map.get(o)}has(o){return this._map.has(o)}keys(){return this._map.keys()}values(){return this._map.values()}}});var lS,_s,ks=n(()=>{fe();qo();lS={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},_s=(t,o,e,r,i,s,c,a,l,u,p,d,m,h)=>class extends o{constructor(x,v,g){var T;let A=a(x),M=l(A),S=p(w(w({},lS),g));m(S);let N=er.get(A),y=N==null?void 0:N.get(v),C=M||A.state!=="closed"?A:(T=c(A))!==null&&T!==void 0?T:A,P=i(C,M?null:x.baseLatency,u,v,y,S),R=M?r(v,S,y):null;super(x,!0,P,R);let I=[];P.parameters.forEach((B,b)=>{let _=e(this,M,B);I.push([b,_])}),this._nativeAudioWorkletNode=P,this._onprocessorerror=null,this._parameters=new Pt(I),M&&t(A,this);let{activeInputs:E}=s(this);d(P,E)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){let v=typeof x=="function"?h(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=v;let g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===v?x:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}});function Ft(t,o,e,r,i){if(typeof t.copyFromChannel=="function")o[e].byteLength===0&&(o[e]=new Float32Array(128)),t.copyFromChannel(o[e],r,i);else{let s=t.getChannelData(r);if(o[e].byteLength===0)o[e]=s.slice(i,i+128);else{let c=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);o[e].set(c)}}}var jo=n(()=>{});var jr,Xo=n(()=>{jr=(t,o,e,r,i)=>{typeof t.copyToChannel=="function"?o[e].byteLength!==0&&t.copyToChannel(o[e],r,i):o[e].byteLength!==0&&t.getChannelData(r).set(o[e],i)}});var Ot,Yo=n(()=>{Ot=(t,o)=>{let e=[];for(let r=0;r<t;r+=1){let i=[],s=typeof o=="number"?o:o[r];for(let c=0;c<s;c+=1)i.push(new Float32Array(128));e.push(i)}return e}});var Ds,Rs=n(()=>{fe();Gr();Be();Ds=(t,o)=>{let e=pe(tr,t),r=ee(o);return pe(e,r)}});var uS,Bs,Ls=n(()=>{jo();Xo();Yo();nr();Rs();ve();uS=(t,o,e,r,i,s,c)=>D(void 0,null,function*(){let a=o===null?Math.ceil(t.context.length/128)*128:o.length,l=r.channelCount*r.numberOfInputs,u=i.reduce((v,g)=>v+g,0),p=u===0?null:e.createBuffer(u,a,e.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");let d=me(t),m=yield Ds(e,t),h=Ot(r.numberOfInputs,r.channelCount),f=Ot(r.numberOfOutputs,i),x=Array.from(t.parameters.keys()).reduce((v,g)=>F(w({},v),{[g]:new Float32Array(128)}),{});for(let v=0;v<a;v+=128){if(r.numberOfInputs>0&&o!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let T=0;T<r.channelCount;T+=1)Ft(o,h[g],T,T,v);s.parameterDescriptors!==void 0&&o!==null&&s.parameterDescriptors.forEach(({name:g},T)=>{Ft(o,x,g,l+T,v)});for(let g=0;g<r.numberOfInputs;g+=1)for(let T=0;T<i[g];T+=1)f[g][T].byteLength===0&&(f[g][T]=new Float32Array(128));try{let g=h.map((A,M)=>d.activeInputs[M].size===0?[]:A),T=c(v/e.sampleRate,e.sampleRate,()=>m.process(g,f,x));if(p!==null)for(let A=0,M=0;A<r.numberOfOutputs;A+=1){for(let S=0;S<i[A];S+=1)jr(p,f[A],S,M+S,v);M+=i[A]}if(!T)break}catch(g){t.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return p}),Bs=(t,o,e,r,i,s,c,a,l,u,p,d,m,h,f,x)=>(v,g,T)=>{let A=new WeakMap,M=null,S=(N,y)=>D(void 0,null,function*(){let C=p(N),P=null,R=Y(C,y),I=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(d===null){let E=I.reduce((O,L)=>O+L,0),B=i(y,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),b=[];for(let O=0;O<N.numberOfOutputs;O+=1)b.push(r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:I[O]}));let _=c(y,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});_.connect=o.bind(null,b),_.disconnect=l.bind(null,b),P=[B,b,_]}else R||(C=new d(y,v));if(A.set(y,P===null?C:P[2]),P!==null){if(M===null){if(T===void 0)throw new Error("Missing the processor constructor.");if(m===null)throw new Error("Missing the native OfflineAudioContext constructor.");let L=N.channelCount*N.numberOfInputs,U=T.parameterDescriptors===void 0?0:T.parameterDescriptors.length,V=L+U;M=uS(N,V===0?null:yield(()=>D(void 0,null,function*(){let q=new m(V,Math.ceil(N.context.length/128)*128,y.sampleRate),Q=[],X=[];for(let J=0;J<g.numberOfInputs;J+=1)Q.push(c(q,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),X.push(i(q,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));let ue=yield Promise.all(Array.from(N.parameters.values()).map(J=>D(void 0,null,function*(){let G=s(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:J.value});return yield h(q,J,G.offset),G}))),we=r(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,L+U)});for(let J=0;J<g.numberOfInputs;J+=1){Q[J].connect(X[J]);for(let G=0;G<g.channelCount;G+=1)X[J].connect(we,G,J*g.channelCount+G)}for(let[J,G]of ue.entries())G.connect(we,0,L+J),G.start(0);return we.connect(q.destination),yield Promise.all(Q.map(J=>f(N,q,J))),x(q)}))(),y,g,I,T,u)}let E=yield M,B=e(y,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[b,_,O]=P;E!==null&&(B.buffer=E,B.start(0)),B.connect(b);for(let L=0,U=0;L<N.numberOfOutputs;L+=1){let V=_[L];for(let H=0;H<I[L];H+=1)b.connect(V,U+H,H);U+=I[L]}return O}if(R)for(let[E,B]of N.parameters.entries())yield t(y,B,C.parameters.get(E));else for(let[E,B]of N.parameters.entries())yield h(y,B,C.parameters.get(E));return yield f(N,y,C),C});return{render(N,y){a(y,N);let C=A.get(y);return C!==void 0?Promise.resolve(C):S(N,y)}}}});var Vs,Ws=n(()=>{Vs=(t,o,e,r,i,s,c,a,l,u,p,d,m,h,f,x,v,g,T,A)=>class extends f{constructor(S,N){super(S,N),this._nativeContext=S,this._audioWorklet=t===void 0?void 0:{addModule:(y,C)=>t(this,y,C)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new o(this)}createBiquadFilter(){return new i(this)}createBuffer(S,N,y){return new e({length:N,numberOfChannels:S,sampleRate:y})}createBufferSource(){return new r(this)}createChannelMerger(S=6){return new s(this,{numberOfInputs:S})}createChannelSplitter(S=6){return new c(this,{numberOfOutputs:S})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(S=1){return new p(this,{maxDelayTime:S})}createDynamicsCompressor(){return new d(this)}createGain(){return new m(this)}createIIRFilter(S,N){return new h(this,{feedback:N,feedforward:S})}createOscillator(){return new x(this)}createPanner(){return new v(this)}createPeriodicWave(S,N,y={disableNormalization:!1}){return new g(this,F(w({},y),{imag:N,real:S}))}createStereoPanner(){return new T(this)}createWaveShaper(){return new A(this)}decodeAudioData(S,N,y){return u(this._nativeContext,S).then(C=>(typeof N=="function"&&N(C),C),C=>{throw typeof y=="function"&&y(C),C})}}});var pS,Hs,zs=n(()=>{$e();pS={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Hs=(t,o,e,r,i,s,c,a)=>class extends t{constructor(u,p){let d=s(u),m=w(w({},pS),p),h=i(d,m),f=c(d),x=f?e():null;super(u,!1,h,x),this._Q=o(this,f,h.Q,ae,ce),this._detune=o(this,f,h.detune,1200*Math.log2(ae),-1200*Math.log2(ae)),this._frequency=o(this,f,h.frequency,u.sampleRate/2,0),this._gain=o(this,f,h.gain,40*Math.log10(ae),ce),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(u){this._nativeBiquadFilterNode.type=u}getFrequencyResponse(u,p,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(u,p,d)}catch(m){throw m.code===11?r():m}if(u.length!==p.length||p.length!==d.length)throw r()}}});var Gs,Us=n(()=>{ve();Gs=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=(a,l)=>D(void 0,null,function*(){let u=e(a),p=Y(u,l);if(!p){let d={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=o(l,d)}return s.set(l,u),p?(yield t(l,a.Q,u.Q),yield t(l,a.detune,u.detune),yield t(l,a.frequency,u.frequency),yield t(l,a.gain,u.gain)):(yield r(l,a.Q,u.Q),yield r(l,a.detune,u.detune),yield r(l,a.frequency,u.frequency),yield r(l,a.gain,u.gain)),yield i(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var qs,js=n(()=>{qs=(t,o)=>(e,r)=>{let i=o.get(e);if(i!==void 0)return i;let s=t.get(e);if(s!==void 0)return s;try{let c=r();return c instanceof Promise?(t.set(e,c),c.catch(()=>!1).then(a=>(t.delete(e),o.set(e,a),a))):(o.set(e,c),c)}catch(c){return o.set(e,!1),!1}}});var dS,Xs,Ys=n(()=>{dS={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Xs=(t,o,e,r,i)=>class extends t{constructor(c,a){let l=r(c),u=w(w({},dS),a),p=e(l,u),d=i(l)?o():null;super(c,!1,p,d)}}});var Zs,Ks=n(()=>{ve();Zs=(t,o,e)=>()=>{let r=new WeakMap,i=(s,c)=>D(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(c,u)}return r.set(c,a),yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):i(s,c)}}}});var mS,$s,Qs=n(()=>{mS={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},$s=(t,o,e,r,i,s)=>class extends t{constructor(a,l){let u=r(a),p=s(w(w({},mS),l)),d=e(u,p),m=i(u)?o():null;super(a,!1,d,m)}}});var Js,ea=n(()=>{ve();Js=(t,o,e)=>()=>{let r=new WeakMap,i=(s,c)=>D(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(c,u)}return r.set(c,a),yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):i(s,c)}}}});var ta,ra=n(()=>{ta=t=>(o,e,r)=>t(e,o,r)});var oa,na=n(()=>{qr();oa=t=>(o,e,r=0,i=0)=>{let s=o[r];if(s===void 0)throw t();return lt(e)?s.connect(e,0,i):s.connect(e,0)}});var ia,sa=n(()=>{ia=t=>(o,e)=>{let r=t(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=o.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(e),r.start(),()=>{r.stop(),r.disconnect(e)}}});var hS,aa,ca=n(()=>{$e();it();St();Tt();hS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},aa=(t,o,e,r,i,s,c)=>class extends t{constructor(l,u){let p=i(l),d=w(w({},hS),u),m=r(p,d),h=s(p),f=h?e():null;super(l,!1,m,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=m,this._offset=o(this,h,m.offset,ae,ce),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){let u=typeof l=="function"?c(this,l):null;this._nativeConstantSourceNode.onended=u;let p=this._nativeConstantSourceNode.onended;this._onended=p!==null&&p===u?l:p}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Pe(this);let u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),Ce(this)&&Ve(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}}});var la,ua=n(()=>{ve();la=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=null,a=null,l=(u,p)=>D(void 0,null,function*(){let d=e(u),m=Y(d,p);if(!m){let h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=o(p,h),c!==null&&d.start(c),a!==null&&d.stop(a)}return s.set(p,d),m?yield t(p,u.offset,d.offset):yield r(p,u.offset,d.offset),yield i(u,p,d),d});return{set start(u){c=u},set stop(u){a=u},render(u,p){let d=s.get(p);return d!==void 0?Promise.resolve(d):l(u,p)}}}});var pa,da=n(()=>{pa=t=>o=>(t[0]=o,t[0])});var fS,ma,ha=n(()=>{fS={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},ma=(t,o,e,r,i,s)=>class extends t{constructor(a,l){let u=r(a),p=w(w({},fS),l),d=e(u,p),h=i(u)?o():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,p.buffer!==null&&s(this,p.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){let l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}}});var fa,xa=n(()=>{at();ve();fa=(t,o,e)=>()=>{let r=new WeakMap,i=(s,c)=>D(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(c,u)}return r.set(c,a),Ie(a)?yield e(s,c,a.inputs[0]):yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):i(s,c)}}}});var va,ga=n(()=>{va=(t,o)=>(e,r,i)=>{if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new o(e,r,i)}catch(s){throw s.name==="SyntaxError"?t():s}}});var ya,Ca=n(()=>{ya=()=>new DOMException("","DataCloneError")});var Zo,Na=n(()=>{Zo=t=>{let{port1:o,port2:e}=new MessageChannel;return new Promise(r=>{let i=()=>{e.onmessage=null,o.close(),e.close(),r()};e.onmessage=()=>i();try{o.postMessage(t,[t])}catch(s){}finally{i()}})}});var wa,Sa=n(()=>{Na();Br();wa=(t,o,e,r,i,s,c,a,l,u,p)=>(d,m)=>{let h=c(d)?d:s(d);if(i.has(m)){let f=e();return Promise.reject(f)}try{i.add(m)}catch(f){}return o(l,()=>l(h))?h.decodeAudioData(m).then(f=>(Zo(m).catch(()=>{}),o(a,()=>a(f))||p(f),t.add(f),f)):new Promise((f,x)=>{let v=()=>D(void 0,null,function*(){try{yield Zo(m)}catch(T){}}),g=T=>{x(T),v()};try{h.decodeAudioData(m,T=>{typeof T.copyFromChannel!="function"&&(u(T),Et(T)),t.add(T),v().then(()=>f(T))},T=>{g(T===null?r():T)})}catch(T){g(T)}})}});var Ta,Aa=n(()=>{zr();Ta=(t,o,e,r,i,s,c,a)=>(l,u)=>{let p=o.get(l);if(p===void 0)throw new Error("Missing the expected cycle count.");let d=s(l.context),m=a(d);if(p===u){if(o.delete(l),!m&&c(l)){let h=r(l),{outputs:f}=e(l);for(let x of f)if(et(x)){let v=r(x[0]);t(h,v,x[1],x[2])}else{let v=i(x[0]);h.connect(v,x[1])}}}else o.set(l,p-u)}});var xS,Ea,Ia=n(()=>{xS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ea=(t,o,e,r,i,s,c)=>class extends t{constructor(l,u){let p=i(l),d=w(w({},xS),u),m=r(p,d),h=s(p),f=h?e(d.maxDelayTime):null;super(l,!1,m,f),this._delayTime=o(this,h,m.delayTime),c(this,d.maxDelayTime)}get delayTime(){return this._delayTime}}});var ba,Ma=n(()=>{ve();ba=(t,o,e,r,i)=>s=>{let c=new WeakMap,a=(l,u)=>D(void 0,null,function*(){let p=e(l),d=Y(p,u);if(!d){let m={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,delayTime:p.delayTime.value,maxDelayTime:s};p=o(u,m)}return c.set(u,p),d?yield t(u,l.delayTime,p.delayTime):yield r(u,l.delayTime,p.delayTime),yield i(l,u,p),p});return{render(l,u){let p=c.get(u);return p!==void 0?Promise.resolve(p):a(l,u)}}}});var Pa,Fa=n(()=>{Pa=t=>(o,e,r,i)=>t(o[i],s=>s[0]===e&&s[1]===r)});var Oa,_a=n(()=>{Oa=t=>(o,e)=>{t(o).delete(e)}});var ka,Da=n(()=>{ka=t=>"delayTime"in t});var Ra,Ba=n(()=>{Hr();Da();Ra=(t,o,e)=>function r(i,s){let c=st(s)?s:e(t,s);if(ka(c))return[];if(i[0]===c)return[i];if(i.includes(c))return[];let{outputs:a}=o(c);return Array.from(a).map(l=>r([...i,c],l[0])).reduce((l,u)=>l.concat(u),[])}});var Xr,La,Va=n(()=>{qr();Xr=(t,o,e)=>{let r=o[e];if(r===void 0)throw t();return r},La=t=>(o,e=void 0,r=void 0,i=0)=>e===void 0?o.forEach(s=>s.disconnect()):typeof e=="number"?Xr(t,o,e).disconnect():lt(e)?r===void 0?o.forEach(s=>s.disconnect(e)):i===void 0?Xr(t,o,r).disconnect(e,0):Xr(t,o,r).disconnect(e,0,i):r===void 0?o.forEach(s=>s.disconnect(e)):Xr(t,o,r).disconnect(e,0)});var vS,Wa,Ha=n(()=>{vS={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Wa=(t,o,e,r,i,s,c,a)=>class extends t{constructor(u,p){let d=s(u),m=w(w({},vS),p),h=r(d,m),f=c(d),x=f?e():null;super(u,!1,h,x),this._attack=o(this,f,h.attack),this._knee=o(this,f,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=o(this,f,h.ratio),this._release=o(this,f,h.release),this._threshold=o(this,f,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(u){let p=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=u,u>2)throw this._nativeDynamicsCompressorNode.channelCount=p,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(u){let p=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=u,u==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=p,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}});var za,Ga=n(()=>{ve();za=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=(a,l)=>D(void 0,null,function*(){let u=e(a),p=Y(u,l);if(!p){let d={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=o(l,d)}return s.set(l,u),p?(yield t(l,a.attack,u.attack),yield t(l,a.knee,u.knee),yield t(l,a.ratio,u.ratio),yield t(l,a.release,u.release),yield t(l,a.threshold,u.threshold)):(yield r(l,a.attack,u.attack),yield r(l,a.knee,u.knee),yield r(l,a.ratio,u.ratio),yield r(l,a.release,u.release),yield r(l,a.threshold,u.threshold)),yield i(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var Ua,qa=n(()=>{Ua=()=>new DOMException("","EncodingError")});var ja,Xa=n(()=>{ja=t=>o=>new Promise((e,r)=>{if(t===null){r(new SyntaxError);return}let i=t.document.head;if(i===null)r(new SyntaxError);else{let s=t.document.createElement("script"),c=new Blob([o],{type:"application/javascript"}),a=URL.createObjectURL(c),l=t.onerror,u=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(p,d,m,h,f)=>{if(d===a||d===t.location.href&&m===1&&h===1)return u(),r(f),!1;if(l!==null)return l(p,d,m,h,f)},s.onerror=()=>{u(),r(new SyntaxError)},s.onload=()=>{u(),e()},s.src=a,s.type="module",i.appendChild(s)}})});var Ya,Za=n(()=>{Ya=t=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=t(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(e,s,i)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,r,i){let s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(e,s===void 0?null:s,i)}}});var Ka,$a=n(()=>{Ka=t=>(o,e,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(o*e)}},currentTime:{configurable:!0,get(){return o}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}}});var Qa,Ja=n(()=>{Qa=t=>o=>D(void 0,null,function*(){try{let e=yield fetch(o);if(e.ok)return[yield e.text(),e.url]}catch(e){}throw t()})});var gS,ec,tc=n(()=>{$e();gS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},ec=(t,o,e,r,i,s)=>class extends t{constructor(a,l){let u=i(a),p=w(w({},gS),l),d=r(u,p),m=s(u),h=m?e():null;super(a,!1,d,h),this._gain=o(this,m,d.gain,ae,ce)}get gain(){return this._gain}}});var rc,oc=n(()=>{ve();rc=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=(a,l)=>D(void 0,null,function*(){let u=e(a),p=Y(u,l);if(!p){let d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=o(l,d)}return s.set(l,u),p?yield t(l,a.gain,u.gain):yield r(l,a.gain,u.gain),yield i(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var nc,ic=n(()=>{nc=(t,o)=>e=>o(t,e)});var sc,ac=n(()=>{sc=t=>o=>{let e=t(o);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer}});var cc,lc=n(()=>{cc=t=>o=>{var e;return(e=t.get(o))!==null&&e!==void 0?e:0}});var uc,pc=n(()=>{uc=t=>o=>{let e=t(o);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer}});var dc,mc=n(()=>{dc=t=>o=>t.get(o)});var ne,ar=n(()=>{ne=()=>new DOMException("","InvalidStateError")});var hc,fc=n(()=>{ar();hc=t=>o=>{let e=t.get(o);if(e===void 0)throw ne();return e}});var xc,vc=n(()=>{xc=(t,o)=>e=>{let r=t.get(e);if(r!==void 0)return r;if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new o(1,1,44100),t.set(e,r),r}});var gc,yc=n(()=>{gc=t=>o=>{let e=t.get(o);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e}});var _t,Ko=n(()=>{_t=()=>new DOMException("","InvalidAccessError")});var Cc,Nc=n(()=>{Ko();Cc=t=>{t.getFrequencyResponse=(o=>(e,r,i)=>{if(e.length!==r.length||r.length!==i.length)throw _t();return o.call(t,e,r,i)})(t.getFrequencyResponse)}});var yS,wc,Sc=n(()=>{Nc();yS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},wc=(t,o,e,r,i,s)=>class extends t{constructor(a,l){let u=r(a),p=i(u),d=w(w({},yS),l),m=o(u,p?null:a.baseLatency,d),h=p?e(d.feedback,d.feedforward):null;super(a,!1,m,h),Cc(m),this._nativeIIRFilterNode=m,s(this,1)}getFrequencyResponse(a,l,u){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,u)}}});var Yr,$o=n(()=>{Yr=(t,o,e,r,i,s,c,a,l,u,p)=>{let d=u.length,m=a;for(let h=0;h<d;h+=1){let f=e[0]*u[h];for(let x=1;x<i;x+=1){let v=m-x&l-1;f+=e[x]*s[v],f-=t[x]*c[v]}for(let x=i;x<r;x+=1)f+=e[x]*s[m-x&l-1];for(let x=i;x<o;x+=1)f-=t[x]*c[m-x&l-1];s[m]=u[h],c[m]=f,m=m+1&l-1,p[h]=f}return m}});var CS,Tc,Ac=n(()=>{$o();ve();CS=(t,o,e,r)=>{let i=e instanceof Float64Array?e:new Float64Array(e),s=r instanceof Float64Array?r:new Float64Array(r),c=i.length,a=s.length,l=Math.min(c,a);if(i[0]!==1){for(let f=0;f<c;f+=1)s[f]/=i[0];for(let f=1;f<a;f+=1)i[f]/=i[0]}let u=32,p=new Float32Array(u),d=new Float32Array(u),m=o.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let f=0;f<h;f+=1){let x=t.getChannelData(f),v=m.getChannelData(f);p.fill(0),d.fill(0),Yr(i,c,s,a,l,p,d,0,u,x,v)}return m},Tc=(t,o,e,r,i)=>(s,c)=>{let a=new WeakMap,l=null,u=(p,d)=>D(void 0,null,function*(){let m=null,h=o(p),f=Y(h,d);if(d.createIIRFilter===void 0?m=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(h=d.createIIRFilter(c,s)),a.set(d,m===null?h:m),m!==null){if(l===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");let v=new e(p.context.destination.channelCount,p.context.length,d.sampleRate);l=(()=>D(void 0,null,function*(){yield r(p,v,v.destination);let g=yield i(v);return CS(g,d,s,c)}))()}let x=yield l;return m.buffer=x,m.start(0),m}return yield r(p,d,h),h});return{render(p,d){let m=a.get(d);return m!==void 0?Promise.resolve(m):u(p,d)}}}});var Ec,Ic=n(()=>{zr();Ec=(t,o,e,r,i,s)=>c=>(a,l)=>{let u=t.get(a);if(u===void 0){if(!c&&s(a)){let p=r(a),{outputs:d}=e(a);for(let m of d)if(et(m)){let h=r(m[0]);o(p,h,m[1],m[2])}else{let h=i(m[0]);p.disconnect(h,m[1])}}t.set(a,l)}else t.set(a,u+l)}});var bc,Mc=n(()=>{bc=(t,o)=>e=>{let r=t.get(e);return o(r)||o(e)}});var Pc,Fc=n(()=>{Pc=(t,o)=>e=>t.has(e)||o(e)});var Oc,_c=n(()=>{Oc=(t,o)=>e=>t.has(e)||o(e)});var kc,Dc=n(()=>{kc=(t,o)=>e=>{let r=t.get(e);return o(r)||o(e)}});var Rc,Bc=n(()=>{Rc=t=>o=>t!==null&&o instanceof t});var Lc,Vc=n(()=>{Lc=t=>o=>t!==null&&typeof t.AudioNode=="function"&&o instanceof t.AudioNode});var Wc,Hc=n(()=>{Wc=t=>o=>t!==null&&typeof t.AudioParam=="function"&&o instanceof t.AudioParam});var zc,Gc=n(()=>{zc=(t,o)=>e=>t(e)||o(e)});var Uc,qc=n(()=>{Uc=t=>o=>t!==null&&o instanceof t});var jc,Xc=n(()=>{jc=t=>t!==null&&t.isSecureContext});var Yc,Zc=n(()=>{Yc=(t,o,e,r,i,s,c,a,l,u,p,d,m,h,f,x)=>D(void 0,null,function*(){return t(o,o)&&t(e,e)&&t(i,i)&&t(s,s)&&t(a,a)&&t(l,l)&&t(u,u)&&t(p,p)&&t(d,d)&&t(m,m)&&t(h,h)?(yield Promise.all([t(r,r),t(c,c),t(f,f),t(x,x)])).every(g=>g):!1})});var Kc,$c=n(()=>{Kc=(t,o,e,r)=>class extends t{constructor(s,c){let a=e(s),l=o(a,c);if(r(a))throw TypeError();super(s,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}}});var NS,Qc,Jc=n(()=>{NS={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Qc=(t,o,e,r)=>class extends t{constructor(s,c){let a=e(s);if(r(a))throw new TypeError;let l=w(w({},NS),c),u=o(a,l);super(s,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}});var el,tl=n(()=>{el=(t,o,e,r)=>class extends t{constructor(s,c){let a=e(s),l=o(a,c);if(r(a))throw new TypeError;super(s,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}});var rl,ol=n(()=>{rl=(t,o,e)=>class extends t{constructor(i,s){let c=e(i),a=o(c,s);super(i,!0,a,null)}}});var nl,il=n(()=>{ir();Fo();nl=(t,o,e,r,i)=>class extends r{constructor(c={}){if(i===null)throw new Error("Missing the native AudioContext constructor.");let a;try{a=new i(c)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?o():p}if(a===null)throw e();if(!Wr(c.latencyHint))throw new TypeError(`The provided value '${c.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(c.sampleRate!==void 0&&a.sampleRate!==c.sampleRate)throw o();super(a,2);let{latencyHint:l}=c,{sampleRate:u}=a;if(this._baseLatency=typeof a.baseLatency=="number"?a.baseLatency:l==="balanced"?512/u:l==="interactive"||l===void 0?256/u:l==="playback"?1024/u:Math.max(2,Math.min(128,Math.round(l*u/128)))*128/u,this._nativeAudioContext=a,i.name==="webkitAudioContext"?(this._nativeGainNode=a.createGain(),this._nativeOscillatorNode=a.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(a.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,a.state==="running"){this._state="suspended";let p=()=>{this._state==="suspended"&&(this._state=null),a.removeEventListener("statechange",p)};a.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Je(this)}))}resume(){return this._state==="suspended"?new Promise((c,a)=>{let l=()=>{this._nativeAudioContext.removeEventListener("statechange",l),this._nativeAudioContext.state==="running"?c():this.resume().then(c,a)};this._nativeAudioContext.addEventListener("statechange",l)}):this._nativeAudioContext.resume().catch(c=>{throw c===void 0||c.code===15?t():c})}suspend(){return this._nativeAudioContext.suspend().catch(c=>{throw c===void 0?t():c})}}});var sl,al=n(()=>{fe();sl=(t,o,e,r,i,s)=>class extends e{constructor(a,l){super(a),this._nativeContext=a,Nt.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,l),this._listener=o(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){let l=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=l;let u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===l?a:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}});var Oe,cr=n(()=>{Oe=t=>{let o=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let e=t.decodeAudioData(o.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch(e){}return!1}});var wS,cl,ll=n(()=>{ir();cr();wS={numberOfChannels:1},cl=(t,o,e,r,i)=>class extends r{constructor(c){let{length:a,numberOfChannels:l,sampleRate:u}=w(w({},wS),c),p=e(l,a,u);t(Oe,()=>Oe(p))||p.addEventListener("statechange",(()=>{let d=0,m=h=>{this._state==="running"&&(d>0?(p.removeEventListener("statechange",m),h.stopImmediatePropagation(),this._waitForThePromiseToSettle(h)):d+=1)};return m})()),super(p,l),this._length=a,this._nativeOfflineAudioContext=p,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(o()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Je(this)}))}_waitForThePromiseToSettle(c){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(c):setTimeout(()=>this._waitForThePromiseToSettle(c))}}});var ul,pl=n(()=>{ul=(t,o)=>(e,r,i)=>{let s=new Set;return e.connect=(c=>(a,l=0,u=0)=>{let p=s.size===0;if(o(a))return c.call(e,a,l,u),t(s,[a,l,u],d=>d[0]===a&&d[1]===l&&d[2]===u,!0),p&&r(),a;c.call(e,a,l),t(s,[a,l],d=>d[0]===a&&d[1]===l,!0),p&&r()})(e.connect),e.disconnect=(c=>(a,l,u)=>{let p=s.size>0;if(a===void 0)c.apply(e),s.clear();else if(typeof a=="number"){c.call(e,a);for(let m of s)m[1]===a&&s.delete(m)}else{o(a)?c.call(e,a,l,u):c.call(e,a,l);for(let m of s)m[0]===a&&(l===void 0||m[1]===l)&&(u===void 0||m[2]===u)&&s.delete(m)}let d=s.size===0;p&&d&&i()})(e.disconnect),e}});var Z,je=n(()=>{Z=(t,o,e)=>{let r=o[e];r!==void 0&&r!==t[e]&&(t[e]=r)}});var j,he=n(()=>{je();j=(t,o)=>{Z(t,o,"channelCount"),Z(t,o,"channelCountMode"),Z(t,o,"channelInterpretation")}});var Qo,dl=n(()=>{Qo=t=>typeof t.getFloatTimeDomainData=="function"});var ml,hl=n(()=>{ml=t=>{t.getFloatTimeDomainData=o=>{let e=new Uint8Array(o.length);t.getByteTimeDomainData(e);let r=Math.max(e.length,t.fftSize);for(let i=0;i<r;i+=1)o[i]=(e[i]-128)*.0078125;return o}}});var fl,xl=n(()=>{je();he();dl();hl();fl=(t,o)=>(e,r)=>{let i=e.createAnalyser();if(j(i,r),!(r.maxDecibels>r.minDecibels))throw o();return Z(i,r,"fftSize"),Z(i,r,"maxDecibels"),Z(i,r,"minDecibels"),Z(i,r,"smoothingTimeConstant"),t(Qo,()=>Qo(i))||ml(i),i}});var vl,gl=n(()=>{vl=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null});var $,We=n(()=>{$=(t,o,e)=>{let r=o[e];r!==void 0&&r!==t[e].value&&(t[e].value=r)}});var yl,Cl=n(()=>{ar();yl=t=>{t.start=(o=>{let e=!1;return(r=0,i=0,s)=>{if(e)throw ne();o.call(t,r,i,s),e=!0}})(t.start)}});var kt,Zr=n(()=>{kt=t=>{t.start=(o=>(e=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||e<0)throw new RangeError("The parameters can't be negative.");o.call(t,e,r,i)})(t.start)}});var Dt,Kr=n(()=>{Dt=t=>{t.stop=(o=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");o.call(t,e)})(t.stop)}});var Nl,wl=n(()=>{We();je();he();Cl();Zr();Kr();Nl=(t,o,e,r,i,s,c,a,l,u,p)=>(d,m)=>{let h=d.createBufferSource();return j(h,m),$(h,m,"playbackRate"),Z(h,m,"buffer"),Z(h,m,"loop"),Z(h,m,"loopEnd"),Z(h,m,"loopStart"),o(e,()=>e(d))||yl(h),o(r,()=>r(d))||l(h),o(i,()=>i(d))||u(h,d),o(s,()=>s(d))||kt(h),o(c,()=>c(d))||p(h,d),o(a,()=>a(d))||Dt(h),t(d,h),h}});var Sl,Tl=n(()=>{Sl=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null});var Al,El=n(()=>{Al=(t,o)=>(e,r,i)=>{let s=e.destination;if(s.channelCount!==r)try{s.channelCount=r}catch(a){}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});let c=t(e,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return o(c,"channelCount",a=>()=>a.call(c),a=>l=>{a.call(c,l);try{s.channelCount=l}catch(u){if(l>s.maxChannelCount)throw u}}),o(c,"channelCountMode",a=>()=>a.call(c),a=>l=>{a.call(c,l),s.channelCountMode=l}),o(c,"channelInterpretation",a=>()=>a.call(c),a=>l=>{a.call(c,l),s.channelInterpretation=l}),Object.defineProperty(c,"maxChannelCount",{get:()=>s.maxChannelCount}),c.connect(s),c}});var Il,bl=n(()=>{Il=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null});var Ml,Pl=n(()=>{Ml=t=>{let{port1:o}=new MessageChannel;try{o.postMessage(t)}finally{o.close()}}});var Fl,Ol=n(()=>{Pl();Fl=(t,o,e,r,i)=>(s,c,a,l,u,p)=>{if(a!==null)try{let d=new a(s,l,p),m=new Map,h=null;if(Object.defineProperties(d,{channelCount:{get:()=>p.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:f=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof f=="function"?f:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(f=>(...x)=>{if(x[0]==="processorerror"){let v=typeof x[1]=="function"?x[1]:typeof x[1]=="object"&&x[1]!==null&&typeof x[1].handleEvent=="function"?x[1].handleEvent:null;if(v!==null){let g=m.get(x[1]);g!==void 0?x[1]=g:(x[1]=T=>{T.type==="error"?(Object.defineProperties(T,{type:{value:"processorerror"}}),v(T)):v(new ErrorEvent(x[0],w({},T)))},m.set(v,x[1]))}}return f.call(d,"error",x[1],x[2]),f.call(d,...x)})(d.addEventListener),d.removeEventListener=(f=>(...x)=>{if(x[0]==="processorerror"){let v=m.get(x[1]);v!==void 0&&(m.delete(x[1]),x[1]=v)}return f.call(d,"error",x[1],x[2]),f.call(d,x[0],x[1],x[2])})(d.removeEventListener),p.numberOfOutputs!==0){let f=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(f).connect(s.destination),i(d,()=>f.disconnect(),()=>f.connect(s.destination))}return d}catch(d){throw d.code===11?r():d}if(u===void 0)throw r();return Ml(p),o(s,c,u,p)}});var $r,Jo=n(()=>{$r=(t,o)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*o)))))});var _l,kl=n(()=>{_l=t=>new Promise((o,e)=>{let{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),o(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),e(s)},i.postMessage(t)})});var Dl,Rl=n(()=>{kl();Dl=(t,o)=>D(void 0,null,function*(){let e=yield _l(o);return new t(e)})});var Bl,Ll=n(()=>{fe();Rl();Bl=(t,o,e,r)=>{let i=tr.get(t);i===void 0&&(i=new WeakMap,tr.set(t,i));let s=Dl(e,r);return i.set(o,s),s}});var Vl,Wl=n(()=>{$e();Jo();jo();Xo();Ll();Yo();qo();Vl=(t,o,e,r,i,s,c,a,l,u,p,d,m)=>(h,f,x,v)=>{if(v.numberOfInputs===0&&v.numberOfOutputs===0)throw l();let g=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(g.some(k=>k<1))throw l();if(g.length!==v.numberOfOutputs)throw o();if(v.channelCountMode!=="explicit")throw l();let T=v.channelCount*v.numberOfInputs,A=g.reduce((k,z)=>k+z,0),M=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(T+M>6||A>6)throw l();let S=new MessageChannel,N=[],y=[];for(let k=0;k<v.numberOfInputs;k+=1)N.push(c(h,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),y.push(i(h,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));let C=[];if(x.parameterDescriptors!==void 0)for(let{defaultValue:k,maxValue:z,minValue:de,name:ie}of x.parameterDescriptors){let K=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:v.parameterData[ie]!==void 0?v.parameterData[ie]:k===void 0?0:k});Object.defineProperties(K.offset,{defaultValue:{get:()=>k===void 0?0:k},maxValue:{get:()=>z===void 0?ae:z},minValue:{get:()=>de===void 0?ce:de}}),C.push(K)}let P=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,T+M)}),R=$r(f,h.sampleRate),I=a(h,R,T+M,Math.max(1,A)),E=i(h,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),B=[];for(let k=0;k<v.numberOfOutputs;k+=1)B.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[k]}));for(let k=0;k<v.numberOfInputs;k+=1){N[k].connect(y[k]);for(let z=0;z<v.channelCount;z+=1)y[k].connect(P,z,k*v.channelCount+z)}let b=new Pt(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:k},z)=>{let de=C[z];return de.connect(P,0,T+z),de.start(0),[k,de.offset]}));P.connect(I);let _=v.channelInterpretation,O=null,L=v.numberOfOutputs===0?[I]:B,U={get bufferSize(){return R},get channelCount(){return v.channelCount},set channelCount(k){throw e()},get channelCountMode(){return v.channelCountMode},set channelCountMode(k){throw e()},get channelInterpretation(){return _},set channelInterpretation(k){for(let z of N)z.channelInterpretation=k;_=k},get context(){return I.context},get inputs(){return N},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return O},set onprocessorerror(k){typeof O=="function"&&U.removeEventListener("processorerror",O),O=typeof k=="function"?k:null,typeof O=="function"&&U.addEventListener("processorerror",O)},get parameters(){return b},get port(){return S.port2},addEventListener(...k){return I.addEventListener(k[0],k[1],k[2])},connect:t.bind(null,L),disconnect:u.bind(null,L),dispatchEvent(...k){return I.dispatchEvent(k[0])},removeEventListener(...k){return I.removeEventListener(k[0],k[1],k[2])}},V=new Map;S.port1.addEventListener=(k=>(...z)=>{if(z[0]==="message"){let de=typeof z[1]=="function"?z[1]:typeof z[1]=="object"&&z[1]!==null&&typeof z[1].handleEvent=="function"?z[1].handleEvent:null;if(de!==null){let ie=V.get(z[1]);ie!==void 0?z[1]=ie:(z[1]=K=>{p(h.currentTime,h.sampleRate,()=>de(K))},V.set(de,z[1]))}}return k.call(S.port1,z[0],z[1],z[2])})(S.port1.addEventListener),S.port1.removeEventListener=(k=>(...z)=>{if(z[0]==="message"){let de=V.get(z[1]);de!==void 0&&(V.delete(z[1]),z[1]=de)}return k.call(S.port1,z[0],z[1],z[2])})(S.port1.removeEventListener);let H=null;Object.defineProperty(S.port1,"onmessage",{get:()=>H,set:k=>{typeof H=="function"&&S.port1.removeEventListener("message",H),H=typeof k=="function"?k:null,typeof H=="function"&&(S.port1.addEventListener("message",H),S.port1.start())}}),x.prototype.port=S.port1;let q=null;Bl(h,U,x,v).then(k=>q=k);let X=Ot(v.numberOfInputs,v.channelCount),ue=Ot(v.numberOfOutputs,g),we=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((k,{name:z})=>F(w({},k),{[z]:new Float32Array(128)}),{}),J=!0,G=()=>{v.numberOfOutputs>0&&I.disconnect(E);for(let k=0,z=0;k<v.numberOfOutputs;k+=1){let de=B[k];for(let ie=0;ie<g[k];ie+=1)E.disconnect(de,z+ie,ie);z+=g[k]}},ht=new Map;I.onaudioprocess=({inputBuffer:k,outputBuffer:z})=>{if(q!==null){let de=d(U);for(let ie=0;ie<R;ie+=128){for(let K=0;K<v.numberOfInputs;K+=1)for(let se=0;se<v.channelCount;se+=1)Ft(k,X[K],se,se,ie);x.parameterDescriptors!==void 0&&x.parameterDescriptors.forEach(({name:K},se)=>{Ft(k,we,K,T+se,ie)});for(let K=0;K<v.numberOfInputs;K+=1)for(let se=0;se<g[K];se+=1)ue[K][se].byteLength===0&&(ue[K][se]=new Float32Array(128));try{let K=X.map((Te,Ye)=>{if(de[Ye].size>0)return ht.set(Ye,R/128),Te;let io=ht.get(Ye);return io===void 0?[]:(Te.every(Vw=>Vw.every(Ww=>Ww===0))&&(io===1?ht.delete(Ye):ht.set(Ye,io-1)),Te)});J=p(h.currentTime+ie/h.sampleRate,h.sampleRate,()=>q.process(K,ue,we));for(let Te=0,Ye=0;Te<v.numberOfOutputs;Te+=1){for(let jt=0;jt<g[Te];jt+=1)jr(z,ue[Te],jt,Ye+jt,ie);Ye+=g[Te]}}catch(K){J=!1,U.dispatchEvent(new ErrorEvent("processorerror",{colno:K.colno,filename:K.filename,lineno:K.lineno,message:K.message}))}if(!J){for(let K=0;K<v.numberOfInputs;K+=1){N[K].disconnect(y[K]);for(let se=0;se<v.channelCount;se+=1)y[ie].disconnect(P,se,K*v.channelCount+se)}if(x.parameterDescriptors!==void 0){let K=x.parameterDescriptors.length;for(let se=0;se<K;se+=1){let Te=C[se];Te.disconnect(P,0,T+se),Te.stop()}}P.disconnect(I),I.onaudioprocess=null,Gt?G():xt();break}}}};let Gt=!1,W=c(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ft=()=>I.connect(W).connect(h.destination),xt=()=>{I.disconnect(W),W.disconnect()},Ut=()=>{if(J){xt(),v.numberOfOutputs>0&&I.connect(E);for(let k=0,z=0;k<v.numberOfOutputs;k+=1){let de=B[k];for(let ie=0;ie<g[k];ie+=1)E.connect(de,z+ie,ie);z+=g[k]}}Gt=!0},qt=()=>{J&&(ft(),G()),Gt=!1};return ft(),m(U,Ut,qt)}});var en,Hl=n(()=>{We();je();he();en=(t,o)=>{let e=t.createBiquadFilter();return j(e,o),$(e,o,"Q"),$(e,o,"detune"),$(e,o,"frequency"),$(e,o,"gain"),Z(e,o,"type"),e}});var zl,Gl=n(()=>{he();zl=(t,o)=>(e,r)=>{let i=e.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&o(e,i),j(i,r),i}});var Ul,ql=n(()=>{ar();Ul=t=>{let o=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>o,set:e=>{if(e!==o)throw ne()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw ne()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw ne()}})}});var Rt,jl=n(()=>{he();ql();Rt=(t,o)=>{let e=t.createChannelSplitter(o.numberOfOutputs);return j(e,o),Ul(e),e}});var Xl,Yl=n(()=>{We();he();Zr();Kr();Xl=(t,o,e,r,i)=>(s,c)=>{if(s.createConstantSource===void 0)return e(s,c);let a=s.createConstantSource();return j(a,c),$(a,c,"offset"),o(r,()=>r(s))||kt(a),o(i,()=>i(s))||Dt(a),t(s,a),a}});var be,ut=n(()=>{be=(t,o)=>(t.connect=o.connect.bind(o),t.disconnect=o.disconnect.bind(o),t)});var Zl,Kl=n(()=>{ut();Zl=(t,o,e,r)=>(i,a)=>{var l=a,{offset:s}=l,c=Ze(l,["offset"]);let u=i.createBuffer(1,2,44100),p=o(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=e(i,F(w({},c),{gain:s})),m=u.getChannelData(0);m[0]=1,m[1]=1,p.buffer=u,p.loop=!0;let h={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(v){d.channelCount=v},get channelCountMode(){return d.channelCountMode},set channelCountMode(v){d.channelCountMode=v},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(v){d.channelInterpretation=v},get context(){return d.context},get inputs(){return[]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get offset(){return d.gain},get onended(){return p.onended},set onended(v){p.onended=v},addEventListener(...v){return p.addEventListener(v[0],v[1],v[2])},dispatchEvent(...v){return p.dispatchEvent(v[0])},removeEventListener(...v){return p.removeEventListener(v[0],v[1],v[2])},start(v=0){p.start.call(p,v)},stop(v=0){p.stop.call(p,v)}},f=()=>p.connect(d),x=()=>p.disconnect(d);return t(i,p),r(be(h,d),f,x)}});var $l,Ql=n(()=>{je();he();$l=(t,o)=>(e,r)=>{let i=e.createConvolver();if(j(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Z(i,r,"buffer"),r.channelCount>2||(o(i,"channelCount",s=>()=>s.call(i),s=>c=>{if(c>2)throw t();return s.call(i,c)}),r.channelCountMode==="max"))throw t();return o(i,"channelCountMode",s=>()=>s.call(i),s=>c=>{if(c==="max")throw t();return s.call(i,c)}),i}});var tn,Jl=n(()=>{We();he();tn=(t,o)=>{let e=t.createDelay(o.maxDelayTime);return j(e,o),$(e,o,"delayTime"),e}});var eu,tu=n(()=>{We();he();eu=t=>(o,e)=>{let r=o.createDynamicsCompressor();if(j(r,e),e.channelCount>2||e.channelCountMode==="max")throw t();return $(r,e,"attack"),$(r,e,"knee"),$(r,e,"ratio"),$(r,e,"release"),$(r,e,"threshold"),r}});var Ne,ru=n(()=>{We();he();Ne=(t,o)=>{let e=t.createGain();return j(e,o),$(e,o,"gain"),e}});var ou,nu=n(()=>{he();ou=t=>(o,e,r)=>{if(o.createIIRFilter===void 0)return t(o,e,r);let i=o.createIIRFilter(r.feedforward,r.feedback);return j(i,r),i}});function SS(t,o){let e=o[0]*o[0]+o[1]*o[1];return[(t[0]*o[0]+t[1]*o[1])/e,(t[1]*o[0]-t[0]*o[1])/e]}function TS(t,o){return[t[0]*o[0]-t[1]*o[1],t[0]*o[1]+t[1]*o[0]]}function iu(t,o){let e=[0,0];for(let r=t.length-1;r>=0;r-=1)e=TS(e,o),e[0]+=t[r];return e}var su,au=n(()=>{Jo();$o();ut();su=(t,o,e,r)=>(i,s,{channelCount:c,channelCountMode:a,channelInterpretation:l,feedback:u,feedforward:p})=>{let d=$r(s,i.sampleRate),m=u instanceof Float64Array?u:new Float64Array(u),h=p instanceof Float64Array?p:new Float64Array(p),f=m.length,x=h.length,v=Math.min(f,x);if(f===0||f>20)throw r();if(m[0]===0)throw o();if(x===0||x>20)throw r();if(h[0]===0)throw o();if(m[0]!==1){for(let C=0;C<x;C+=1)h[C]/=m[0];for(let C=1;C<f;C+=1)m[C]/=m[0]}let g=e(i,d,c,c);g.channelCount=c,g.channelCountMode=a,g.channelInterpretation=l;let T=32,A=[],M=[],S=[];for(let C=0;C<c;C+=1){A.push(0);let P=new Float32Array(T),R=new Float32Array(T);P.fill(0),R.fill(0),M.push(P),S.push(R)}g.onaudioprocess=C=>{let P=C.inputBuffer,R=C.outputBuffer,I=P.numberOfChannels;for(let E=0;E<I;E+=1){let B=P.getChannelData(E),b=R.getChannelData(E);A[E]=Yr(m,f,h,x,v,M[E],S[E],A[E],T,B,b)}};let N=i.sampleRate/2;return be({get bufferSize(){return d},get channelCount(){return g.channelCount},set channelCount(C){g.channelCount=C},get channelCountMode(){return g.channelCountMode},set channelCountMode(C){g.channelCountMode=C},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(C){g.channelInterpretation=C},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...C){return g.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return g.dispatchEvent(C[0])},getFrequencyResponse(C,P,R){if(C.length!==P.length||P.length!==R.length)throw t();let I=C.length;for(let E=0;E<I;E+=1){let B=-Math.PI*(C[E]/N),b=[Math.cos(B),Math.sin(B)],_=iu(h,b),O=iu(m,b),L=SS(_,O);P[E]=Math.sqrt(L[0]*L[0]+L[1]*L[1]),R[E]=Math.atan2(L[1],L[0])}},removeEventListener(...C){return g.removeEventListener(C[0],C[1],C[2])}},g)}});var cu,lu=n(()=>{cu=(t,o)=>t.createMediaElementSource(o.mediaElement)});var uu,pu=n(()=>{he();uu=(t,o)=>{let e=t.createMediaStreamDestination();return j(e,o),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e}});var du,mu=n(()=>{du=(t,{mediaStream:o})=>{let e=o.getAudioTracks();e.sort((s,c)=>s.id<c.id?-1:s.id>c.id?1:0);let r=e.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:o}),i}});var hu,fu=n(()=>{hu=(t,o)=>(e,{mediaStreamTrack:r})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(r);let i=new MediaStream([r]),s=e.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(o(e))throw new TypeError;return s}});var xu,vu=n(()=>{xu=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null});var gu,yu=n(()=>{We();je();he();Zr();Kr();gu=(t,o,e,r,i,s)=>(c,a)=>{let l=c.createOscillator();return j(l,a),$(l,a,"detune"),$(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Z(l,a,"type"),o(e,()=>e(c))||kt(l),o(r,()=>r(c))||s(l,c),o(i,()=>i(c))||Dt(l),t(c,l),l}});var Cu,Nu=n(()=>{We();je();he();Cu=t=>(o,e)=>{let r=o.createPanner();return r.orientationX===void 0?t(o,e):(j(r,e),$(r,e,"orientationX"),$(r,e,"orientationY"),$(r,e,"orientationZ"),$(r,e,"positionX"),$(r,e,"positionY"),$(r,e,"positionZ"),Z(r,e,"coneInnerAngle"),Z(r,e,"coneOuterAngle"),Z(r,e,"coneOuterGain"),Z(r,e,"distanceModel"),Z(r,e,"maxDistance"),Z(r,e,"panningModel"),Z(r,e,"refDistance"),Z(r,e,"rolloffFactor"),r)}});var wu,Su=n(()=>{he();ut();wu=(t,o,e,r,i,s,c,a,l,u)=>(p,R)=>{var I=R,{coneInnerAngle:d,coneOuterAngle:m,coneOuterGain:h,distanceModel:f,maxDistance:x,orientationX:v,orientationY:g,orientationZ:T,panningModel:A,positionX:M,positionY:S,positionZ:N,refDistance:y,rolloffFactor:C}=I,P=Ze(I,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);let E=p.createPanner();if(P.channelCount>2||P.channelCountMode==="max")throw c();j(E,P);let B={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},b=e(p,F(w({},B),{channelInterpretation:"speakers",numberOfInputs:6})),_=r(p,F(w({},P),{gain:1})),O=r(p,F(w({},B),{gain:1})),L=r(p,F(w({},B),{gain:0})),U=r(p,F(w({},B),{gain:0})),V=r(p,F(w({},B),{gain:0})),H=r(p,F(w({},B),{gain:0})),q=r(p,F(w({},B),{gain:0})),Q=i(p,256,6,1),X=s(p,F(w({},B),{curve:new Float32Array([1,1]),oversample:"none"})),ue=[v,g,T],we=[M,S,N],J=new Float32Array(1);Q.onaudioprocess=({inputBuffer:W})=>{let ft=[l(W,J,0),l(W,J,1),l(W,J,2)];ft.some((Ut,qt)=>Ut!==ue[qt])&&(E.setOrientation(...ft),ue=ft);let xt=[l(W,J,3),l(W,J,4),l(W,J,5)];xt.some((Ut,qt)=>Ut!==we[qt])&&(E.setPosition(...xt),we=xt)},Object.defineProperty(L.gain,"defaultValue",{get:()=>0}),Object.defineProperty(U.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(H.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0});let G={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(W){if(W>2)throw c();_.channelCount=W,E.channelCount=W},get channelCountMode(){return E.channelCountMode},set channelCountMode(W){if(W==="max")throw c();_.channelCountMode=W,E.channelCountMode=W},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(W){_.channelInterpretation=W,E.channelInterpretation=W},get coneInnerAngle(){return E.coneInnerAngle},set coneInnerAngle(W){E.coneInnerAngle=W},get coneOuterAngle(){return E.coneOuterAngle},set coneOuterAngle(W){E.coneOuterAngle=W},get coneOuterGain(){return E.coneOuterGain},set coneOuterGain(W){if(W<0||W>1)throw o();E.coneOuterGain=W},get context(){return E.context},get distanceModel(){return E.distanceModel},set distanceModel(W){E.distanceModel=W},get inputs(){return[_]},get maxDistance(){return E.maxDistance},set maxDistance(W){if(W<0)throw new RangeError;E.maxDistance=W},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get orientationX(){return O.gain},get orientationY(){return L.gain},get orientationZ(){return U.gain},get panningModel(){return E.panningModel},set panningModel(W){E.panningModel=W},get positionX(){return V.gain},get positionY(){return H.gain},get positionZ(){return q.gain},get refDistance(){return E.refDistance},set refDistance(W){if(W<0)throw new RangeError;E.refDistance=W},get rolloffFactor(){return E.rolloffFactor},set rolloffFactor(W){if(W<0)throw new RangeError;E.rolloffFactor=W},addEventListener(...W){return _.addEventListener(W[0],W[1],W[2])},dispatchEvent(...W){return _.dispatchEvent(W[0])},removeEventListener(...W){return _.removeEventListener(W[0],W[1],W[2])}};d!==G.coneInnerAngle&&(G.coneInnerAngle=d),m!==G.coneOuterAngle&&(G.coneOuterAngle=m),h!==G.coneOuterGain&&(G.coneOuterGain=h),f!==G.distanceModel&&(G.distanceModel=f),x!==G.maxDistance&&(G.maxDistance=x),v!==G.orientationX.value&&(G.orientationX.value=v),g!==G.orientationY.value&&(G.orientationY.value=g),T!==G.orientationZ.value&&(G.orientationZ.value=T),A!==G.panningModel&&(G.panningModel=A),M!==G.positionX.value&&(G.positionX.value=M),S!==G.positionY.value&&(G.positionY.value=S),N!==G.positionZ.value&&(G.positionZ.value=N),y!==G.refDistance&&(G.refDistance=y),C!==G.rolloffFactor&&(G.rolloffFactor=C),(ue[0]!==1||ue[1]!==0||ue[2]!==0)&&E.setOrientation(...ue),(we[0]!==0||we[1]!==0||we[2]!==0)&&E.setPosition(...we);let ht=()=>{_.connect(E),t(_,X,0,0),X.connect(O).connect(b,0,0),X.connect(L).connect(b,0,1),X.connect(U).connect(b,0,2),X.connect(V).connect(b,0,3),X.connect(H).connect(b,0,4),X.connect(q).connect(b,0,5),b.connect(Q).connect(p.destination)},Gt=()=>{_.disconnect(E),a(_,X,0,0),X.disconnect(O),O.disconnect(b),X.disconnect(L),L.disconnect(b),X.disconnect(U),U.disconnect(b),X.disconnect(V),V.disconnect(b),X.disconnect(H),H.disconnect(b),X.disconnect(q),q.disconnect(b),b.disconnect(Q),Q.disconnect(p.destination)};return u(be(G,E),ht,Gt)}});var Tu,Au=n(()=>{Tu=t=>(o,{disableNormalization:e,imag:r,real:i})=>{let s=r instanceof Float32Array?r:new Float32Array(r),c=i instanceof Float32Array?i:new Float32Array(i),a=o.createPeriodicWave(c,s,{disableNormalization:e});if(Array.from(r).length<2)throw t();return a}});var Bt,Eu=n(()=>{Bt=(t,o,e,r)=>t.createScriptProcessor(o,e,r)});var Iu,bu=n(()=>{We();he();Iu=(t,o)=>(e,r)=>{let i=r.channelCountMode;if(i==="clamped-max")throw o();if(e.createStereoPanner===void 0)return t(e,r);let s=e.createStereoPanner();return j(s,r),$(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:c=>{if(c!==i)throw o()}}),s}});var Mu,Pu=n(()=>{ut();Mu=(t,o,e,r,i,s)=>{let a=new Float32Array([1,1]),l=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},p=F(w({},u),{oversample:"none"}),d=(f,x,v,g)=>{let T=new Float32Array(16385),A=new Float32Array(16385);for(let P=0;P<16385;P+=1){let R=P/16384*l;T[P]=Math.cos(R),A[P]=Math.sin(R)}let M=e(f,F(w({},u),{gain:0})),S=r(f,F(w({},p),{curve:T})),N=r(f,F(w({},p),{curve:a})),y=e(f,F(w({},u),{gain:0})),C=r(f,F(w({},p),{curve:A}));return{connectGraph(){x.connect(M),x.connect(N.inputs===void 0?N:N.inputs[0]),x.connect(y),N.connect(v),v.connect(S.inputs===void 0?S:S.inputs[0]),v.connect(C.inputs===void 0?C:C.inputs[0]),S.connect(M.gain),C.connect(y.gain),M.connect(g,0,0),y.connect(g,0,1)},disconnectGraph(){x.disconnect(M),x.disconnect(N.inputs===void 0?N:N.inputs[0]),x.disconnect(y),N.disconnect(v),v.disconnect(S.inputs===void 0?S:S.inputs[0]),v.disconnect(C.inputs===void 0?C:C.inputs[0]),S.disconnect(M.gain),C.disconnect(y.gain),M.disconnect(g,0,0),y.disconnect(g,0,1)}}},m=(f,x,v,g)=>{let T=new Float32Array(16385),A=new Float32Array(16385),M=new Float32Array(16385),S=new Float32Array(16385),N=Math.floor(16385/2);for(let L=0;L<16385;L+=1)if(L>N){let U=(L-N)/(16384-N)*l;T[L]=Math.cos(U),A[L]=Math.sin(U),M[L]=0,S[L]=1}else{let U=L/(16384-N)*l;T[L]=1,A[L]=0,M[L]=Math.cos(U),S[L]=Math.sin(U)}let y=o(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),C=e(f,F(w({},u),{gain:0})),P=r(f,F(w({},p),{curve:T})),R=e(f,F(w({},u),{gain:0})),I=r(f,F(w({},p),{curve:A})),E=r(f,F(w({},p),{curve:a})),B=e(f,F(w({},u),{gain:0})),b=r(f,F(w({},p),{curve:M})),_=e(f,F(w({},u),{gain:0})),O=r(f,F(w({},p),{curve:S}));return{connectGraph(){x.connect(y),x.connect(E.inputs===void 0?E:E.inputs[0]),y.connect(C,0),y.connect(R,0),y.connect(B,1),y.connect(_,1),E.connect(v),v.connect(P.inputs===void 0?P:P.inputs[0]),v.connect(I.inputs===void 0?I:I.inputs[0]),v.connect(b.inputs===void 0?b:b.inputs[0]),v.connect(O.inputs===void 0?O:O.inputs[0]),P.connect(C.gain),I.connect(R.gain),b.connect(B.gain),O.connect(_.gain),C.connect(g,0,0),B.connect(g,0,0),R.connect(g,0,1),_.connect(g,0,1)},disconnectGraph(){x.disconnect(y),x.disconnect(E.inputs===void 0?E:E.inputs[0]),y.disconnect(C,0),y.disconnect(R,0),y.disconnect(B,1),y.disconnect(_,1),E.disconnect(v),v.disconnect(P.inputs===void 0?P:P.inputs[0]),v.disconnect(I.inputs===void 0?I:I.inputs[0]),v.disconnect(b.inputs===void 0?b:b.inputs[0]),v.disconnect(O.inputs===void 0?O:O.inputs[0]),P.disconnect(C.gain),I.disconnect(R.gain),b.disconnect(B.gain),O.disconnect(_.gain),C.disconnect(g,0,0),B.disconnect(g,0,0),R.disconnect(g,0,1),_.disconnect(g,0,1)}}},h=(f,x,v,g,T)=>{if(x===1)return d(f,v,g,T);if(x===2)return m(f,v,g,T);throw i()};return(f,A)=>{var M=A,{channelCount:x,channelCountMode:v,pan:g}=M,T=Ze(M,["channelCount","channelCountMode","pan"]);if(v==="max")throw i();let S=t(f,F(w({},T),{channelCount:1,channelCountMode:v,numberOfInputs:2})),N=e(f,F(w({},T),{channelCount:x,channelCountMode:v,gain:1})),y=e(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g}),{connectGraph:C,disconnectGraph:P}=h(f,x,N,y,S);Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"maxValue",{get:()=>1}),Object.defineProperty(y.gain,"minValue",{get:()=>-1});let R={get bufferSize(){},get channelCount(){return N.channelCount},set channelCount(b){N.channelCount!==b&&(I&&P(),{connectGraph:C,disconnectGraph:P}=h(f,b,N,y,S),I&&C()),N.channelCount=b},get channelCountMode(){return N.channelCountMode},set channelCountMode(b){if(b==="clamped-max"||b==="max")throw i();N.channelCountMode=b},get channelInterpretation(){return N.channelInterpretation},set channelInterpretation(b){N.channelInterpretation=b},get context(){return N.context},get inputs(){return[N]},get numberOfInputs(){return N.numberOfInputs},get numberOfOutputs(){return N.numberOfOutputs},get pan(){return y.gain},addEventListener(...b){return N.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return N.dispatchEvent(b[0])},removeEventListener(...b){return N.removeEventListener(b[0],b[1],b[2])}},I=!1,E=()=>{C(),I=!0},B=()=>{P(),I=!1};return s(be(R,S),E,B)}}});var Fu,Ou=n(()=>{je();he();Fu=(t,o,e,r,i,s,c)=>(a,l)=>{let u=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return e(a,l);j(u,l);let p=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(p!==null&&p.length<2)throw o();Z(u,{curve:p},"curve"),Z(u,l,"oversample");let d=null,m=!1;return c(u,"curve",x=>()=>x.call(u),x=>v=>(x.call(u,v),m&&(r(v)&&d===null?d=t(a,u):!r(v)&&d!==null&&(d(),d=null)),v)),i(u,()=>{m=!0,r(u.curve)&&(d=t(a,u))},()=>{m=!1,d!==null&&(d(),d=null)})}});var _u,ku=n(()=>{he();ut();_u=(t,o,e,r,i)=>(s,u)=>{var p=u,{curve:c,oversample:a}=p,l=Ze(p,["curve","oversample"]);let d=s.createWaveShaper(),m=s.createWaveShaper();j(d,l),j(m,l);let h=e(s,F(w({},l),{gain:1})),f=e(s,F(w({},l),{gain:-1})),x=e(s,F(w({},l),{gain:1})),v=e(s,F(w({},l),{gain:-1})),g=null,T=!1,A=null,M={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(y){h.channelCount=y,f.channelCount=y,d.channelCount=y,x.channelCount=y,m.channelCount=y,v.channelCount=y},get channelCountMode(){return d.channelCountMode},set channelCountMode(y){h.channelCountMode=y,f.channelCountMode=y,d.channelCountMode=y,x.channelCountMode=y,m.channelCountMode=y,v.channelCountMode=y},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(y){h.channelInterpretation=y,f.channelInterpretation=y,d.channelInterpretation=y,x.channelInterpretation=y,m.channelInterpretation=y,v.channelInterpretation=y},get context(){return d.context},get curve(){return A},set curve(y){if(y!==null&&y.length<2)throw o();if(y===null)d.curve=y,m.curve=y;else{let C=y.length,P=new Float32Array(C+2-C%2),R=new Float32Array(C+2-C%2);P[0]=y[0],R[0]=-y[C-1];let I=Math.ceil((C+1)/2),E=(C+1)/2-1;for(let B=1;B<I;B+=1){let b=B/I*E,_=Math.floor(b),O=Math.ceil(b);P[B]=_===O?y[_]:(1-(b-_))*y[_]+(1-(O-b))*y[O],R[B]=_===O?-y[C-1-_]:-((1-(b-_))*y[C-1-_])-(1-(O-b))*y[C-1-O]}P[I]=C%2===1?y[I-1]:(y[I-2]+y[I-1])/2,d.curve=P,m.curve=R}A=y,T&&(r(A)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get oversample(){return d.oversample},set oversample(y){d.oversample=y,m.oversample=y},addEventListener(...y){return h.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return h.dispatchEvent(y[0])},removeEventListener(...y){return h.removeEventListener(y[0],y[1],y[2])}};c!==null&&(M.curve=c instanceof Float32Array?c:new Float32Array(c)),a!==M.oversample&&(M.oversample=a);let S=()=>{h.connect(d).connect(x),h.connect(f).connect(m).connect(v).connect(x),T=!0,r(A)&&(g=t(s,h))},N=()=>{h.disconnect(d),d.disconnect(x),h.disconnect(f),f.disconnect(m),m.disconnect(v),v.disconnect(x),T=!1,g!==null&&(g(),g=null)};return i(be(M,x),S,N)}});var ge,Du=n(()=>{ge=()=>new DOMException("","NotSupportedError")});var AS,Ru,Bu=n(()=>{ir();cr();AS={numberOfChannels:1},Ru=(t,o,e,r,i)=>class extends t{constructor(c,a,l){let u;if(typeof c=="number"&&a!==void 0&&l!==void 0)u={length:a,numberOfChannels:c,sampleRate:l};else if(typeof c=="object")u=c;else throw new Error("The given parameters are not valid.");let{length:p,numberOfChannels:d,sampleRate:m}=w(w({},AS),u),h=r(d,p,m);o(Oe,()=>Oe(h))||h.addEventListener("statechange",(()=>{let f=0,x=v=>{this._state==="running"&&(f>0?(h.removeEventListener("statechange",x),v.stopImmediatePropagation(),this._waitForThePromiseToSettle(v)):f+=1)};return x})()),super(h,d),this._length=p,this._nativeOfflineAudioContext=h,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Je(this)}))}_waitForThePromiseToSettle(c){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(c):setTimeout(()=>this._waitForThePromiseToSettle(c))}}});var ES,Lu,Vu=n(()=>{it();St();Tt();ES={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Lu=(t,o,e,r,i,s,c)=>class extends t{constructor(l,u){let p=i(l),d=w(w({},ES),u),m=e(p,d),h=s(p),f=h?r():null,x=l.sampleRate/2;super(l,!1,m,f),this._detune=o(this,h,m.detune,153600,-153600),this._frequency=o(this,h,m.frequency,x,-x),this._nativeOscillatorNode=m,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){let u=typeof l=="function"?c(this,l):null;this._nativeOscillatorNode.onended=u;let p=this._nativeOscillatorNode.onended;this._onended=p!==null&&p===u?l:p}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Pe(this);let u=()=>{this._nativeOscillatorNode.removeEventListener("ended",u),Ce(this)&&Ve(this)};this._nativeOscillatorNode.addEventListener("ended",u)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}}});var Wu,Hu=n(()=>{ve();Wu=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=null,a=null,l=null,u=(p,d)=>D(void 0,null,function*(){let m=e(p),h=Y(m,d);if(!h){let f={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,detune:m.detune.value,frequency:m.frequency.value,periodicWave:c===null?void 0:c,type:m.type};m=o(d,f),a!==null&&m.start(a),l!==null&&m.stop(l)}return s.set(d,m),h?(yield t(d,p.detune,m.detune),yield t(d,p.frequency,m.frequency)):(yield r(d,p.detune,m.detune),yield r(d,p.frequency,m.frequency)),yield i(p,d,m),m});return{set periodicWave(p){c=p},set start(p){a=p},set stop(p){l=p},render(p,d){let m=s.get(d);return m!==void 0?Promise.resolve(m):u(p,d)}}}});var IS,zu,Gu=n(()=>{$e();IS={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},zu=(t,o,e,r,i,s,c)=>class extends t{constructor(l,u){let p=i(l),d=w(w({},IS),u),m=e(p,d),h=s(p),f=h?r():null;super(l,!1,m,f),this._nativePannerNode=m,this._orientationX=o(this,h,m.orientationX,ae,ce),this._orientationY=o(this,h,m.orientationY,ae,ce),this._orientationZ=o(this,h,m.orientationZ,ae,ce),this._positionX=o(this,h,m.positionX,ae,ce),this._positionY=o(this,h,m.positionY,ae,ce),this._positionZ=o(this,h,m.positionZ,ae,ce),c(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}}});var Uu,qu=n(()=>{at();ve();Uu=(t,o,e,r,i,s,c,a,l,u)=>()=>{let p=new WeakMap,d=null,m=(h,f)=>D(void 0,null,function*(){let x=null,v=s(h),g={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},T=F(w({},g),{coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor}),A=Y(v,f);if("bufferSize"in v)x=r(f,F(w({},g),{gain:1}));else if(!A){let M=F(w({},T),{orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value});v=i(f,M)}if(p.set(f,x===null?v:x),x!==null){if(d===null){if(c===null)throw new Error("Missing the native OfflineAudioContext constructor.");let I=new c(6,h.context.length,f.sampleRate),E=o(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});E.connect(I.destination),d=(()=>D(void 0,null,function*(){let B=yield Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map((b,_)=>D(void 0,null,function*(){let O=e(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_===0?1:0});return yield a(I,b,O.offset),O})));for(let b=0;b<6;b+=1)B[b].connect(E,0,b),B[b].start(0);return u(I)}))()}let M=yield d,S=r(f,F(w({},g),{gain:1}));yield l(h,f,S);let N=[];for(let I=0;I<M.numberOfChannels;I+=1)N.push(M.getChannelData(I));let y=[N[0][0],N[1][0],N[2][0]],C=[N[3][0],N[4][0],N[5][0]],P=r(f,F(w({},g),{gain:1})),R=i(f,F(w({},T),{orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:C[0],positionY:C[1],positionZ:C[2]}));S.connect(P).connect(R.inputs[0]),R.connect(x);for(let I=128;I<M.length;I+=128){let E=[N[0][I],N[1][I],N[2][I]],B=[N[3][I],N[4][I],N[5][I]];if(E.some((b,_)=>b!==y[_])||B.some((b,_)=>b!==C[_])){y=E,C=B;let b=I/f.sampleRate;P.gain.setValueAtTime(0,b),P=r(f,F(w({},g),{gain:0})),R=i(f,F(w({},T),{orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:C[0],positionY:C[1],positionZ:C[2]})),P.gain.setValueAtTime(1,b),S.connect(P).connect(R.inputs[0]),R.connect(x)}}return x}return A?(yield t(f,h.orientationX,v.orientationX),yield t(f,h.orientationY,v.orientationY),yield t(f,h.orientationZ,v.orientationZ),yield t(f,h.positionX,v.positionX),yield t(f,h.positionY,v.positionY),yield t(f,h.positionZ,v.positionZ)):(yield a(f,h.orientationX,v.orientationX),yield a(f,h.orientationY,v.orientationY),yield a(f,h.orientationZ,v.orientationZ),yield a(f,h.positionX,v.positionX),yield a(f,h.positionY,v.positionY),yield a(f,h.positionZ,v.positionZ)),Ie(v)?yield l(h,f,v.inputs[0]):yield l(h,f,v),v});return{render(h,f){let x=p.get(f);return x!==void 0?Promise.resolve(x):m(h,f)}}}});var bS,ju,Yu=n(()=>{bS={disableNormalization:!1},ju=(t,o,e,r)=>class Xu{constructor(s,c){let a=o(s),l=r(w(w({},bS),c)),u=t(a,l);return e.add(u),u}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Xu.prototype||e.has(s)}}});var Zu,Ku=n(()=>{Zu=(t,o)=>(e,r,i)=>(t(r).replay(i),o(r,e,i))});var $u,Qu=n(()=>{$u=(t,o,e)=>(r,i,s)=>D(void 0,null,function*(){let c=t(r);yield Promise.all(c.activeInputs.map((a,l)=>Array.from(a).map(d=>D(void 0,[d],function*([u,p]){let h=yield o(u).render(u,i),f=r.context.destination;!e(u)&&(r!==f||!e(r))&&h.connect(s,p,l)}))).reduce((a,l)=>[...a,...l],[]))})});var Ju,ep=n(()=>{Ju=(t,o,e)=>(r,i,s)=>D(void 0,null,function*(){let c=o(r);yield Promise.all(Array.from(c.activeInputs).map(u=>D(void 0,[u],function*([a,l]){let d=yield t(a).render(a,i);e(a)||d.connect(s,l)})))})});var tp,rp=n(()=>{cr();tp=(t,o,e,r)=>i=>t(Oe,()=>Oe(i))?Promise.resolve(t(r,r)).then(s=>{if(!s){let c=e(i,512,0,1);i.oncomplete=()=>{c.onaudioprocess=null,c.disconnect()},c.onaudioprocess=()=>i.currentTime,c.connect(i.destination)}return i.startRendering()}):new Promise(s=>{let c=o(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{c.disconnect(),s(a.renderedBuffer)},c.connect(i.destination),i.startRendering()})});var op,np=n(()=>{op=t=>(o,e)=>{t.set(o,e)}});var ip,sp=n(()=>{ip=t=>(o,e)=>t.set(o,e)});var ap,cp=n(()=>{Br();ap=(t,o,e,r,i,s,c,a)=>(l,u)=>e(l).render(l,u).then(()=>Promise.all(Array.from(r(u)).map(p=>e(p).render(p,u)))).then(()=>i(u)).then(p=>(typeof p.copyFromChannel!="function"?(c(p),Et(p)):o(s,()=>s(p))||a(p),t.add(p),p))});var MS,lp,up=n(()=>{MS={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},lp=(t,o,e,r,i,s)=>class extends t{constructor(a,l){let u=i(a),p=w(w({},MS),l),d=e(u,p),m=s(u),h=m?r():null;super(a,!1,d,h),this._pan=o(this,m,d.pan)}get pan(){return this._pan}}});var pp,dp=n(()=>{at();ve();pp=(t,o,e,r,i)=>()=>{let s=new WeakMap,c=(a,l)=>D(void 0,null,function*(){let u=e(a),p=Y(u,l);if(!p){let d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=o(l,d)}return s.set(l,u),p?yield t(l,a.pan,u.pan):yield r(l,a.pan,u.pan),Ie(u)?yield i(a,l,u.inputs[0]):yield i(a,l,u),u});return{render(a,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):c(a,l)}}}});var mp,hp=n(()=>{mp=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch(o){return!1}return!0}});var fp,xp=n(()=>{fp=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createBuffer(1,1,44100);if(e.copyToChannel===void 0)return!0;let r=new Float32Array(2);try{e.copyFromChannel(r,0,0)}catch(i){return!1}return!0}});var vp,gp=n(()=>{vp=t=>()=>{if(t===null)return!1;if(t.prototype!==void 0&&t.prototype.close!==void 0)return!0;let o=new t,e=o.close!==void 0;try{o.close()}catch(r){}return e}});var yp,Cp=n(()=>{yp=t=>()=>{if(t===null)return Promise.resolve(!1);let o=new t(1,1,44100);return new Promise(e=>{let r=!0,i=c=>{r&&(r=!1,o.startRendering(),e(c instanceof TypeError))},s;try{s=o.decodeAudioData(null,()=>{},i)}catch(c){i(c)}s!==void 0&&s.catch(i)})}});var Np,wp=n(()=>{Np=t=>()=>{if(t===null)return!1;let o;try{o=new t({latencyHint:"balanced"})}catch(e){return!1}return o.close(),!0}});var Sp,Tp=n(()=>{Sp=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createGain(),r=e.connect(e)===e;return e.disconnect(e),r}});var Ap,Ep=n(()=>{Ap=(t,o)=>()=>D(void 0,null,function*(){if(t===null)return!0;if(o===null)return!1;let e=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new MessageChannel,i=new o(1,128,44100),s=URL.createObjectURL(e),c=!1;try{yield i.audioWorklet.addModule(s);let a=new t(i,"a",{numberOfOutputs:0}),l=i.createOscillator();yield new Promise(u=>{a.port.onmessage=()=>u(),a.port.postMessage(r.port2,[r.port2])}),a.port.onmessage=()=>c=!0,l.connect(a),l.start(0),yield i.startRendering(),c=yield new Promise(u=>{r.port1.onmessage=({data:p})=>u(p===1),r.port1.postMessage(0)})}catch(a){}finally{r.port1.close(),URL.revokeObjectURL(s)}return c})});var Ip,bp=n(()=>{Ip=(t,o)=>()=>D(void 0,null,function*(){if(t===null)return!0;if(o===null)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new o(1,128,44100),i=URL.createObjectURL(e),s=!1,c=!1;try{yield r.audioWorklet.addModule(i);let a=new t(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>c=!0,l.connect(a),l.start(0),yield r.startRendering(),yield new Promise(u=>setTimeout(u))}catch(a){}finally{URL.revokeObjectURL(i)}return s&&!c})});var Mp,Pp=n(()=>{Mp=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createChannelMerger();if(e.channelCountMode==="max")return!0;try{e.channelCount=2}catch(r){return!0}return!1}});var Fp,Op=n(()=>{Fp=t=>()=>{if(t===null)return!1;let o=new t(1,1,44100);return o.createConstantSource===void 0?!0:o.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}});var _p,kp=n(()=>{_p=t=>()=>{if(t===null)return!1;let o=new t(1,1,44100),e=o.createConvolver();e.buffer=o.createBuffer(1,1,o.sampleRate);try{e.buffer=o.createBuffer(1,1,o.sampleRate)}catch(r){return!1}return!0}});var Dp,Rp=n(()=>{Dp=t=>()=>{if(t===null)return!1;let e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch(r){return!1}return!0}});var Bp,Lp=n(()=>{Bp=t=>()=>t!==null&&t.hasOwnProperty("isSecureContext")});var Vp,Wp=n(()=>{Vp=t=>()=>{if(t===null)return!1;let o=new t;try{return o.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}finally{o.close()}}});var Hp,zp=n(()=>{Hp=(t,o)=>()=>{if(o===null)return Promise.resolve(!1);let e=new o(1,1,44100),r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{e.oncomplete=()=>{r.disconnect(),i(e.currentTime!==0)},e.startRendering()})}});var Gp,Up=n(()=>{Gp=t=>()=>{if(t===null)return Promise.resolve(!1);let o=new t(1,1,44100);if(o.createStereoPanner===void 0||o.createConstantSource===void 0)return Promise.resolve(!0);let e=o.createConstantSource(),r=o.createStereoPanner();return e.channelCount=1,e.offset.value=1,r.channelCount=1,e.start(),e.connect(r).connect(o.destination),o.startRendering().then(i=>i.getChannelData(0)[0]!==1)}});var rn,qp=n(()=>{rn=()=>new DOMException("","UnknownError")});var PS,jp,Xp=n(()=>{PS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},jp=(t,o,e,r,i,s,c)=>class extends t{constructor(l,u){let p=i(l),d=w(w({},PS),u),m=e(p,d),f=s(p)?r():null;super(l,!0,m,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=m,c(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw o();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}}});var Yp,Zp=n(()=>{at();ve();Yp=(t,o,e)=>()=>{let r=new WeakMap,i=(s,c)=>D(void 0,null,function*(){let a=o(s);if(!Y(a,c)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(c,u)}return r.set(c,a),Ie(a)?yield e(s,c,a.inputs[0]):yield e(s,c,a),a});return{render(s,c){let a=r.get(c);return a!==void 0?Promise.resolve(a):i(s,c)}}}});var Kp,$p=n(()=>{Kp=()=>typeof window=="undefined"?null:window});var Qp,Jp=n(()=>{Qp=(t,o)=>e=>{e.copyFromChannel=(r,i,s=0)=>{let c=t(s),a=t(i);if(a>=e.numberOfChannels)throw o();let l=e.length,u=e.getChannelData(a),p=r.length;for(let d=c<0?-c:0;d+c<l&&d<p;d+=1)r[d]=u[d+c]},e.copyToChannel=(r,i,s=0)=>{let c=t(s),a=t(i);if(a>=e.numberOfChannels)throw o();let l=e.length,u=e.getChannelData(a),p=r.length;for(let d=c<0?-c:0;d+c<l&&d<p;d+=1)u[d+c]=r[d]}}});var ed,td=n(()=>{ed=t=>o=>{o.copyFromChannel=(e=>(r,i,s=0)=>{let c=t(s),a=t(i);if(c<o.length)return e.call(o,r,a,c)})(o.copyFromChannel),o.copyToChannel=(e=>(r,i,s=0)=>{let c=t(s),a=t(i);if(c<o.length)return e.call(o,r,a,c)})(o.copyToChannel)}});var rd,od=n(()=>{rd=t=>(o,e)=>{let r=e.createBuffer(1,1,44100);o.buffer===null&&(o.buffer=r),t(o,"buffer",i=>()=>{let s=i.call(o);return s===r?null:s},i=>s=>i.call(o,s===null?r:s))}});var nd,id=n(()=>{nd=(t,o)=>(e,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});let i=e.createBufferSource();o(r,()=>{let a=r.numberOfInputs;for(let l=0;l<a;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))}});var on,sd=n(()=>{on=(t,o,e)=>t.copyFromChannel===void 0?t.getChannelData(e)[0]:(t.copyFromChannel(o,e),o[0])});var nn,ad=n(()=>{nn=t=>{if(t===null)return!1;let o=t.length;return o%2!==0?t[Math.floor(o/2)]!==0:t[o/2-1]+t[o/2]!==0}});var Lt,cd=n(()=>{Lt=(t,o,e,r)=>{let i=t;for(;!i.hasOwnProperty(o);)i=Object.getPrototypeOf(i);let{get:s,set:c}=Object.getOwnPropertyDescriptor(i,o);Object.defineProperty(t,o,{get:e(s),set:r(c)})}});var ld,ud=n(()=>{ld=t=>F(w({},t),{outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)})});var pd,dd=n(()=>{pd=t=>F(w({},t),{channelCount:t.numberOfOutputs})});var md,hd=n(()=>{md=t=>{let{imag:o,real:e}=t;return o===void 0?e===void 0?F(w({},t),{imag:[0,0],real:[0,0]}):F(w({},t),{imag:Array.from(e,()=>0),real:e}):e===void 0?F(w({},t),{imag:o,real:Array.from(o,()=>0)}):F(w({},t),{imag:o,real:e})}});var sn,fd=n(()=>{sn=(t,o,e)=>{try{t.setValueAtTime(o,e)}catch(r){if(r.code!==9)throw r;sn(t,o,e+1e-7)}}});var xd,vd=n(()=>{xd=t=>{let o=t.createBufferSource();o.start();try{o.start()}catch(e){return!0}return!1}});var gd,yd=n(()=>{gd=t=>{let o=t.createBufferSource(),e=t.createBuffer(1,1,44100);o.buffer=e;try{o.start(0,1)}catch(r){return!1}return!0}});var Cd,Nd=n(()=>{Cd=t=>{let o=t.createBufferSource();o.start();try{o.stop()}catch(e){return!1}return!0}});var Qr,wd=n(()=>{Qr=t=>{let o=t.createOscillator();try{o.start(-1)}catch(e){return e instanceof RangeError}return!1}});var an,Sd=n(()=>{an=t=>{let o=t.createBuffer(1,1,44100),e=t.createBufferSource();e.buffer=o,e.start(),e.stop();try{return e.stop(),!0}catch(r){return!1}}});var Jr,Td=n(()=>{Jr=t=>{let o=t.createOscillator();try{o.stop(-1)}catch(e){return e instanceof RangeError}return!1}});var Ad,Ed=n(()=>{Ad=t=>{let{port1:o,port2:e}=new MessageChannel;try{o.postMessage(t)}finally{o.close(),e.close()}}});var Id,bd=n(()=>{Id=()=>{try{new DOMException}catch(t){return!1}return!0}});var Md,Pd=n(()=>{Md=()=>new Promise(t=>{let o=new ArrayBuffer(0),{port1:e,port2:r}=new MessageChannel;e.onmessage=({data:i})=>t(i!==null),r.postMessage(o,[o])})});var Fd,Od=n(()=>{Fd=t=>{t.start=(o=>(e=0,r=0,i)=>{let s=t.buffer,c=s===null?r:Math.min(s.duration,r);s!==null&&c>s.duration-.5/t.context.sampleRate?o.call(t,e,0,0):o.call(t,e,c,i)})(t.start)}});var cn,_d=n(()=>{ut();cn=(t,o)=>{let e=o.createGain();t.connect(e);let r=(i=>()=>{i.call(t,e),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),be(t,e),t.stop=(i=>{let s=!1;return(c=0)=>{if(s)try{i.call(t,c)}catch(a){e.gain.setValueAtTime(0,c)}else i.call(t,c),s=!0}})(t.stop)}});var pt,kd=n(()=>{pt=(t,o)=>e=>{let r={value:t};return Object.defineProperties(e,{currentTarget:r,target:r}),typeof o=="function"?o.call(t,e):o.handleEvent.call(t,e)}});var Dd=n(()=>{});var Rd=n(()=>{});var Bd=n(()=>{});var Ld=n(()=>{});var Vd=n(()=>{});var Wd=n(()=>{});var Hd=n(()=>{});var zd=n(()=>{});var Gd=n(()=>{});var Ud=n(()=>{});var qd=n(()=>{});var jd=n(()=>{});var Xd=n(()=>{});var Yd=n(()=>{});var Zd=n(()=>{});var Kd=n(()=>{});var $d=n(()=>{});var Qd=n(()=>{});var Jd=n(()=>{});var em=n(()=>{});var tm=n(()=>{});var rm=n(()=>{});var om=n(()=>{});var nm=n(()=>{});var im=n(()=>{});var sm=n(()=>{});var am=n(()=>{});var cm=n(()=>{});var lm=n(()=>{});var um=n(()=>{});var pm=n(()=>{});var dm=n(()=>{});var mm=n(()=>{});var hm=n(()=>{});var fm=n(()=>{});var xm=n(()=>{});var vm=n(()=>{});var gm=n(()=>{});var ym=n(()=>{});var Cm=n(()=>{});var Nm=n(()=>{});var wm=n(()=>{});var Sm=n(()=>{});var Tm=n(()=>{});var Am=n(()=>{});var Em=n(()=>{});var Im=n(()=>{});var bm=n(()=>{});var Mm=n(()=>{});var Pm=n(()=>{});var Fm=n(()=>{});var Om=n(()=>{});var _m=n(()=>{});var km=n(()=>{});var Dm=n(()=>{});var Rm=n(()=>{});var Bm=n(()=>{});var Lm=n(()=>{});var Vm=n(()=>{});var Wm=n(()=>{});var Hm=n(()=>{});var zm=n(()=>{});var Gm=n(()=>{});var Um=n(()=>{});var qm=n(()=>{});var jm=n(()=>{});var Xm=n(()=>{});var Ym=n(()=>{});var Zm=n(()=>{});var Km=n(()=>{});var $m=n(()=>{});var Qm=n(()=>{});var Jm=n(()=>{});var eh=n(()=>{});var th=n(()=>{});var rh=n(()=>{});var oh=n(()=>{});var nh=n(()=>{});var ih=n(()=>{});var sh=n(()=>{});var ah=n(()=>{});var ch=n(()=>{});var lh=n(()=>{});var uh=n(()=>{});var ph=n(()=>{Dd();Rd();Bd();Ld();Vd();Wd();Hd();zd();Gd();Ud();qd();jd();Xd();Yd();Zd();Kd();$d();Qd();Jd();em();tm();rm();om();nm();im();sm();am();cm();lm();um();pm();dm();mm();hm();fm();xm();vm();gm();ym();Cm();Nm();wm();Sm();Tm();Am();Em();Im();bm();Mm();Pm();Fm();Om();_m();km();Dm();Rm();Bm();Lm();Vm();Wm();Hm();zm();Gm();Um();qm();jm();Xm();Ym();Zm();Km();$m();Qm();Jm();eh();th();rh();oh();nh();ih();sh();ah();ch();lh();uh()});var dh=n(()=>{});var mh=n(()=>{});var hh=n(()=>{});var fh=n(()=>{});var xh=n(()=>{});var vh=n(()=>{});var gh=n(()=>{});var yh=n(()=>{});var Ch=n(()=>{});var Nh=n(()=>{});var wh=n(()=>{});var Sh=n(()=>{});var Th=n(()=>{});var Ah=n(()=>{});var Eh=n(()=>{});var Ih=n(()=>{});var bh=n(()=>{});var Mh=n(()=>{});var Ph=n(()=>{});var Fh=n(()=>{});var Oh=n(()=>{});var _h=n(()=>{});var kh=n(()=>{});var Dh=n(()=>{});var Rh=n(()=>{});var Bh=n(()=>{});var Lh=n(()=>{});var Vh=n(()=>{});var Wh=n(()=>{});var Hh=n(()=>{});var zh=n(()=>{});var Gh=n(()=>{});var Uh=n(()=>{});var qh=n(()=>{});var jh=n(()=>{});var Xh=n(()=>{});var Yh=n(()=>{});var Zh=n(()=>{});var Kh=n(()=>{});var $h=n(()=>{});var Qh=n(()=>{});var Jh=n(()=>{});var ef=n(()=>{});var tf=n(()=>{});var rf=n(()=>{});var of=n(()=>{});var nf=n(()=>{});var sf=n(()=>{});var af=n(()=>{});var cf=n(()=>{});var lf=n(()=>{});var uf=n(()=>{});var pf=n(()=>{});var df=n(()=>{});var mf=n(()=>{});var hf=n(()=>{});var ff=n(()=>{});var xf=n(()=>{});var vf=n(()=>{});var gf=n(()=>{});var yf=n(()=>{});var Cf=n(()=>{});var Nf=n(()=>{});var wf=n(()=>{});var Sf=n(()=>{});var Tf=n(()=>{});var Af=n(()=>{});var Ef=n(()=>{});var If=n(()=>{});var bf=n(()=>{});var Mf=n(()=>{});var Pf=n(()=>{});var Ff=n(()=>{});var Of=n(()=>{});var _f=n(()=>{});var kf=n(()=>{});var Df=n(()=>{});var Rf=n(()=>{});var Bf=n(()=>{});var Lf=n(()=>{});var Vf=n(()=>{});var Wf=n(()=>{});var Hf=n(()=>{});var zf=n(()=>{});var Gf=n(()=>{});var Uf=n(()=>{});var qf=n(()=>{});var jf=n(()=>{});var Xf=n(()=>{});var Yf=n(()=>{});var Zf=n(()=>{});var Kf=n(()=>{});var $f=n(()=>{});var Qf=n(()=>{});var Jf=n(()=>{});var ex=n(()=>{});var tx=n(()=>{});var rx=n(()=>{});var ox=n(()=>{});var nx=n(()=>{});var ix=n(()=>{});var sx=n(()=>{});var ax=n(()=>{});var cx=n(()=>{});var lx=n(()=>{});var ux=n(()=>{});var px=n(()=>{});var dx=n(()=>{});var mx=n(()=>{});var hx=n(()=>{});var fx=n(()=>{});var xx=n(()=>{});var vx=n(()=>{});var gx=n(()=>{});var yx=n(()=>{});var Cx=n(()=>{});var Nx=n(()=>{});var wx=n(()=>{});var Sx=n(()=>{});var Tx=n(()=>{});var Ax=n(()=>{});var Ex=n(()=>{});var Ix=n(()=>{});var bx=n(()=>{});var Mx=n(()=>{});var Px=n(()=>{});var Fx=n(()=>{});var Ox=n(()=>{});var _x=n(()=>{});var kx=n(()=>{});var Dx=n(()=>{});var Rx=n(()=>{});var Bx=n(()=>{});var Lx=n(()=>{});var Vx=n(()=>{});var Wx=n(()=>{});var Hx=n(()=>{});var zx=n(()=>{});var Gx=n(()=>{});var Ux=n(()=>{});var qx=n(()=>{});var jx=n(()=>{});var Xx=n(()=>{});var Yx=n(()=>{});var Zx=n(()=>{});var Kx=n(()=>{});var $x=n(()=>{});var Qx=n(()=>{});var Jx=n(()=>{});var ev=n(()=>{});var tv=n(()=>{});var rv=n(()=>{});var ov=n(()=>{});var nv=n(()=>{});var iv=n(()=>{});var sv=n(()=>{});var av=n(()=>{});var cv=n(()=>{});var lv=n(()=>{});var uv=n(()=>{});var pv=n(()=>{});var dv=n(()=>{});var mv=n(()=>{});var hv=n(()=>{});var fv=n(()=>{});var xv=n(()=>{});var vv=n(()=>{});var gv=n(()=>{});var yv=n(()=>{});var Cv=n(()=>{});var Nv=n(()=>{});var wv=n(()=>{});var Sv=n(()=>{});var Tv=n(()=>{});var Av=n(()=>{});var Ev=n(()=>{});var Iv=n(()=>{});var bv=n(()=>{});var Mv=n(()=>{});var Pv=n(()=>{});var Fv=n(()=>{});var Ov=n(()=>{});var _v=n(()=>{});var kv=n(()=>{});var Dv=n(()=>{});var Rv=n(()=>{});var Bv=n(()=>{});var Lv=n(()=>{});var Vv=n(()=>{});var Wv=n(()=>{});var Hv=n(()=>{});var zv=n(()=>{});var Gv=n(()=>{});var Uv=n(()=>{});var qv=n(()=>{});var jv=n(()=>{});var Xv=n(()=>{});var Yv=n(()=>{});var Zv=n(()=>{});var Kv=n(()=>{});var $v=n(()=>{});var Qv=n(()=>{});var Jv=n(()=>{});var eg=n(()=>{});var tg=n(()=>{});var rg=n(()=>{});var og=n(()=>{});var ng=n(()=>{});var ig=n(()=>{});var sg=n(()=>{});var ag=n(()=>{});var cg=n(()=>{});var lg=n(()=>{});var ug=n(()=>{});var pg=n(()=>{});var dg=n(()=>{});var mg=n(()=>{});var hg=n(()=>{});var fg=n(()=>{});var xg=n(()=>{});var vg=n(()=>{});var gg=n(()=>{});var yg=n(()=>{});var Cg=n(()=>{});var Ng=n(()=>{});var wg=n(()=>{});var Sg=n(()=>{});var Tg=n(()=>{});var Ag=n(()=>{});var Eg=n(()=>{});var Ig=n(()=>{});var bg=n(()=>{});var Mg=n(()=>{});var Pg=n(()=>{});var Fg=n(()=>{});var Og=n(()=>{});var _g=n(()=>{});var kg=n(()=>{});var Dg=n(()=>{});var Rg=n(()=>{});var Bg=n(()=>{});var Lg=n(()=>{});var Vg=n(()=>{});var Wg=n(()=>{});var Hg=n(()=>{});var zg=n(()=>{});var Gg=n(()=>{});var Ug=n(()=>{});var qg=n(()=>{});var jg=n(()=>{});var Xg=n(()=>{});var Yg=n(()=>{});var Zg=n(()=>{});var Kg=n(()=>{});var $g=n(()=>{});var Qg=n(()=>{});var Jg=n(()=>{});var ey=n(()=>{});var ty=n(()=>{});var ry=n(()=>{});var oy=n(()=>{});var ny=n(()=>{});var iy=n(()=>{});var sy=n(()=>{});var ay=n(()=>{});var cy=n(()=>{});var ly=n(()=>{});var uy=n(()=>{});var py=n(()=>{});var dy=n(()=>{});var my=n(()=>{});var hy=n(()=>{});var fy=n(()=>{});var xy=n(()=>{});var vy=n(()=>{});var gy=n(()=>{});var yy=n(()=>{});var Cy=n(()=>{});var Ny=n(()=>{});var wy=n(()=>{});var Sy=n(()=>{});var Ty=n(()=>{});var Ay=n(()=>{});var Ey=n(()=>{});var Iy=n(()=>{});var by=n(()=>{});var My=n(()=>{});var Py=n(()=>{});var Fy=n(()=>{});var Oy=n(()=>{});var _y=n(()=>{});var ky=n(()=>{});var Dy=n(()=>{});var Ry=n(()=>{});var By=n(()=>{});var Ly=n(()=>{});var Vy=n(()=>{});var Wy=n(()=>{});var Hy=n(()=>{});var zy=n(()=>{});var Gy=n(()=>{});var Uy=n(()=>{});var qy=n(()=>{});var jy=n(()=>{});var Xy=n(()=>{});var Yy=n(()=>{});var Zy=n(()=>{});var Ky=n(()=>{});var $y=n(()=>{});var Qy=n(()=>{});var Jy=n(()=>{});var eC=n(()=>{});var tC=n(()=>{});var rC=n(()=>{});var oC=n(()=>{});var nC=n(()=>{});var iC=n(()=>{});var sC=n(()=>{});var aC=n(()=>{});var cC=n(()=>{});var lC=n(()=>{});var uC=n(()=>{});var pC=n(()=>{});var dC=n(()=>{});var mC=n(()=>{});var hC=n(()=>{});var fC=n(()=>{});var xC=n(()=>{});var vC=n(()=>{});var gC=n(()=>{});var yC=n(()=>{});var CC=n(()=>{});var NC=n(()=>{});var wC=n(()=>{});var SC=n(()=>{});var TC=n(()=>{});var AC=n(()=>{});var EC=n(()=>{});var IC=n(()=>{});var bC=n(()=>{});var MC=n(()=>{});var PC=n(()=>{});var FC=n(()=>{});var OC=n(()=>{});var _C=n(()=>{});var kC=n(()=>{});var DC=n(()=>{});var RC=n(()=>{});var BC=n(()=>{});var LC=n(()=>{});var VC=n(()=>{});var WC=n(()=>{});var HC=n(()=>{});var zC=n(()=>{});var GC=n(()=>{});var UC=n(()=>{});var qC=n(()=>{});var jC=n(()=>{});var XC=n(()=>{});var YC=n(()=>{});var ZC=n(()=>{});var KC=n(()=>{});var $C=n(()=>{});var QC=n(()=>{});var JC=n(()=>{});var eN=n(()=>{});var tN=n(()=>{});var rN=n(()=>{});var oN=n(()=>{});var nN=n(()=>{});var iN=n(()=>{});var sN=n(()=>{});var aN=n(()=>{});var cN=n(()=>{});var lN=n(()=>{});var uN=n(()=>{});var pN=n(()=>{});var dN=n(()=>{});var mN=n(()=>{});var hN=n(()=>{});var fN=n(()=>{});var xN=n(()=>{});var vN=n(()=>{});var gN=n(()=>{});var yN=n(()=>{});var CN=n(()=>{});var NN=n(()=>{});var wN=n(()=>{});var SN=n(()=>{});var TN=n(()=>{});var AN=n(()=>{});var EN=n(()=>{});var IN=n(()=>{});var bN=n(()=>{});var MN=n(()=>{});var PN=n(()=>{dh();mh();hh();fh();xh();vh();gh();yh();Ch();Nh();wh();Sh();Th();Ah();Eh();Ih();bh();Mh();Ph();Fh();Oh();_h();kh();Dh();Rh();Bh();Lh();Vh();Wh();Hh();zh();Gh();Uh();qh();jh();Xh();Yh();Zh();Kh();$h();Qh();Jh();ef();tf();rf();of();nf();sf();af();cf();lf();uf();pf();df();mf();hf();ff();xf();vf();gf();yf();Cf();Nf();wf();Sf();Tf();Af();Ef();If();bf();Mf();Pf();Ff();Of();_f();kf();Df();Rf();Bf();Lf();Vf();Wf();Hf();zf();Gf();Uf();qf();jf();Xf();Yf();Zf();Kf();$f();Qf();Jf();ex();tx();rx();ox();nx();ix();sx();ax();cx();lx();ux();px();dx();mx();hx();fx();xx();vx();gx();yx();Cx();Nx();wx();Sx();Tx();Ax();Ex();Ix();bx();Mx();Px();Fx();Ox();_x();kx();Dx();Rx();Bx();Lx();Vx();Wx();Hx();zx();Gx();Ux();qx();jx();Xx();Yx();Zx();Kx();$x();Qx();Jx();ev();tv();rv();ov();nv();iv();sv();av();cv();lv();uv();pv();dv();mv();hv();fv();xv();vv();gv();yv();Cv();Nv();wv();Sv();Tv();Av();Ev();Iv();bv();Mv();Pv();Fv();Ov();_v();kv();Dv();Rv();Bv();Lv();Vv();Wv();Hv();zv();Gv();Uv();qv();jv();Xv();Yv();Zv();Kv();$v();Qv();Jv();eg();tg();rg();og();ng();ig();sg();ag();cg();lg();ug();pg();dg();mg();hg();fg();xg();vg();gg();yg();Cg();Ng();wg();Sg();Tg();Ag();Eg();Ig();bg();Mg();Pg();Fg();Og();_g();kg();Dg();Rg();Bg();Lg();Vg();Wg();Hg();zg();Gg();Ug();qg();jg();Xg();Yg();Zg();Kg();$g();Qg();Jg();ey();ty();ry();oy();ny();iy();sy();ay();cy();ly();uy();py();dy();my();hy();fy();xy();vy();gy();yy();Cy();Ny();wy();Sy();Ty();Ay();Ey();Iy();by();My();Py();Fy();Oy();_y();ky();Dy();Ry();By();Ly();Vy();Wy();Hy();zy();Gy();Uy();qy();jy();Xy();Yy();Zy();Ky();$y();Qy();Jy();eC();tC();rC();oC();nC();iC();sC();aC();cC();lC();uC();pC();dC();mC();hC();fC();xC();vC();gC();yC();CC();NC();wC();SC();TC();AC();EC();IC();bC();MC();PC();FC();OC();_C();kC();DC();RC();BC();LC();VC();WC();HC();zC();GC();UC();qC();jC();XC();YC();ZC();KC();$C();QC();JC();eN();tN();rN();oN();nN();iN();sN();aN();cN();lN();uN();pN();dN();mN();hN();fN();xN();vN();gN();yN();CN();NN();wN();SN();TN();AN();EN();IN();bN();MN()});var Sw={};Yw(Sw,{AnalyserNode:()=>BN,AudioBuffer:()=>VN,AudioBufferSourceNode:()=>HN,AudioContext:()=>l0,AudioWorkletNode:()=>g0,BiquadFilterNode:()=>zN,ChannelMergerNode:()=>GN,ChannelSplitterNode:()=>UN,ConstantSourceNode:()=>qN,ConvolverNode:()=>XN,DelayNode:()=>YN,DynamicsCompressorNode:()=>KN,GainNode:()=>$N,IIRFilterNode:()=>QN,MediaElementAudioSourceNode:()=>hw,MediaStreamAudioDestinationNode:()=>fw,MediaStreamAudioSourceNode:()=>xw,MediaStreamTrackAudioSourceNode:()=>vw,MinimalAudioContext:()=>y0,MinimalOfflineAudioContext:()=>C0,OfflineAudioContext:()=>N0,OscillatorNode:()=>tw,PannerNode:()=>nw,PeriodicWave:()=>iw,StereoPannerNode:()=>aw,WaveShaperNode:()=>cw,addAudioWorkletModule:()=>pw,decodeAudioData:()=>dw,isAnyAudioContext:()=>w0,isAnyAudioNode:()=>S0,isAnyAudioParam:()=>T0,isAnyOfflineAudioContext:()=>A0,isSupported:()=>E0});var FS,OS,_S,ON,kS,Se,_e,_N,ln,ye,DS,re,xe,te,kN,DN,Xe,un,pn,RN,Vt,le,BN,dn,FN,LN,mn,hn,VN,eo,WN,He,Wt,ze,RS,ke,HN,BS,LS,dt,zN,tt,VS,rt,WS,GN,HS,UN,zS,Ht,GS,qN,jN,US,XN,qS,YN,ZN,jS,KN,XS,$N,YS,to,ZS,KS,QN,$S,JN,fn,ew,QS,tw,rw,JS,ro,e0,ow,t0,nw,r0,iw,o0,sw,n0,aw,i0,cw,lw,xn,uw,s0,pw,a0,dw,mw,hw,fw,xw,c0,vw,l0,vn,u0,gw,p0,yw,Cw,d0,m0,h0,f0,x0,v0,g0,y0,Nw,ww,C0,N0,w0,S0,T0,A0,E0,Tw=n(()=>{To();hi();xi();gi();Ci();Mi();Fi();_i();Di();Bi();Vi();Hi();Ui();ji();Yi();ls();ps();ms();fs();bs();Ps();Os();ks();Ls();Ws();zs();Us();js();Ys();Ks();Qs();ea();ra();na();sa();ca();ua();da();ha();xa();ga();Ca();Sa();Aa();Ia();Ma();Fa();_a();Ba();Va();Ha();Ga();qa();Xa();Za();$a();Ja();tc();oc();ic();ac();lc();pc();mc();fc();vc();yc();Sc();Ac();Ic();Po();Ko();ar();Mc();Fc();_c();Dc();Bc();Vc();Hc();Gc();qc();Xc();Zc();$c();Jc();tl();ol();il();al();ll();pl();xl();gl();wl();Tl();El();bl();Ol();Wl();Hl();Gl();jl();Yl();Kl();Ql();Jl();tu();ru();nu();au();lu();pu();mu();fu();vu();yu();Nu();Su();Au();Eu();bu();Pu();Ou();ku();Du();Bu();Vu();Hu();Gu();qu();Yu();Ku();Qu();ep();rp();np();sp();cp();up();dp();hp();xp();gp();Cp();wp();Tp();Ep();bp();Pp();Op();kp();Rp();Lp();Wp();zp();Up();qp();Xp();Zp();$p();Jp();td();od();id();fe();ko();Lo();nr();Lr();wt();sd();Gr();Vo();Be();sr();it();ad();Wo();Ho();cd();rr();ud();dd();hd();fd();Mo();vd();yd();Nd();wd();Sd();Td();Ed();bd();cr();Pd();Od();_d();kd();ph();PN();FS=fi(Fe),OS=Oi(Fe),_S=Pa(Ke),ON=new WeakMap,kS=cc(ON),Se=qs(new Map,new WeakMap),_e=Kp(),_N=fl(Se,Ee),ln=sc(me),ye=$u(me,ln,qe),DS=Wi(_N,ee,ye),re=hc(Nt),xe=xu(_e),te=Uc(xe),kN=new WeakMap,DN=Ya(pt),Xe=Sl(_e),un=Rc(Xe),pn=Lc(_e),RN=Wc(_e),Vt=Il(_e),le=Is(vi(Or),Pi(FS,OS,It,_S,bt,me,kS,Le,ee,Fe,Ce,qe,Mt),Se,Ec(Jt,bt,me,ee,ct,Ce),Ee,_t,ge,Ta(It,Jt,me,ee,ct,re,Ce,te),Ra(kN,me,pe),DN,re,un,pn,RN,te,Vt),BN=Li(le,DS,Ee,_N,re,te),dn=new WeakSet,FN=vl(_e),LN=pa(new Uint32Array(1)),mn=Qp(LN,Ee),hn=ed(LN),VN=zi(dn,Se,ge,FN,xe,mp(FN),mn,hn),eo=ki(Ne),WN=Ju(ln,Qe,qe),He=ta(WN),Wt=Nl(eo,Se,xd,gd,Cd,Qr,an,Jr,Fd,rd(Lt),cn),ze=Zu(uc(Qe),WN),RS=Xi(He,Wt,ee,ze,ye),ke=Ms(yi(_r),kN,Qt,Fs,yo,Co,No,wo,So,vt,Xt,Xe,sn),HN=qi(le,RS,ke,ne,Wt,re,te,pt),BS=us(le,ds,Ee,ne,Al(Ne,Lt),re,te,ye),LS=Gs(He,en,ee,ze,ye),dt=ip(ON),zN=Hs(le,ke,LS,_t,en,re,te,dt),tt=ul(Fe,pn),VS=nd(ne,tt),rt=zl(Xe,VS),WS=Zs(rt,ee,ye),GN=Xs(le,WS,rt,re,te),HS=Js(Rt,ee,ye),UN=$s(le,HS,Rt,re,te,pd),zS=Zl(eo,Wt,Ne,tt),Ht=Xl(eo,Se,zS,Qr,Jr),GS=la(He,Ht,ee,ze,ye),qN=aa(le,ke,GS,Ht,re,te,pt),jN=$l(ge,Lt),US=fa(jN,ee,ye),XN=ma(le,US,jN,re,te,dt),qS=ba(He,tn,ee,ze,ye),YN=Ea(le,ke,qS,tn,re,te,dt),ZN=eu(ge),jS=za(He,ZN,ee,ze,ye),KN=Wa(le,ke,jS,ZN,ge,re,te,dt),XS=rc(He,Ne,ee,ze,ye),$N=ec(le,ke,XS,Ne,re,te),YS=su(_t,ne,Bt,ge),to=tp(Se,Ne,Bt,Hp(Ne,xe)),ZS=Tc(Wt,ee,xe,ye,to),KS=ou(YS),QN=wc(le,KS,ZS,re,te,dt),$S=hs(ke,rt,Ht,Bt,ge,on,te,Lt),JN=new WeakMap,fn=sl(BS,$S,DN,te,JN,pt),ew=gu(eo,Se,Qr,an,Jr,cn),QS=Wu(He,ew,ee,ze,ye),tw=Lu(le,ke,ew,QS,re,te,pt),rw=ia(Wt),JS=_u(rw,ne,Ne,nn,tt),ro=Fu(rw,ne,JS,nn,tt,Xe,Lt),e0=wu(It,ne,rt,Ne,Bt,ro,ge,bt,on,tt),ow=Cu(e0),t0=Uu(He,rt,Ht,Ne,ow,ee,xe,ze,ye,to),nw=zu(le,ke,ow,t0,re,te,dt),r0=Tu(Ee),iw=ju(r0,re,new WeakSet,md),o0=Mu(rt,Rt,Ne,ro,ge,tt),sw=Iu(o0,ge),n0=pp(He,sw,ee,ze,ye),aw=lp(le,ke,sw,n0,re,te),i0=Yp(ro,ee,ye),cw=jp(le,ne,ro,i0,re,te,dt),lw=jc(_e),xn=Ka(_e),uw=new WeakMap,s0=xc(uw,xe),pw=lw?bi(Se,ge,ja(_e),xn,Qa(mi),re,s0,te,Vt,new WeakMap,new WeakMap,Ip(Vt,xe),_e):void 0,a0=zc(un,te),dw=wa(dn,Se,ya,Ua,new WeakSet,re,a0,At,Oe,mn,hn),mw=Vs(pw,BN,VN,HN,zN,GN,UN,qN,XN,dw,YN,KN,$N,QN,fn,tw,nw,iw,aw,cw),hw=Kc(le,cu,re,te),fw=Qc(le,uu,re,te),xw=el(le,du,re,te),c0=hu(ne,te),vw=rl(le,c0,re),l0=cs(mw,ne,ge,rn,hw,fw,xw,vw,Xe),vn=gc(JN),u0=Ri(vn),gw=oa(Ee),p0=Oa(vn),yw=La(Ee),Cw=new WeakMap,d0=nc(Cw,pe),m0=Vl(gw,Ee,ne,rt,Rt,Ht,Ne,Bt,ge,yw,xn,d0,tt),h0=Fl(ne,m0,Ne,ge,tt),f0=Bs(He,gw,Wt,rt,Rt,Ht,Ne,p0,yw,xn,ee,Vt,xe,ze,ye,to),x0=dc(uw),v0=op(Cw),g0=lw?_s(u0,le,ke,f0,h0,me,x0,re,te,Vt,ld,v0,Ad,pt):void 0,y0=nl(ne,ge,rn,fn,Xe),Nw=va(ge,xe),ww=ap(dn,Se,ln,vn,to,At,mn,hn),C0=cl(Se,ne,Nw,fn,ww),N0=Ru(mw,Se,ne,Nw,ww),w0=bc(Nt,un),S0=Pc(Ct,pn),T0=Oc(Qt,RN),A0=kc(Nt,te),E0=()=>Yc(Se,fp(xe),vp(Xe),yp(xe),Np(Xe),Sp(xe),Ap(Vt,xe),Mp(xe),Fp(xe),_p(xe),Dp(xe),Id,Bp(_e),Vp(Xe),Gp(xe),Md)});var Mw=Xw((bU,bw)=>{"use strict";function I0(t){for(var o=1/0,e=-1/0,r=0,i=t.length,s;r<i;r++)s=t[r],o>s&&(o=s),e<s&&(e=s);return{min:o,max:e}}function Aw(t,o){var e=Math.pow(2,o-1),r=t<0?t*e:t*(e-1);return Math.max(-e,Math.min(e-1,r))}function Ew(t,o,e){var r,i=t.length,s=Math.ceil(i/o),c,a,l,u,p,d,m=Iw(e,s*2);for(r=0;r<s;r++)c=r*o,a=(r+1)*o>i?i:(r+1)*o,l=t.subarray(c,a),d=I0(l),p=Aw(d.min,e),u=Aw(d.max,e),m[r*2]=p,m[r*2+1]=u;return m}function Iw(t,o){return new(new Function(`return Int${t}Array`)())(o)}function b0(t,o){var e=t.length,r=1/e,i=t[0].length/2,s=0,c=0,a,l,u=Iw(o,i*2);for(c=0;c<i;c++){for(a=0,l=0,s=0;s<e;s++)a+=r*t[s][c*2],l+=r*t[s][c*2+1];u[c*2]=a,u[c*2+1]=l}return[u]}function oo(t,o){return typeof t=="number"?t:o}bw.exports=function(t,o,e,r,i,s){if(o=oo(o,1e3),s=oo(s,16),e==null&&(e=!0),[8,16,32].indexOf(s)<0)throw new Error("Invalid number of bits specified for peaks.");var c=t.numberOfChannels,a=[],l,u,p,d;if(r=oo(r,0),i=oo(i,t.length),typeof t.subarray=="undefined")for(l=0;l<c;l++)p=t.getChannelData(l),d=p.subarray(r,i),a.push(Ew(d,o,s));else a.push(Ew(t.subarray(r,i),o,s));return e&&a.length>1&&(a=b0(a,s)),u=a[0].length/2,{length:u,data:a,bits:s}}});var De=(t,o)=>{let e=t.target===document.body,r=o.uiContainer.contains(t.target),i=o.playerControlsContainer.contains(t.target),s=o.videoElement.contains(t.target),c=o.canvas.contains(t.target);return r||i||s||c||e};function dr(t){return t.pointerType==="touch"&&t.isPrimary===!1}function wn(t,o){if(!De(t,o))return;let e=o.uiContainer.contains(t.target),r=o.playerControlsContainer.contains(t.target);if(e||r)return;let i=o.videoElement;i.tagName==="VIDEO"&&(i.paused||(o.currentTool=null,i.pause(),o.raf(()=>D(this,null,function*(){o.redrawFullCanvas()}))))}function Sn(t,o){var e;De(t,o)&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),(e=t.clipboardData)==null||e.setData("application/json",JSON.stringify(o.saveCurrentFrame())))}function Tn(t,o){var r;if(!De(t,o))return;t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();let e=o.saveCurrentFrame();o.replaceFrame(o.playbackFrame,[]),o.redrawFullCanvas(),(r=t.clipboardData)==null||r.setData("application/json",JSON.stringify(e))}function An(t,o){if(!De(t,o))return;let e=o.videoElement;e.tagName==="VIDEO"&&(t.key==="ArrowLeft"||t.key==="ArrowRight"?(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),t.key==="ArrowLeft"?o.prevFrame():t.key==="ArrowRight"&&o.nextFrame()):t.code==="Space"&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.paused?e.play().then(()=>{o.redrawFullCanvas()}):(e.pause(),o.raf(()=>{o.redrawFullCanvas()}))))}function En(t,o){var s,c,a,l,u;if(!De(t,o))return;let e=(c=(s=t.clipboardData)==null?void 0:s.types)!=null?c:[];if(e.includes("application/json"))t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();else if(e.includes("Files")){let p=(a=t.clipboardData)==null?void 0:a.files;if(p&&p.length>0){let d=p[0];if(d.type.startsWith("image/")){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();let m=new Image;m.addEventListener("load",()=>{let h=m.naturalWidth/m.naturalHeight,f=.25,x=f/h*o.aspectRatio;o.addShapesToFrame(o.playbackFrame,[{type:"image",image:m,x:0,y:0,width:f,height:x,strokeStyle:"red",fillStyle:"red",lineWidth:2}]),o.redrawFullCanvas(),o.raf(()=>{o.show()}),o.currentTool="move"},{once:!0}),m.src=URL.createObjectURL(d),o.redrawFullCanvas()}}}else if(e.includes("text/plain")){let p=(l=t.clipboardData)==null?void 0:l.getData("text/plain");p&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),o.addShapesToFrame(o.playbackFrame,[{type:"text",text:p,x:.4,y:.4,strokeStyle:o.ctx.strokeStyle,fillStyle:o.ctx.fillStyle,lineWidth:o.ctx.lineWidth}]),o.show(),o.currentTool="move",o.redrawFullCanvas())}else return;let r=(u=t.clipboardData)==null?void 0:u.getData("application/json");if(!r)return;let i=JSON.parse(r);i&&i.shapes&&i.version===1&&(o.addShapesToFrame(o.playbackFrame,i.shapes),o.redrawFullCanvas())}function In(t,o){let e=document.createElement("button");e.type="button",e.style.margin="5px",e.style.float="right",e.title="Download current frame",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path></svg>',o.addEvent(e,"click",()=>{let r=o.frameToDataUrl();if(!r)return;let i=document.createElement("a");i.download=`frame_${String(o.activeTimeFrame).padStart(3,"0")}.png`,i.href=r,i.click()}),o.buttons.push(e),o.playerControlsContainer.appendChild(e)}var bn='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-x"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="22" x2="16" y1="9" y2="15"></line><line x1="16" x2="22" y1="9" y2="15"></line></svg>',Mn='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></svg>';function Pn(t,o){let e=document.createElement("button");e.type="button",e.style.margin="5px",t.muted||t.volume===0?e.innerHTML=Mn:e.innerHTML=bn,o.addEvent(t,"volumechange",()=>{t.muted||t.volume===0?e.innerHTML=bn:e.innerHTML=Mn}),o.addEvent(e,"click",()=>{t.muted&&(t.muted=!1),t.volume===0?t.volume=1:t.volume=0}),o.buttons.push(e),o.playerControlsContainer.appendChild(e)}var Fn='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>',$w='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pause"><rect width="4" height="16" x="6" y="4"></rect><rect width="4" height="16" x="14" y="4"></rect></svg>';function On(t,o){let e=document.createElement("button");e.type="button",e.innerHTML=Fn,e.style.margin="5px",o.addEvent(t,"play",()=>{e.innerHTML=$w}),o.addEvent(t,"pause",()=>{e.innerHTML=Fn}),o.addEvent(e,"click",()=>{o.withRefVideo(r=>{r.paused&&r.play().then(()=>{o.showButton("compare")})}),t.paused?t.play().then(()=>{o.redrawFullCanvas()}):(t.pause(),o.raf(()=>{o.redrawFullCanvas()}))}),o.buttons.push(e),o.playerControlsContainer.appendChild(e)}function _n(t){return`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-superscript">
        <style>
            .small {
                font-family: auto;
                font-size: ${t===1?"16":"24"}px;
            }
        </style>
        <text x="${t===1?3:2}" y="${t===1?17:20}" font-weight="normal" class="small">${{"0.25":"\xBC","0.5":"\xBD","0.75":"\xBE",1:"1\xD7"}[String(t)]}</text>
        
    </svg>`}function kn(t,o){let e=[.25,.5,.75,1],r=document.createElement("button"),i=e[e.length-1];r.type="button",t.playbackRate=i,r.innerHTML=_n(i),r.style.margin="5px",o.addEvent(r,"click",()=>{let s=e.indexOf(t.playbackRate),c=s+1>=e.length?0:s+1;t.playbackRate=e[c],r.innerHTML=_n(e[c])}),o.buttons.push(r),o.playerControlsContainer.appendChild(r)}var Qw="#F3CE32";function Dn(){var p,d;let t=document.createElement("div");t.style.position="absolute",t.style.top="-40px",t.style.left="0",t.style.zIndex="2",(p=this.canvas.parentNode)==null||p.insertBefore(t,this.canvas);let o=document.createElement("div");o.style.position="relative",o.style.top="0",o.style.left="0",o.style.zIndex="2",(d=this.canvas.parentNode)==null||d.insertBefore(o,this.canvas.nextSibling),this.playerControlsContainer=o;let e=this.videoElement.tagName==="VIDEO"?this.videoElement:null;this.uiContainer=t;let r=(m,h,f=t)=>{let x=document.createElement("button");if(x.type="button",x.innerHTML=m,x.style.margin="5px",f.appendChild(x),this.buttons.push(x),typeof h=="function")this.addEvent(x,"click",h);else{x.dataset.tool=h;let v=()=>{this.currentTool===h?this.currentTool=null:this.currentTool=h};this.addEvent(x,"click",v)}return x},i=()=>{let m=document.createElement("div");return m.style.display="inline-flex",m.style.alignItems="center",m.style.margin="5px",t.appendChild(m),m};r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>',"rectangle"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle></svg>',"circle"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.3 8.7 8.7 21.3c-1 1-2.5 1-3.4 0l-2.6-2.6c-1-1-1-2.5 0-3.4L15.3 2.7c1-1 2.5-1 3.4 0l2.6 2.6c1 1 1 2.5 0 3.4Z"></path><path d="m7.5 10.5 2 2"></path><path d="m10.5 7.5 2 2"></path><path d="m13.5 4.5 2 2"></path><path d="m4.5 13.5 2 2"></path></svg>',"line"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08"></path><path d="M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z"></path></svg>',"curve"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>',"arrow"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 7 4 4 20 4 20 7"></polyline><line x1="9" y1="20" x2="15" y2="20"></line><line x1="12" y1="4" x2="12" y2="20"></line></svg>',"text"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"></path><path d="M22 21H7"></path><path d="m5 11 9 9"></path></svg>',"eraser"),this.isMobile&&(this.hideButton("line"),this.hideButton("circle"),this.hideButton("rectangle"),this.hideButton("eraser")),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="5 9 2 12 5 15"></polyline><polyline points="9 5 12 2 15 5"></polyline><polyline points="15 19 12 22 9 19"></polyline><polyline points="19 9 22 12 19 15"></polyline><line x1="2" y1="12" x2="22" y2="12"></line><line x1="12" y1="2" x2="12" y2="22"></line></svg>',"move"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flip-horizontal"><path d="M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3"></path><path d="M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3"></path><path d="M12 20v2"></path><path d="M12 14v2"></path><path d="M12 8v2"></path><path d="M12 2v2"></path></svg>',"compare"),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>',()=>{this.handleUndo()}),e&&(r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>',()=>{this.prevFrame()},this.playerControlsContainer),On(e,this),r('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>',()=>{this.nextFrame()},this.playerControlsContainer),Pn(e,this),kn(e,this),In(e,this));let s=document.createElement("input");s.type="color",s.value=Qw,s.style.margin="5px",this.colorPicker=s,t.appendChild(s);let c=i(),a=document.createElement("input");a.type="number",a.step="1",a.min="1",a.max="10",a.value="5",a.style.margin="5px",c.appendChild(a);let l=m=>{this.ctx.lineWidth=m.target.valueAsNumber,this.focusOnMediaNode()};this.addEvent(a,"input",l);let u=m=>{this.ctx.strokeStyle=m.target.value,this.ctx.fillStyle=m.target.value,this.focusOnMediaNode()};this.addEvent(s,"input",u),this.colorPicker=s,this.strokeSizePicker=a,this.hideButton("compare"),e&&(this.hide(),this.addEvent(e,"pause",()=>{this.show()}),this.addEvent(e,"seek",()=>{e.paused&&this.show()}),this.addEvent(e,"timeupdate",()=>{e.currentTime<2e-4&&!e.paused&&this.startAnnotationsAsVideo()}),this.addEvent(e,"error",()=>{this.hide()}),this.addEvent(e,"stalled",()=>{this.hide()}),this.addEvent(e,"play",()=>{this.hideControls(),this.startAnnotationsAsVideo()}),this.addEvent(document,"copy",m=>{Sn(m,this)}),this.addEvent(document,"cut",m=>{Tn(m,this)}),this.addEvent(document,"paste",m=>{En(m,this)}),this.addEvent(document,"click",m=>{wn(m,this)}),this.addEvent(document,"keydown",m=>{An(m,this)}))}function Rn(){var t;this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),(t=this.videoElement.parentNode)==null||t.insertBefore(this.canvas,this.videoElement.nextSibling),this.canvas.style.position="absolute",this.canvas.style.backgroundColor="transparent",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.zIndex="1",this.addEvent(this.canvas,"pointerdown",this.handleMouseDown),this.addEvent(this.canvas,"pointermove",this.handleMouseMove),this.addEvent(this.canvas,"pointerup",this.handleMouseUp),this.addEvent(this.canvas,"pointercancel",this.handleMouseUp),this.addEvent(window,"resize",this.setCanvasSize),this.addEvent(document,"keydown",this.onKeyDown)}var mr=class{constructor(){this.destructors=[];this.isDestroyed=!1;this.activeTimeFrame=1;this.globalShapes=[];this.timeStack=new Map;this.undoTimeStack=new Map}cleanFrameStacks(){this.timeStack.clear(),this.undoTimeStack.clear()}destroy(){this.destructors.forEach(o=>o()),this.destructors=[],this.globalShapes=[],this.cleanFrameStacks()}raf(o){return requestAnimationFrame(o)}addEvent(o,e,r){let i=s=>{this.isDestroyed||r(s)};o.addEventListener(e,i),this.destructors.push(()=>{o.removeEventListener(e,i)})}addProgressBarOverlay(){throw new Error("Method not implemented.")}initUI(){throw new Error("Method not implemented.")}initCanvas(){throw new Error("Method not implemented.")}addFrameSquareOverlay(o=this.activeTimeFrame){throw new Error("Method not implemented.")}addVideoOverlay(){throw new Error("Method not implemented.")}withRefVideo(o){this.isDestroyed||this.referenceVideoElement&&o(this.referenceVideoElement)}withVideo(o){if(this.isDestroyed)return;let e=this.videoElement;!e||e.tagName!=="VIDEO"||o(e)}};var oe=class{constructor(o){this.startX=0;this.startY=0;this.isDrawing=!1;this.annotationTool=o}get ctx(){return this.annotationTool.ctx}onDeactivate(){}onActivate(){}reset(){this.startX=0,this.startY=0,this.isDrawing=!1}save(o){this.annotationTool.addShape(o)}};var hr=class extends oe{constructor(){super(...arguments);this.name="rectangle"}move(e,r,i){return e.x+=r,e.y+=i,e}normalize(e,r,i){return F(w({},e),{x:e.x/r,y:e.y/i,width:e.width/r,height:e.height/i})}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.drawRectangle(this.startX,this.startY,r-this.startX,i-this.startY)}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.save({type:"rectangle",x:this.startX,y:this.startY,width:r-this.startX,height:i-this.startY,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth}),this.drawRectangle(this.startX,this.startY,r-this.startX,i-this.startY),this.isDrawing=!1}drawRectangle(e,r,i,s){this.ctx.beginPath(),this.ctx.rect(e,r,i,s),this.ctx.stroke()}draw(e){this.drawRectangle(e.x,e.y,e.width,e.height)}};var fr=class extends oe{constructor(){super(...arguments);this.name="circle"}move(e,r,i){return e.x+=r,e.y+=i,e}normalize(e,r,i){return F(w({},e),{x:e.x/r,y:e.y/i,radius:e.radius/r})}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e),s=Math.sqrt(Math.pow(r-this.startX,2)+Math.pow(i-this.startY,2));this.drawCircle(this.startX,this.startY,s)}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e),s=Math.sqrt(Math.pow(r-this.startX,2)+Math.pow(i-this.startY,2));this.save({type:"circle",x:this.startX,y:this.startY,radius:s,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth}),this.drawCircle(this.startX,this.startY,s),this.isDrawing=!1}drawCircle(e,r,i){this.ctx.beginPath(),this.ctx.arc(e,r,i,0,2*Math.PI),this.ctx.stroke()}draw(e){this.drawCircle(e.x,e.y,e.radius)}};var xr=class{constructor(o,e){this.x=o;this.y=e}distanceToLine(o,e){let r=e.x-o.x,i=e.y-o.y,s=Math.abs(i*this.x-r*this.y+e.x*o.y-e.y*o.x),c=Math.sqrt(i*i+r*r);return s/c}};function vr(t,o){if(t.length<=2)return t;let e=t[0],r=t[t.length-1],i=-1,s=0;for(let c=1;c<t.length-1;c++){let a=t[c].distanceToLine(e,r);a>s&&(i=c,s=a)}if(s>o){let c=vr(t.slice(0,i+1),o),a=vr(t.slice(i),o);return c.slice(0,c.length-1).concat(a)}else return[e,r]}var gr=class extends oe{constructor(){super(...arguments);this.name="curve";this.curvePoints=[]}move(e,r,i){return e.points=e.points.map(s=>({x:s.x+r,y:s.y+i})),e}normalize(e,r,i){return F(w({},e),{points:e.points.map(s=>({x:s.x/r,y:s.y/i}))})}draw(e){this.drawCurve(e)}reset(){super.reset(),this.curvePoints=[]}onPointerDown(e){if(this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.curvePoints=[],this.startX=r,this.startY=i,this.isDrawing=!0,this.curvePoints.push({x:r,y:i})}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.curvePoints.push({x:r,y:i}),this.drawCurve({points:this.curvePoints,lineWidth:this.ctx.lineWidth})}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.curvePoints.push({x:r,y:i});let s=this.curvePoints.map(p=>new xr(p.x,p.y)),u={type:"curve",points:vr(s,2).map(p=>({x:p.x,y:p.y})),strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth};this.save(u),this.curvePoints=[],this.isDrawing=!1}drawCurve(e){if(e.points.length===2&&e.points[0].x===e.points[1].x&&e.points[0].y===e.points[1].y){let r=e.lineWidth/4,i=0,s=2*Math.PI;this.ctx.beginPath(),this.ctx.arc(e.points[0].x,e.points[0].y,r,i,s),this.ctx.stroke()}else{this.ctx.beginPath(),this.ctx.moveTo(e.points[0].x,e.points[0].y);for(let r=1;r<e.points.length-1;r++){let i=e.points[r],s=e.points[r+1];this.ctx.quadraticCurveTo(i.x,i.y,s.x,s.y)}this.ctx.stroke()}}};var yr=class extends oe{constructor(){super(...arguments);this.name="line"}move(e,r,i){return e.x1+=r,e.y1+=i,e.x2+=r,e.y2+=i,e}normalize(e,r,i){return F(w({},e),{x1:e.x1/r,y1:e.y1/i,x2:e.x2/r,y2:e.y2/i})}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.drawLine(this.startX,this.startY,r,i)}onPointerUp(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.save({type:"line",x1:this.startX,y1:this.startY,x2:r,y2:i,fillStyle:this.ctx.fillStyle,strokeStyle:this.ctx.strokeStyle,lineWidth:this.ctx.lineWidth}),this.drawLine(this.startX,this.startY,r,i),this.isDrawing=!1}drawLine(e,r,i,s){this.ctx.beginPath(),this.ctx.moveTo(e,r),this.ctx.lineTo(i,s),this.ctx.stroke()}draw(e){this.drawLine(e.x1,e.y1,e.x2,e.y2)}};var Cr=class extends oe{constructor(){super(...arguments);this.name="arrow"}normalize(e,r,i){return F(w({},e),{x1:e.x1/r,y1:e.y1/i,x2:e.x2/r,y2:e.y2/i})}move(e,r,i){return e.x1+=r,e.y1+=i,e.x2+=r,e.y2+=i,e}draw(e){this.drawArrow(e.x1,e.y1,e.x2,e.y2)}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.drawArrow(this.startX,this.startY,r,i)}onPointerUp(e){if(!this.isDrawing)return;this.isDrawing=!1;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.save({type:"arrow",x1:this.startX,y1:this.startY,x2:r,y2:i,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth})}drawArrow(e,r,i,s){let c=10+2.5*this.ctx.lineWidth,a=Math.PI/6,l=Math.atan2(s-r,i-e);this.ctx.beginPath(),this.ctx.moveTo(e,r),this.ctx.lineTo(i,s),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(i-c*Math.cos(l+a),s-c*Math.sin(l+a)),this.ctx.moveTo(i,s),this.ctx.lineTo(i-c*Math.cos(l-a),s-c*Math.sin(l-a)),this.ctx.stroke()}};var Nr=class extends oe{constructor(){super(...arguments);this.name="text"}move(e,r,i){return e.x+=r,e.y+=i,e}onActivate(){this.annotationTool.canvas.style.cursor="text",this.isDrawing=!0}onDeactivate(){this.annotationTool.canvas.style.cursor="default",this.isDrawing=!1}draw(e){let r=e.text.split(`
`);for(let i=0;i<r.length;i++)this.drawText(e.x,e.y+i*20,r[i])}drawText(e,r,i){let s=16+this.ctx.lineWidth*.5;this.ctx.font=`${s}px Helvetica Neue, Arial`,this.ctx.fillText(i,e,r)}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i}onPointerMove(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.ctx.beginPath(),this.ctx.arc(r,i,5,0,2*Math.PI),this.ctx.fill()}normalize(e,r,i){return F(w({},e),{x:e.x/r,y:e.y/i})}onPointerUp(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e),s=prompt("Enter the text to be drawn:");s!==null&&this.save({type:"text",x:r,y:i,text:s,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth})}};var wr=class extends oe{constructor(){super(...arguments);this.name="eraser"}move(e,r,i){return e.x+=r,e.y+=i,e}normalize(e,r,i){return F(w({},e),{x:e.x/r,y:e.y/i,width:e.width/r,height:e.height/i})}draw(e){this.drawEraser(e.x,e.y,e.width,e.height)}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i,this.isDrawing=!0}onPointerMove(e){if(!this.isDrawing)return;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.ctx.save(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.lineWidth=1,this.ctx.fillStyle="rgba(255, 255, 255, 0.3)",this.ctx.fillRect(this.startX,this.startY,r-this.startX,i-this.startY),this.ctx.strokeRect(this.startX,this.startY,r-this.startX,i-this.startY),this.ctx.restore()}onPointerUp(e){if(!this.isDrawing)return;this.isDrawing=!1;let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.save({type:"eraser",x:this.startX,y:this.startY,width:r-this.startX,height:i-this.startY,strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth})}drawEraser(e,r,i,s){this.ctx.clearRect(e,r,i,s)}};var Sr=class extends oe{constructor(){super(...arguments);this.name="move";this.shape=null;this.lastDrawnShape=null;this.shapeRemoved=!1;this.isScale=!1}move(e){return e}normalize(e){return w({},e)}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e),s=this.annotationTool.shapes.slice(0).pop();s&&(this.shape=s,this.shapeRemoved=!1,this.lastDrawnShape=null,this.startX=r,this.startY=i,this.isDrawing=!0,this.isScale=s.type==="image"?this.isPointerAtCorner(s,r,i):!1)}isPointerAtCorner(e,r,i){let s=this.annotationTool.deserialize([e])[0],c=15,a=Math.abs(s.y-i)<c,l=Math.abs(s.x-r)<c,u=Math.abs(s.x+s.width-r)<c,p=Math.abs(s.y+s.height-i)<c;return a&&l||a&&u||p&&l||p&&u}onPointerMove(e){if(!this.isDrawing||!this.shape)return;this.shapeRemoved||(this.annotationTool.removeLastShape(),this.shapeRemoved=!0);let{x:r,y:i}=this.annotationTool.getRelativeCoords(e),s=r-this.startX,c=i-this.startY;this.startX=r-s,this.startY=i-c;let a=this.annotationTool.deserialize([this.shape])[0],l=a.type==="image"?a:JSON.parse(JSON.stringify(a));if(l.type==="image")if(this.isScale){let{width:u,height:p}=l,d=u/p,m=u+s,h=m/d;l.width=m,l.height=h,this.lastDrawnShape=l,this.annotationTool.pluginForTool(l.type).draw(l)}else{let u=this.annotationTool.pluginForTool(l.type).move(l,s,c);this.lastDrawnShape=u,this.annotationTool.pluginForTool(l.type).draw(u)}else{let u=this.annotationTool.pluginForTool(l.type).move(l,s,c);this.lastDrawnShape=u,this.annotationTool.pluginForTool(l.type).draw(u)}}onPointerUp(e){!this.isDrawing||!this.lastDrawnShape||(this.lastDrawnShape&&(this.lastDrawnShape.fillStyle=this.annotationTool.ctx.fillStyle,this.lastDrawnShape.strokeStyle=this.annotationTool.ctx.strokeStyle,this.lastDrawnShape.lineWidth=this.annotationTool.ctx.lineWidth,this.save(this.lastDrawnShape)),this.isDrawing=!1,this.isScale=!1,this.shape=null,this.shapeRemoved=!1,this.lastDrawnShape=null)}draw(){throw new Error("Method not implemented.")}reset(){this.isDrawing=!1,this.shape=null,this.isScale=!1,this.lastDrawnShape=null,this.shapeRemoved=!1}};var Tr=class extends oe{constructor(){super(...arguments);this.name="image"}move(e,r,i){return e.x+=r,e.y+=i,e}onPointerDown(e){}onPointerMove(e){}onPointerUp(e){}normalize(e,r,i){return F(w({},e),{x:e.x/r,y:e.y/i,width:e.width/r,height:e.height/i})}draw(e){if(!(e.image instanceof HTMLImageElement)){console.error("Image is not an instance of HTMLImageElement");return}this.ctx.drawImage(e.image,e.x,e.y,e.width,e.height)}};var Jw=.7,Ar=class extends oe{constructor(){super(...arguments);this.name="compare";this.comparisonLine=0;this.leftOpacity=1;this.rightOpacity=1;this.isDrawing=!1}move(e,r,i){return e.x+=r,e}onActivate(){this.comparisonLine=this.annotationTool.canvasWidth/2,this.leftOpacity=1,this.rightOpacity=this.annotationTool.isMobile?1:Jw,this.annotationTool.canvas.style.cursor="col-resize"}onDeactivate(){this.annotationTool.canvas.style.cursor="default",this.comparisonLine=0,this.leftOpacity=1,this.rightOpacity=1,this.isDrawing=!1}normalize(e,r){return F(w({},e),{x:e.x/r})}onPointerDown(e){let{x:r,y:i}=this.annotationTool.getRelativeCoords(e);this.startX=r,this.startY=i,this.isDrawing=!0,this.disablePreviousCompare(),this.onPointerMove(e)}onPointerMove(e){if(!this.isDrawing){if(this.annotationTool.globalShapes.length>0){let s=this.annotationTool.globalShapes[0];if(s.type==="compare"){let c=this.annotationTool.deserialize([s])[0];this.draw(c),this.annotationTool.addFrameSquareOverlay()}}return}let{x:r}=this.annotationTool.getRelativeCoords(e);this.comparisonLine=r;let i={type:"compare",strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth,x:r};this.draw(i),this.drawDelimiter(i)}onPointerUp(){this.isDrawing&&(this.save({type:"compare",strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth,disabled:!1,x:this.comparisonLine}),this.isDrawing=!1)}removePreviousCompare(){this.annotationTool.globalShapes=this.annotationTool.globalShapes.filter(e=>e.type!=="compare")}disablePreviousCompare(){this.annotationTool.globalShapes=this.annotationTool.globalShapes.map(e=>e.type==="compare"?F(w({},e),{disabled:!0}):e)}save(e){this.removePreviousCompare();let r=this.annotationTool.serialize([e])[0];r.x<.05||r.x>.95||this.annotationTool.addGlobalShape(r)}drawDelimiter(e){this.ctx.beginPath(),this.ctx.moveTo(e.x,0),this.ctx.lineTo(e.x,this.annotationTool.canvasWidth),this.ctx.stroke()}drawShape(e){var _,O,L,U,V,H,q,Q;let r=this.annotationTool.videoElement,i=this.annotationTool.referenceVideoElement;if(!r||!i)return;let s=this.ctx.globalAlpha,c=this.annotationTool.canvasWidth,a=this.annotationTool.canvasHeight,l=e.x,u=i.videoHeight-r.videoHeight,p=i.videoWidth-r.videoWidth,d=this.annotationTool.isMobile;this.ctx.globalAlpha=this.leftOpacity;let m=(O=(_=this.annotationTool.referenceVideoFrameBuffer)==null?void 0:_.frameNumberFromTime(r.currentTime))!=null?O:1,h=m;if(p>r.videoWidth&&u>r.videoHeight&&!this.annotationTool.isMobile){let X=(H=(V=this.annotationTool.referenceVideoFrameBuffer)==null?void 0:V.getFrameNumberBySignature((U=(L=this.annotationTool.videoFrameBuffer)==null?void 0:L.getHistogram(m))!=null?U:null,m))!=null?H:m,ue=Math.abs(m-X);ue>=1&&ue<=3&&(h=X)}let x=(q=this.annotationTool.referenceVideoFrameBuffer)==null?void 0:q.getFrame(h),v=(Q=this.annotationTool.videoFrameBuffer)==null?void 0:Q.getFrame(m);if(d){this.ctx.imageSmoothingQuality="low";let X=l/c,ue=l;this.ctx.drawImage(v!=null?v:r,0,0,X*r.videoWidth,r.videoHeight,0,0,ue,a)}else{let X=v?v.width:r.videoWidth,ue=v?v.height:r.videoHeight;this.ctx.drawImage(v!=null?v:r,0,0,X,ue,0,0,c,a)}this.ctx.globalAlpha=this.rightOpacity;let g=0,T=0,A=r.videoWidth/r.videoHeight,M=i.videoWidth/i.videoHeight,N=Math.abs(A-M)>.1,y=10,C=Math.abs(u)>y,P=r.videoWidth,R=r.videoHeight,I=0;if(p<-y)if(N){let X=r.videoWidth/c;I=Math.abs(p/2),I=I/X,I<=y&&(I=0)}else P=i.videoWidth;else p>y&&(P=i.videoWidth);if(u===0)g=0;else if(u>0)N?(g=u/2,g<=y&&(g=0)):R=C?i.videoHeight:r.videoHeight;else if(!N)R=C?i.videoHeight:r.videoHeight;else{T=Math.abs(u/2);let X=r.videoHeight/a;T=T/X,T<=y&&(T=0)}let E=l-I,B=c-E,b=B/c*P;x?(d&&(this.ctx.imageSmoothingQuality="low"),this.ctx.drawImage(x,E/c*P,g,b,R,E+I,T,B,a)):console.log("no video data",m),this.ctx.globalAlpha=s}draw(e){if(e.disabled)return;let r=this.annotationTool.videoElement,i=this.annotationTool.referenceVideoElement;!r||!i||this.drawShape(e)}};var no=class extends oe{constructor(e){super(e);this.name="audio-peaks";this.props={scale:1,peaks:[],theme:{waveOutlineColor:"rgba(255,192,203,0.7)",waveFillColor:"grey",waveProgressColor:"orange"},waveHeight:40,bits:16};e.setVideoBlob=r=>{let i=new FileReader;i.onload=s=>{setTimeout(()=>{var c;this.init((c=s.target)==null?void 0:c.result)},3e3)},i.readAsArrayBuffer(r)}}init(e){return D(this,null,function*(){let{AudioContext:r}=yield Promise.resolve().then(()=>(Tw(),Sw)),{default:i}=yield Promise.resolve().then(()=>Kw(Mw(),1));new r().decodeAudioData(e,c=>{let l=this.annotationTool.progressBarCoordinates.width,u=Math.ceil(c.length/l),p=i(c,u,!0),d=Math.min(...p.data[0]),m=Math.max(...p.data[0]),h=Math.pow(2,p.bits-1)-1,f=-Math.pow(2,p.bits-1);this.props.peaks=p.data[0].map(x=>x<0?Math.round(x/d*f):Math.round(x/m*h)),this.props.bits=p.bits,this.annotationTool.addGlobalShape({x:0,y:0,strokeStyle:"red",fillStyle:"red",lineWidth:1,type:"audio-peaks"}),console.log(p)})})}move(e,r,i){return e.x+=r,e.y+=i,e}normalize(e,r,i){return F(w({},e),{x:e.x/r,y:e.y/i})}onPointerDown(e){}onPointerMove(e){}onPointerUp(e){}draw(e){if(this.annotationTool.videoElement.muted)return;this.ctx.clearRect(0,0,this.annotationTool.canvasWidth,this.annotationTool.canvasHeight);let{peaks:i,bits:s,waveHeight:c,theme:a}=this.props,l=this.ctx,u=0,p=this.annotationTool.progressBarCoordinates.x,d=c/2,m=pr(2,s-1),h=this.annotationTool.progressBarCoordinates.y-40;l.fillStyle=a.waveOutlineColor;let f=this.annotationTool.progressBarCoordinates.width*this.annotationTool.pixelRatio,{x,width:v}=this.annotationTool.progressBarCoordinates,g=this.annotationTool.playbackFrame,T=this.annotationTool.videoElement.duration*this.annotationTool.fps,A=Math.ceil(g/T*v)+x;for(let M=0;M<f;M+=1){let S=i[(M+u)*2]/m,N=i[(M+u)*2+1]/m,y=Math.abs(S*d),C=Math.abs(N*d);M+p===A?(l.fillStyle=a.waveProgressColor,l.fillRect(M+p,h+0,1,d*2)):(l.fillStyle=a.waveOutlineColor,l.fillRect(M+p,h+0+d-C,1,C+y))}}};var Pw=[hr,fr,yr,Cr,Nr,wr,gr,Sr,Tr,Ar,no];function Fw(t,o){let e,r,i,s=[],c=!0;function a(p,d){let m=Math.abs(d.mediaTime-e),h=Math.abs(d.presentedFrames-r),f=m/h;f&&f<1&&c&&s.length<50&&t.playbackRate===1&&document.hasFocus()&&(s.push(f),i=Math.round(1/u()),o(i,s.length*2)),c=!0,e=d.mediaTime,r=d.presentedFrames,t.requestVideoFrameCallback(a)}t.requestVideoFrameCallback(a);let l=()=>{s.pop(),c=!1};t.addEventListener("seeked",l);function u(){return s.reduce((p,d)=>p+d)/s.length}return()=>{t.removeEventListener("seeked",l)}}function Ow(t,o,e){return .299*t+.587*o+.114*e}var M0=0,yn=class extends Array{constructor(){super(...arguments);this.id=M0++}};function _w(t){let o=t.width,e=t.height,r=new Array(o*e),i=new yn,s=0;for(let c=0;c<t.data.length;c+=4)r[s]=Ow(t.data[c],t.data[c+1],t.data[c+2]),s++;for(let c=1;c<e-1;c++)for(let a=1;a<o-1;a++){let l=c*o+a,u=-r[l-o-1]+r[l-o+1]-2*r[l-1]+2*r[l+1]-r[l+o-1]+r[l+o+1],p=r[l-o-1]+2*r[l-o]+r[l-o+1]-r[l+o-1]-2*r[l+o]-r[l+o+1],d=Math.sqrt(u*u+p*p);i.push(d)}return i}var gn=new Map,P0=(t,o)=>Math.max(t.id,o.id)+"-"+Math.min(t.id,o.id);function kw(t,o){let e=P0(t,o);if(gn.has(e))return gn.get(e);let r=0;for(let s=0;s<t.length;s++)r+=(t[s]-o[s])*(t[s]-o[s]);let i=1/(1+Math.sqrt(r));return gn.set(e,i),i}var zt=64,mt=class{constructor(o,e,r=!0){this.isDestroyed=!1;this.autoHide=!0;this.isMobile=!1;this.seenFrames=0;this.isCanvasSizeSet=!1;this.frames=new Map;this.histograms=new Map;this.video=o,this.fps=e,this.autoHide=r,this.createCanvas(),this.createTransformCanvas()}createTransformCanvas(){this.transformCanvas=document.createElement("canvas"),this.transformCanvasCtx=this.canvas.getContext("2d",{willReadFrequently:!0,alpha:!1}),this.transformCanvas.width=zt,this.transformCanvas.height=zt}normalizeImage(o){return this.transformCanvasCtx.drawImage(o,0,0,o.width,o.height,0,0,zt,zt),this.transformCanvasCtx.getImageData(0,0,zt,zt)}toHistogram(o){return this.imageHistogram(this.normalizeImage(o))}imageHistogram(o){return _w(o)}start(){this.addRequestFrameCallback()}destroy(){this.isDestroyed=!0,this.frames.forEach(o=>o.close()),this.frames.clear()}tick(o,e){if(this.setCanvasSize(),e.expectedDisplayTime-performance.now()>10&&console.log("looks like frame is not yet rendered"),this.isDestroyed)return!1;if(this.seenFrames>=this.totalFrames){if(this.autoHide)try{this.video.paused||this.video.pause(),this.video.style.display="none"}catch(a){}return!1}if(this.video.videoWidth===0||this.video.videoHeight===0)return!0;let i=this.video,s=this.frameNumberFromTime(e.mediaTime);if(!Math.max(1,e.presentedFrames>this.totalFrames?e.presentedFrames%this.totalFrames:e.presentedFrames))throw new Error("expectedFrame is 0");if(this.hasFrame(s))this.seenFrames++;else{this.ctx.drawImage(i,0,0,this.width,this.height,0,0,this.width,this.height);let a=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);createImageBitmap(a,0,0,this.width,this.height).then(l=>D(this,null,function*(){this.setFrame(s,l),this.isMobile||this.setHistogram(s,this.toHistogram(l))}))}return!0}addRequestFrameCallback(){this.isDestroyed||this.video.requestVideoFrameCallback((o,e)=>{this.tick(o,e)&&this.addRequestFrameCallback()})}createCanvas(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0,alpha:!1})}setCanvasSize(){this.isCanvasSizeSet||(this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.isCanvasSizeSet=!0)}get width(){return this.video.videoWidth}get height(){return this.video.videoHeight}hasFrame(o){return this.frames.has(o)}getFrame(o){return this.frames.has(o)?this.frames.get(o):null}getFrameNumberBySignature(o,e){if(!o)return e;let r=0,i=e;return[e-3,e-2,e-1,e,e+1,e+2,e+3].filter(c=>c>0&&c<=this.totalFrames).forEach(c=>{let a=this.getHistogram(c);if(a){let l=kw(o,a);l>r&&(r=l,i=c)}}),i}setFrame(o,e){this.frames.set(o,e)}setHistogram(o,e){this.histograms.set(o,e)}getHistogram(o){var e;return(e=this.histograms.get(o))!=null?e:null}get totalFrames(){return Math.round(this.video.duration*this.fps)}frameNumberFromTime(o){return Math.max(1,Math.round(o*this.fps))}};var F0=window.devicePixelRatio||1,Dw=25,ot=class extends mr{constructor(e){super();this.referenceVideoFrameBuffer=null;this.videoFrameBuffer=null;this.isMouseDown=!1;this.buttons=[];this.plugins=[];this.annotatedFrameCoordinates=[];this.fps=Dw;this.plannedFn=null;this.ct=0;this.isCanvasInitialized=!1;this.enforcedCanvasSize=null;this.lastNavigatedFrame=0;this.isProgressBarNavigation=!1;this.isAnnotationsAsVideoActive=!1;this.plugins=Pw.map(r=>new r(this)),this.init(e)}prevFrame(){let e=this.playbackFrame,r=Math.max(1,e-1);r===this.playbackFrame?this.playbackFrame=this.totalFrames-1:this.playbackFrame=r}nextFrame(){let e=this.playbackFrame,r=Math.min(this.totalFrames,e+1);r===this.totalFrames?this.playbackFrame=1:this.playbackFrame=r}addGlobalShape(e){this.globalShapes.push(e)}get selectedColor(){return this.colorPicker.value}get selectedStrokeSize(){return this.strokeSizePicker.valueAsNumber}get currentTool(){return this._currentTool}set currentTool(e){let r=this._currentTool;r&&(this.getButtonForTool(r).classList.remove("active"),this.pluginForTool(r).onDeactivate()),this._currentTool=e,this.canvas.style.cursor=e?"pointer":"default",e&&(this.getButtonForTool(e).classList.add("active"),this.pluginForTool(e).onActivate())}enableFrameRateDetection(){if(this.destructors.find(i=>i.name==="frameRateDetector"))return;let e=this.videoElement;if(e.tagName==="IMG")return;let r=Fw(e,i=>{this.fps=i});Object.defineProperty(r,"name",{value:"frameRateDetector"}),this.destructors.push(r)}timeToFrame(e){return Math.max(1,Math.round(e*this.fps))}get playbackFrame(){return this.videoElement instanceof HTMLImageElement?1:this.timeToFrame(this.videoElement.currentTime)}set playbackFrame(e){if(this.videoElement instanceof HTMLImageElement)return;let r=e/this.fps;this.videoElement.currentTime=r,this.rvf(()=>{this.show()})}rvf(e){this.plannedFn=e}get canvasWidth(){var e,r;return(r=(e=this.enforcedCanvasSize)==null?void 0:e.width)!=null?r:0}get canvasHeight(){var e,r;return(r=(e=this.enforcedCanvasSize)==null?void 0:e.height)!=null?r:0}get aspectRatio(){return this.canvasWidth/this.canvasHeight}get isMobile(){return window.innerWidth<960}get progressBarCoordinates(){let e=this.isMobile?30:10,r=5,i=55,s=this.canvasWidth-r-i,c=r,a=this.canvasHeight-e;return{x:c,y:a,width:s,height:e}}get shapes(){return this.timeStack.has(this.activeTimeFrame)||this.timeStack.set(this.activeTimeFrame,[]),this.timeStack.get(this.activeTimeFrame)}set shapes(e){this.timeStack.set(this.activeTimeFrame,e)}get undoStack(){return this.undoTimeStack.has(this.activeTimeFrame)||this.undoTimeStack.set(this.activeTimeFrame,[]),this.undoTimeStack.get(this.activeTimeFrame)}set undoStack(e){this.undoTimeStack.set(this.activeTimeFrame,e)}get pixelRatio(){return F0}setVideoUrl(i){return D(this,arguments,function*(e,r=this.fps){if(this.videoElement instanceof HTMLImageElement)return;let s=this.videoElement;s.src=e,yield this.videoElement.load(),this.setFrameRate(r),this.videoFrameBuffer&&(this.videoFrameBuffer.destroy(),this.videoFrameBuffer=new mt(s,r,!1),this.videoFrameBuffer.isMobile=this.isMobile),this.setCanvasSize()})}enableVideoFrameBuffer(){this.videoElement instanceof HTMLImageElement||(this.videoFrameBuffer=new mt(this.videoElement,this.fps,!1),this.videoFrameBuffer.isMobile=this.isMobile)}hide(){this.stopAnnotationsAsVideo(),this.hideControls(),this.hideCanvas()}showControls(){this.uiContainer.style.display="block"}hideControls(){this.uiContainer.style.display="none"}showCanvas(){this.canvas.style.display="block"}hideCanvas(){this.canvas.style.display="none"}updateActiveTimeFrame(e=void 0){this.activeTimeFrame=e?this.timeToFrame(e):this.playbackFrame}show(){this.stopAnnotationsAsVideo(),this.updateActiveTimeFrame(),this.showCanvas(),this.showControls(),this.redrawFullCanvas()}setCanvasSettings(){this.ctx.strokeStyle=this.selectedColor,this.ctx.fillStyle=this.selectedColor,this.ctx.lineWidth=this.selectedStrokeSize}pluginForTool(e){if(this.isDestroyed)throw new Error("AnnotationTool is destroyed");let r=this.plugins.find(i=>i.name===e);if(!r)throw new Error(`No plugin found for tool ${e}`);return r}getButtonForTool(e){return this.buttons.find(r=>r.dataset.tool===e)}bindContext(){this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.setCanvasSize=this.setCanvasSize.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}initProperties(){this.isDestroyed=!1,this.isProgressBarNavigation=!1,this.shapes=[],this.globalShapes=[],this.currentTool=this.isMobile?null:"curve"}setVideoStyles(){this.videoElement.style.objectFit="cover",this.videoElement.style.objectPosition="left top"}get frameCallbackSupported(){return"requestVideoFrameCallback"in HTMLVideoElement.prototype}initFrameCounter(){if(!this.frameCallbackSupported){setTimeout(()=>{var e;(e=this.plannedFn)==null||e.call(this),this.plannedFn=null,this.initFrameCounter(),this.updateActiveTimeFrame(),this.playAnnotationsAsVideo()},1e3/this.fps);return}this.withVideo(e=>{e.requestVideoFrameCallback((r,i)=>{var s,c;this.isCanvasInitialized||this._setCanvasSize(),(s=this.videoFrameBuffer)==null||s.tick(r,i),(c=this.plannedFn)==null||c.call(this),this.plannedFn=null,this.raf(()=>{this.initFrameCounter(),this.updateActiveTimeFrame(i.mediaTime),this.playAnnotationsAsVideo()})})})}init(e){this.videoElement=e,this.setVideoStyles(),this.initFrameCounter(),this.bindContext(),this.initCanvas(),this.initUI(),this.initProperties(),this.setCanvasSize()}onKeyDown(e){(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="z"&&this.handleUndo()}removeLastShape(){this.shapes.pop(),this.redrawFullCanvas()}handleUndo(){this.undoStack.length>0&&(this.shapes=this.undoStack.pop(),this.redrawFullCanvas())}destroy(){var s,c,a,l,u,p,d,m;if(this.isDestroyed)return;super.destroy(),this.stopAnnotationsAsVideo(),this._currentTool=null,this.plugins.forEach(h=>h.reset()),this.annotatedFrameCoordinates=[],this.setFrameRate(Dw);let e=this.strokeSizePicker.parentElement;if((s=e==null?void 0:e.parentNode)==null||s.removeChild(e),this.referenceVideoElement){let h=this.referenceVideoElement.parentElement;(c=h==null?void 0:h.parentNode)==null||c.removeChild(h),this.referenceVideoElement=null}let r=this.colorPicker.parentElement;(a=r==null?void 0:r.parentNode)==null||a.removeChild(r),this.buttons.forEach(h=>{var f;(f=h.parentNode)==null||f.removeChild(h)}),this.buttons=[],(l=this.uiContainer.parentNode)==null||l.removeChild(this.uiContainer),(u=this.canvas.parentNode)==null||u.removeChild(this.canvas),(p=this.playerControlsContainer.parentElement)==null||p.removeChild(this.playerControlsContainer),["strokeSizePicker","colorPicker","uiContainer","playerControlsContainer","canvas","ctx","videoElement"].forEach(h=>{delete this[h]}),this.activeTimeFrame=0,this.isDestroyed=!0,(d=this.referenceVideoFrameBuffer)==null||d.destroy(),this.referenceVideoFrameBuffer=null,(m=this.videoFrameBuffer)==null||m.destroy(),this.videoFrameBuffer=null}_setCanvasSize(){let e=getComputedStyle(this.videoElement),r=parseInt(e.width,10),i=this.videoElement,s=i.videoWidth/i.videoHeight;if(isNaN(r)||!i.videoWidth||!i.videoHeight)return this.isCanvasInitialized=!1,this.setCanvasSettings(),!1;let c=Math.min(r,i.videoWidth),a=Math.floor(c/s);return i.style.width=`${c}px`,i.style.height=`${a}px`,this.isCanvasInitialized=i.videoWidth>0&&i.videoHeight>0,this.canvas.width=c*this.pixelRatio,this.canvas.height=a*this.pixelRatio,this.canvas.style.width=`${c}px`,this.canvas.style.height=`${a}px`,this.enforcedCanvasSize={width:c,height:a},this.ctx.scale(this.pixelRatio,this.pixelRatio),this.setCanvasSettings(),!0}setCanvasSize(){this._setCanvasSize()&&(this.syncVideoSizes(),this.redrawFullCanvas())}addShape(e){let r=this.serialize([e])[0];this.undoStack.push([...this.shapes]),this.shapes.push(r)}get msPerFrame(){return this.fps/1e3}syncVideoSizes(){this.withRefVideo(e=>{let i=this.videoElement.getBoundingClientRect();e.style.position="fixed",e.style.top=`${i.top}px`,e.style.left=`${i.left}px`})}addReferenceVideoByURL(s){return D(this,arguments,function*(e,r=this.fps,i="video/mp4"){var u;let c=yield fetch(e).then(p=>p.blob()),a=new Blob([c],{type:i}),l=window.URL.createObjectURL(a);this.referenceVideoElement?((u=this.referenceVideoFrameBuffer)==null||u.destroy(),this.referenceVideoFrameBuffer=new mt(this.referenceVideoElement,r),this.referenceVideoFrameBuffer.isMobile=this.isMobile,this.referenceVideoFrameBuffer.start()):(this.referenceVideoElement=document.createElement("video"),this.withRefVideo(p=>{this.isMobile?(p.style.zIndex="2",p.style.display="block",p.style.top="0",p.style.left="0",p.style.opacity="0.25",p.style.width="20px",p.style.height="15px"):(p.style.zIndex="-1",p.style.display="none",p.style.width="100px",p.style.height="70px"),p.style.objectFit="cover",p.style.objectPosition="left top",p.muted=!0,p.volume=0,p.playsInline=!0,p.autoplay=!1,p.controls=!1,p.loop=!0,this.videoElement.after(p),this.referenceVideoFrameBuffer=new mt(p,r),this.referenceVideoFrameBuffer.isMobile=this.isMobile,this.referenceVideoFrameBuffer.start()}),this.syncVideoSizes()),this.referenceVideoElement.src=l,this.referenceVideoElement.play().then(()=>{this.showButton("compare")}).catch(()=>{this.hideButton("compare")})})}hideButton(e){let r=this.getButtonForTool(e);r.style.display="none"}showButton(e){let r=this.getButtonForTool(e);r.style.display=""}addSingletonShape(e){let r=this.serialize([e])[0],i=this.shapes.filter(s=>s.type!==e.type);this.replaceFrame(this.playbackFrame,[...i,r])}serialize(e=this.shapes){let r=this.canvasWidth,i=this.canvasHeight;return e.map(s=>this.pluginForTool(s.type).normalize(s,r,i))}deserialize(e){let r=1/this.canvasWidth,i=1/this.canvasHeight;return e.map(s=>this.pluginForTool(s.type).normalize(s,r,i))}getRelativeCoords(e){let r=this.canvas.getBoundingClientRect();return{x:this.getEventX(e)-r.left,y:this.getEventY(e)-r.top}}handleMouseDown(e){if(e.preventDefault(),this.isMouseDown=!0,dr(e))return;let r=this.frameFromProgressBar(e,!0);if(r){this.isProgressBarNavigation=!0;let i=this.getAnnotationFrame(e);this.isVideoPaused&&(i!==null?this.playbackFrame=i:this.playbackFrame=r);return}this.currentTool&&this.pluginForTool(this.currentTool).onPointerDown(e)}get isDrawing(){return this.currentTool?this.pluginForTool(this.currentTool).isDrawing:!1}get isVideoPaused(){return this.videoElement.tagName==="VIDEO"?this.videoElement.paused:!0}get hasGlobalOverlays(){return this.globalShapes.length>0}handleMouseMove(e){if(e.preventDefault(),!dr(e)){if(this.isMouseDown){let r=this.isProgressBarNavigation?this.frameFromProgressBar(e,!1):null;if(r!==null&&!this.isDrawing){if(r===this.lastNavigatedFrame)return;this.lastNavigatedFrame=r,this.isVideoPaused&&(this.playbackFrame=r);return}else this.hideControls(),this.clearCanvas(),this.hasGlobalOverlays||this.addVideoOverlay(),this.drawShapesOverlay()}else this.redrawFullCanvas();this.currentTool&&this.pluginForTool(this.currentTool).onPointerMove(e)}}getEventX(e){return e.clientX}getEventY(e){return e.clientY}handleMouseUp(e){this.isMouseDown=!1,this.isProgressBarNavigation=!1,this.showControls(),!dr(e)&&(this.currentTool&&this.pluginForTool(this.currentTool).onPointerUp(e),this.redrawFullCanvas())}focusOnMediaNode(){this.videoElement.focus()}drawShapesOverlay(){let e={strokeStyle:this.ctx.strokeStyle,fillStyle:this.ctx.fillStyle,lineWidth:this.ctx.lineWidth};for(let r of this.deserialize(this.globalShapes)){this.ctx.strokeStyle=r.strokeStyle,this.ctx.fillStyle=r.fillStyle,this.ctx.lineWidth=r.lineWidth;try{this.pluginForTool(r.type).draw(r)}catch(i){console.error(i)}}for(let r of this.deserialize(this.shapes)){this.ctx.strokeStyle=r.strokeStyle,this.ctx.fillStyle=r.fillStyle,this.ctx.lineWidth=r.lineWidth;try{this.pluginForTool(r.type).draw(r)}catch(i){console.error(i)}}this.ctx.strokeStyle=e.strokeStyle,this.ctx.fillStyle=e.fillStyle,this.ctx.lineWidth=e.lineWidth}clearCanvas(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)}frameToDataUrl(){try{this.clearCanvas(),this.addVideoOverlay(),this.addFrameSquareOverlay(),this.drawShapesOverlay();let e=this.canvas.toDataURL("image/png");return this.redrawFullCanvas(),e}catch(e){return console.error(e),null}}redrawFullCanvas(){this.hasGlobalOverlays||(this.clearCanvas(),this.addVideoOverlay()),this.drawShapesOverlay(),this.addFrameSquareOverlay(),this.addProgressBarOverlay()}replaceFrame(e,r){this.timeStack.set(e,this.parseShapes(this.stringifyShapes(r)))}addShapesToFrame(e,r){let i=this.timeStack.get(e)||[];this.timeStack.set(e,[...i,...this.parseShapes(this.stringifyShapes(r))])}setFrameRate(e){var r;(r=this.destructors.find(i=>i.name==="frameRateDetector"))==null||r(),this.fps=e}stringifyShapes(e){return JSON.stringify(e,(r,i)=>r==="image"?i.src:i)}parseShapes(e){return JSON.parse(e,(r,i)=>{if(r==="image"){let s=new Image;return s.src=i,s}return i})}filterNonSerializableShapes(e){return e.filter(r=>r.type!=="image")}saveCurrentFrame(){return{frame:this.playbackFrame,version:1,fps:this.fps,shapes:this.parseShapes(this.stringifyShapes(this.filterNonSerializableShapes(this.shapes)))}}loadAllFrames(e){this.cleanFrameStacks(),e.forEach(r=>{this.timeStack.set(r.frame,r.shapes)})}appendFrames(e){e.forEach(r=>{this.addShapesToFrame(r.frame,r.shapes)})}saveAllFrames(){return Array.from(this.timeStack.keys()).filter(s=>{var c;return(c=this.timeStack.get(s))==null?void 0:c.length}).map(s=>{var c;return{frame:s,fps:this.fps,version:1,shapes:this.filterNonSerializableShapes((c=this.timeStack.get(s))!=null?c:[])}})}getAnnotationFrame(e){var a,l;let r=e.offsetX,i=e.offsetY,s=this.isMobile?10:5;return(l=(a=this.annotatedFrameCoordinates.find(u=>r>=u.x-s&&r<=u.x+s&&i>=u.y-s&&i<=u.y+s))==null?void 0:a.frame)!=null?l:null}get totalFrames(){let e=this.videoElement;return e.tagName!=="VIDEO"?1:Math.ceil(e.duration*this.fps)}frameFromProgressBar(e,r=!0){let i=this.videoElement;if(i.tagName!=="VIDEO")return null;let{x:s,width:c,height:a,y:l}=this.progressBarCoordinates,u=e.offsetX,p=e.offsetY;return r?u>=s&&u<=s+c&&p>=l&&p<=l+a?Math.ceil((u-s)/c*(i.duration*this.fps)):null:u>=s&&u<=s+c?Math.ceil((u-s)/c*(i.duration*this.fps)):null}hasAnnotationsForFrame(e){if(this.globalShapes.length>0)return!0;if(this.timeStack.has(e)){let r=this.timeStack.get(e);return r&&r.length>0}return!1}stopAnnotationsAsVideo(){this.isAnnotationsAsVideoActive=!1}startAnnotationsAsVideo(){this.isAnnotationsAsVideoActive=!0,this.playAnnotationsAsVideo()}playAnnotationsAsVideo(){this.isAnnotationsAsVideoActive&&(this.hasGlobalOverlays||this.clearCanvas(),this.isMobile?this.hasGlobalOverlays||this.addVideoOverlay():this.addVideoOverlay(),this.drawShapesOverlay(),this.addFrameSquareOverlay(),this.addProgressBarOverlay())}};function Rw(t=this.activeTimeFrame){this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)";let o=50,e=30,r=20;this.ctx.fillRect(this.canvasWidth-o,this.canvasHeight-e,o,e),this.ctx.fillStyle="white",this.ctx.font=`${r}px sans-serif`,this.ctx.fillText(`${t}`.padStart(3,"0"),this.canvasWidth-40,this.canvasHeight-7),this.ctx.restore()}function Bw(){var s,c,a;let t=this.videoElement;if(t.tagName!=="VIDEO")return;let o=(s=this.videoFrameBuffer)==null?void 0:s.frameNumberFromTime(t.currentTime),e=(a=(c=this.videoFrameBuffer)==null?void 0:c.getFrame(o||0))!=null?a:t,r=e?e.width:t.videoWidth,i=e?e.height:t.videoHeight;this.ctx.drawImage(e,0,0,r,i,0,0,this.canvasWidth,this.canvasHeight)}function Lw(){let t=this.videoElement;if(t.tagName!=="VIDEO")return;this.annotatedFrameCoordinates=[];let e=Array.from(this.timeStack.keys()).filter(f=>{var x;return(x=this.timeStack.get(f))==null?void 0:x.length}),r=t.duration*this.fps,{x:i,width:s,height:c,y:a}=this.progressBarCoordinates,l=e.map(f=>Math.ceil(f/r*s));this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(i,a,s,c),this.ctx.fillStyle="#F3CE32";let u=this.isMobile?16:8;l.forEach((f,x)=>{this.ctx.beginPath();let v=i+f,g=this.canvasHeight-c/2;this.ctx.fillRect(v-u/2,g-u/2,u,u),this.annotatedFrameCoordinates.push({x:v,y:g,frame:e[x]})});let p=this.playbackFrame,d=Math.ceil(p/r*s)+i;this.ctx.fillStyle="white",this.ctx.beginPath();let m=d,h=this.canvasHeight-c/2;this.ctx.beginPath(),this.ctx.fillRect(m-u/2,h-u/2,u,u),this.ctx.fill(),this.ctx.restore()}ot.prototype.initUI=Dn;ot.prototype.initCanvas=Rn;ot.prototype.addFrameSquareOverlay=Rw;ot.prototype.addVideoOverlay=Bw;ot.prototype.addProgressBarOverlay=Lw;export{ot as SmAnnotate};
